{"version":3,"file":"text-page.esm.js","sources":["../src/appSettings.ts","../src/setupEnv.ts","../src/context/SettingsContext.tsx","../src/context/SharedHistoryContext.tsx","../src/ui/Modal.tsx","../src/hooks/useModal.tsx","../src/utils/join-classes.ts","../src/ui/Button.tsx","../src/plugins/ActionsPlugin.tsx","../src/nodes/AutocompleteNode.tsx","../src/utils/swipe.ts","../src/plugins/AutocompletePlugin.tsx","../src/plugins/AutoLinkPlugin.tsx","../src/plugins/ClickableLinkPlugin.ts","../src/plugins/CodeHighlightPlugin.ts","../src/nodes/EmojiNode.tsx","../src/plugins/EmojisPlugin.ts","../src/ui/EquationEditor.tsx","../src/ui/KatexRenderer.tsx","../src/nodes/EquationNode.tsx","../src/plugins/EquationsPlugin.ts","../src/ui/ImageResizer.tsx","../src/nodes/ExcalidrawNode/ExcalidrawImage.tsx","../src/nodes/ExcalidrawNode/index.tsx","../src/plugins/ExcalidrawPlugin.ts","../src/plugins/HorizontalRulePlugin.ts","../src/shared/src/getDOMSelection.ts","../src/nodes/KeywordNode.ts","../src/plugins/KeywordsPlugin.ts","../src/shared/src/canUseDOM.ts","../src/shared/src/useLayoutEffect.ts","../src/nodes/MentionNode.ts","../src/plugins/MentionsPlugin.tsx","../src/plugins/TableActionMenuPlugin.tsx","../src/nodes/ImageNode.tsx","../src/plugins/ImagesPlugin.ts","../src/plugins/ListMaxIndentLevelPlugin.ts","../src/plugins/MaxLengthPlugin.tsx","../src/nodes/PollNode.tsx","../src/plugins/PollPlugin.ts","../src/hooks/useReport.ts","../src/plugins/SpeechToTextPlugin.ts","../src/plugins/TabFocusPlugin.tsx","../src/plugins/TableCellResizer.tsx","../src/plugins/TextFormatFloatingToolbarPlugin.tsx","../src/shared/src/environment.ts","../src/nodes/StickyNode.tsx","../src/ui/DropDown.tsx","../src/ui/TextInput.tsx","../src/ui/ColorPicker.tsx","../src/ui/FileInput.tsx","../src/ui/KatexEquationAlterer.tsx","../src/ui/LinkPreview.tsx","../src/nodes/TweetNode.tsx","../src/plugins/TwitterPlugin.ts","../src/nodes/YouTubeNode.tsx","../src/plugins/YouTubePlugin.ts","../src/plugins/ToolbarPlugin.tsx","../src/ui/Placeholder.tsx","../src/Editor.tsx","../src/nodes/TypeaheadNode.ts","../src/nodes/PlaygroundNodes.ts","../src/plugins/TestRecorderPlugin.tsx","../src/ui/Switch.tsx","../src/Settings.tsx","../src/themes/PlaygroundEditorTheme.ts","../src/App.tsx","../src/index.tsx"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nexport type SettingName =\n  | 'disableBeforeInput'\n  | 'measureTypingPerf'\n  | 'isRichText'\n  | 'isCollab'\n  | 'isCharLimit'\n  | 'isMaxLength'\n  | 'isCharLimitUtf8'\n  | 'isAutocomplete'\n  | 'showTreeView'\n  | 'showNestedEditorTreeView'\n  | 'emptyEditor';\n\nexport type Settings = Record<SettingName, boolean>;\n\nconst hostName = window.location.hostname;\nexport const isDevPlayground: boolean =\n  hostName !== 'playground.lexical.dev' &&\n  hostName !== 'lexical-playground.vercel.app';\n\nexport const DEFAULT_SETTINGS: Settings = {\n  disableBeforeInput: false,\n  emptyEditor: isDevPlayground,\n  isAutocomplete: false,\n  isCharLimit: false,\n  isCharLimitUtf8: false,\n  isCollab: false,\n  isMaxLength: false,\n  isRichText: true,\n  measureTypingPerf: false,\n  showNestedEditorTreeView: false,\n  showTreeView: true,\n};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {DEFAULT_SETTINGS, Settings} from './appSettings';\n\n// override default options with query parameters if any\nconst urlSearchParams = new URLSearchParams(window.location.search);\n\nfor (const param of Object.keys(DEFAULT_SETTINGS)) {\n  if (urlSearchParams.has(param)) {\n    try {\n      const value = JSON.parse(urlSearchParams.get(param) ?? 'true');\n      DEFAULT_SETTINGS[param as keyof Settings] = Boolean(value);\n    } catch (error) {\n      console.warn(`Unable to parse query parameter \"${param}\"`);\n    }\n  }\n}\n\nif (DEFAULT_SETTINGS.disableBeforeInput) {\n  // @ts-expect-error\n  delete window.InputEvent.prototype.getTargetRanges;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {SettingName} from '../appSettings';\n\nimport * as React from 'react';\nimport {\n  createContext,\n  ReactNode,\n  useCallback,\n  useContext,\n  useMemo,\n  useState,\n} from 'react';\n\nimport {DEFAULT_SETTINGS} from '../appSettings';\n\ntype SettingsContextShape = {\n  setOption: (name: SettingName, value: boolean) => void;\n  settings: Record<SettingName, boolean>;\n};\n\nconst Context: React.Context<SettingsContextShape> = createContext({\n  setOption: (name: SettingName, value: boolean) => {\n    return;\n  },\n  settings: DEFAULT_SETTINGS,\n});\n\nexport const SettingsContext = ({\n  children,\n}: {\n  children: ReactNode;\n}): JSX.Element => {\n  const [settings, setSettings] = useState(DEFAULT_SETTINGS);\n\n  const setOption = useCallback((setting: SettingName, value: boolean) => {\n    setSettings((options) => ({\n      ...options,\n      [setting as string]: value,\n    }));\n    if (DEFAULT_SETTINGS[setting] === value) {\n      setURLParam(setting, null);\n    } else {\n      setURLParam(setting, value);\n    }\n  }, []);\n\n  const contextValue = useMemo(() => {\n    return {setOption, settings};\n  }, [setOption, settings]);\n\n  return <Context.Provider value={contextValue}>{children}</Context.Provider>;\n};\n\nexport const useSettings = (): SettingsContextShape => {\n  return useContext(Context);\n};\n\nfunction setURLParam(param: SettingName, value: null | boolean) {\n  const url = new URL(window.location.href);\n  const params = new URLSearchParams(url.search);\n  if (value !== null) {\n    if (params.has(param)) {\n      params.set(param, String(value));\n    } else {\n      params.append(param, String(value));\n    }\n  } else {\n    if (params.has(param)) {\n      params.delete(param);\n    }\n  }\n  url.search = params.toString();\n  window.history.pushState(null, '', url.toString());\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {HistoryState} from '@lexical/react/LexicalHistoryPlugin';\n\nimport {createEmptyHistoryState} from '@lexical/react/LexicalHistoryPlugin';\nimport * as React from 'react';\nimport {createContext, ReactNode, useContext, useMemo} from 'react';\n\ntype ContextShape = {\n  historyState?: HistoryState;\n};\n\nconst Context: React.Context<ContextShape> = createContext({});\n\nexport const SharedHistoryContext = ({\n  children,\n}: {\n  children: ReactNode;\n}): JSX.Element => {\n  const historyContext = useMemo(\n    () => ({historyState: createEmptyHistoryState()}),\n    [],\n  );\n  return <Context.Provider value={historyContext}>{children}</Context.Provider>;\n};\n\nexport const useSharedHistoryContext = (): ContextShape => {\n  return useContext(Context);\n};\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\n// import './Modal.css';\n\nimport * as React from 'react';\nimport {ReactNode, useEffect, useRef} from 'react';\nimport {createPortal} from 'react-dom';\n\nfunction PortalImpl({\n  onClose,\n  children,\n  title,\n  closeOnClickOutside,\n}: {\n  children: ReactNode;\n  closeOnClickOutside: boolean;\n  onClose: () => void;\n  title: string;\n}) {\n  const modalRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (modalRef.current !== null) {\n      modalRef.current.focus();\n    }\n  }, []);\n\n  useEffect(() => {\n    let modalOverlayElement: HTMLElement | null = null;\n    const handler = (event: KeyboardEvent) => {\n      if (event.keyCode === 27) {\n        onClose();\n      }\n    };\n    const clickOutsideHandler = (event: MouseEvent) => {\n      const target = event.target;\n      if (\n        modalRef.current !== null &&\n        !modalRef.current.contains(target as Node) &&\n        closeOnClickOutside\n      ) {\n        onClose();\n      }\n    };\n    if (modalRef.current !== null) {\n      modalOverlayElement = modalRef.current?.parentElement;\n      if (modalOverlayElement !== null) {\n        modalOverlayElement?.addEventListener('click', clickOutsideHandler);\n      }\n    }\n\n    window.addEventListener('keydown', handler);\n\n    return () => {\n      window.removeEventListener('keydown', handler);\n      if (modalOverlayElement !== null) {\n        modalOverlayElement?.removeEventListener('click', clickOutsideHandler);\n      }\n    };\n  }, [closeOnClickOutside, onClose]);\n\n  return (\n    <div className=\"Modal__overlay\" role=\"dialog\">\n      <div className=\"Modal__modal\" tabIndex={-1} ref={modalRef}>\n        <h2 className=\"Modal__title\">{title}</h2>\n        <button\n          className=\"Modal__closeButton\"\n          aria-label=\"Close modal\"\n          type=\"button\"\n          onClick={onClose}>\n          X\n        </button>\n        <div className=\"Modal__content\">{children}</div>\n      </div>\n    </div>\n  );\n}\n\nexport default function Modal({\n  onClose,\n  children,\n  title,\n  closeOnClickOutside = false,\n}: {\n  children: ReactNode;\n  closeOnClickOutside?: boolean;\n  onClose: () => void;\n  title: string;\n}): JSX.Element {\n  return createPortal(\n    <PortalImpl\n      onClose={onClose}\n      title={title}\n      closeOnClickOutside={closeOnClickOutside}>\n      {children}\n    </PortalImpl>,\n    document.body,\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useCallback, useMemo, useState} from 'react';\nimport * as React from 'react';\n\nimport Modal from '../ui/Modal';\n\nexport default function useModal(): [\n  JSX.Element | null,\n  (title: string, showModal: (onClose: () => void) => JSX.Element) => void,\n] {\n  const [modalContent, setModalContent] = useState<null | {\n    closeOnClickOutside: boolean;\n    content: JSX.Element;\n    title: string;\n  }>(null);\n\n  const onClose = useCallback(() => {\n    setModalContent(null);\n  }, []);\n\n  const modal = useMemo(() => {\n    if (modalContent === null) {\n      return null;\n    }\n    const {title, content, closeOnClickOutside} = modalContent;\n    return (\n      <Modal\n        onClose={onClose}\n        title={title}\n        closeOnClickOutside={closeOnClickOutside}>\n        {content}\n      </Modal>\n    );\n  }, [modalContent, onClose]);\n\n  const showModal = useCallback(\n    (\n      title: string,\n      // eslint-disable-next-line no-shadow\n      getContent: (onClose: () => void) => JSX.Element,\n      closeOnClickOutside = false,\n    ) => {\n      setModalContent({\n        closeOnClickOutside,\n        content: getContent(onClose),\n        title,\n      });\n    },\n    [onClose],\n  );\n\n  return [modal, showModal];\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nexport default function joinClasses(\n  ...args: Array<string | boolean | null | undefined>\n) {\n  return args.filter(Boolean).join(' ');\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\n// import './Button.css';\n\nimport * as React from 'react';\nimport {ReactNode} from 'react';\n\nimport joinClasses from '../utils/join-classes';\n\nexport default function Button({\n  'data-test-id': dataTestId,\n  children,\n  className,\n  onClick,\n  disabled,\n  small,\n  title,\n}: {\n  'data-test-id'?: string;\n  children: ReactNode;\n  className?: string;\n  disabled?: boolean;\n  onClick: () => void;\n  small?: boolean;\n  title?: string;\n}): JSX.Element {\n  return (\n    <button\n      disabled={disabled}\n      className={joinClasses(\n        'Button__root',\n        disabled && 'Button__disabled',\n        small && 'Button__small',\n        className,\n      )}\n      onClick={onClick}\n      title={title}\n      aria-label={title}\n      {...(dataTestId && {'data-test-id': dataTestId})}>\n      {children}\n    </button>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {LexicalEditor} from 'lexical';\n\nimport {$createCodeNode, $isCodeNode} from '@lexical/code';\n// import {exportFile, importFile} from '@lexical/file';\nimport {\n  $convertFromMarkdownString,\n  $convertToMarkdownString,\n} from '@lexical/markdown';\n// import {useCollaborationContext} from '@lexical/react/LexicalCollaborationPlugin';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {mergeRegister} from '@lexical/utils';\nimport {CONNECTED_COMMAND, TOGGLE_CONNECT_COMMAND} from '@lexical/yjs';\nimport {\n  $createTextNode,\n  $getRoot,\n  $isParagraphNode,\n  CLEAR_EDITOR_COMMAND,\n  COMMAND_PRIORITY_EDITOR,\n} from 'lexical';\nimport * as React from 'react';\nimport {useCallback, useEffect, useState} from 'react';\n\nimport useModal from '../hooks/useModal';\nimport Button from '../ui/Button';\n// import {PLAYGROUND_TRANSFORMERS} from './MarkdownTransformers';\nimport {\n  SPEECH_TO_TEXT_COMMAND,\n  SUPPORT_SPEECH_RECOGNITION,\n} from './SpeechToTextPlugin';\n\nexport default function ActionsPlugin({\n  isRichText,\n}: {\n  isRichText: boolean;\n}): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n  // const [isReadOnly, setIsReadyOnly] = useState(() => editor.isReadOnly());\n  const [isSpeechToText, setIsSpeechToText] = useState(false);\n  const [connected, setConnected] = useState(false);\n  const [isEditorEmpty, setIsEditorEmpty] = useState(true);\n  const [modal, showModal] = useModal();\n  // const {yjsDocMap} = useCollaborationContext();\n  // const isCollab = yjsDocMap.get('main') !== undefined;\n\n  // useEffect(() => {\n  //   return mergeRegister(\n  //     editor.registerReadOnlyListener((readOnly) => {\n  //       setIsReadyOnly(readOnly);\n  //     }),\n  //     editor.registerCommand<boolean>(\n  //       CONNECTED_COMMAND,\n  //       (payload) => {\n  //         const isConnected = payload;\n  //         setConnected(isConnected);\n  //         return false;\n  //       },\n  //       COMMAND_PRIORITY_EDITOR,\n  //     ),\n  //   );\n  // }, [editor]);\n\n  useEffect(() => {\n    return editor.registerUpdateListener(() => {\n      editor.getEditorState().read(() => {\n        const root = $getRoot();\n        const children = root.getChildren();\n\n        if (children.length > 1) {\n          setIsEditorEmpty(false);\n        } else {\n          if ($isParagraphNode(children[0])) {\n            const paragraphChildren = children[0].getChildren();\n            setIsEditorEmpty(paragraphChildren.length === 0);\n          } else {\n            setIsEditorEmpty(false);\n          }\n        }\n      });\n    });\n  }, [editor]);\n\n  const handleMarkdownToggle = useCallback(() => {\n    editor.update(() => {\n      const root = $getRoot();\n      const firstChild = root.getFirstChild();\n      if ($isCodeNode(firstChild) && firstChild.getLanguage() === 'markdown') {\n        // $convertFromMarkdownString(\n        //   firstChild.getTextContent(),\n        //   PLAYGROUND_TRANSFORMERS,\n        // );\n      } else {\n        // const markdown = $convertToMarkdownString(PLAYGROUND_TRANSFORMERS);\n        // root\n        //   .clear()\n        //   .append(\n        //     $createCodeNode('markdown').append($createTextNode(markdown)),\n        //   );\n      }\n      root.selectEnd();\n    });\n  }, [editor]);\n\n  return (\n    <div className=\"actions\">\n      {/* {SUPPORT_SPEECH_RECOGNITION && (\n        // <button\n        //   onClick={() => {\n        //     editor.dispatchCommand<boolean>(\n        //       SPEECH_TO_TEXT_COMMAND,\n        //       !isSpeechToText,\n        //     );\n        //     setIsSpeechToText(!isSpeechToText);\n        //   }}\n        //   className={\n        //     'action-button action-button-mic ' +\n        //     (isSpeechToText ? 'active' : '')\n        //   }\n        //   title=\"Speech To Text\"\n        //   aria-label={`${\n        //     isSpeechToText ? 'Enable' : 'Disable'\n        //   } speech to text`}>\n        //   <i className=\"mic\" />\n        // </button>\n      )} */}\n      {/* <button\n        className=\"action-button import\"\n        onClick={() => importFile(editor)}\n        title=\"Import\"\n        aria-label=\"Import editor state from JSON\">\n        <i className=\"import\" />\n      </button> */}\n      {/* <button\n        className=\"action-button export\"\n        onClick={() =>\n          exportFile(editor, {\n            fileName: `Playground ${new Date().toISOString()}`,\n            source: 'Playground',\n          })\n        }\n        title=\"Export\"\n        aria-label=\"Export editor state to JSON\">\n        <i className=\"export\" />\n      </button> */}\n      <button\n        className=\"action-button clear\"\n        disabled={isEditorEmpty}\n        onClick={() => {\n          showModal('Clear editor', (onClose) => (\n            <ShowClearDialog editor={editor} onClose={onClose} />\n          ));\n        }}\n        title=\"Clear\"\n        aria-label=\"Clear editor contents\">\n        <i className=\"clear\" />\n      </button>\n      {/* <button\n        className={`action-button ${isReadOnly ? 'unlock' : 'lock'}`}\n        onClick={() => {\n          editor.setReadOnly(!editor.isReadOnly());\n        }}\n        title=\"Read-Only Mode\"\n        aria-label={`${isReadOnly ? 'Unlock' : 'Lock'} read-only mode`}>\n        <i className={isReadOnly ? 'unlock' : 'lock'} />\n      </button> */}\n      <button\n        className=\"action-button\"\n        onClick={handleMarkdownToggle}\n        title=\"Convert From Markdown\"\n        aria-label=\"Convert from markdown\">\n        <i className=\"markdown\" />\n      </button>\n      {/* {isCollab && (\n        <button\n          className=\"action-button connect\"\n          onClick={() => {\n            editor.dispatchCommand(TOGGLE_CONNECT_COMMAND, !connected);\n          }}\n          title={`${\n            connected ? 'Disconnect' : 'Connect'\n          } Collaborative Editing`}\n          aria-label={`${\n            connected ? 'Disconnect from' : 'Connect to'\n          } a collaborative editing server`}>\n          <i className={connected ? 'disconnect' : 'connect'} />\n        </button>\n      )} */}\n      {modal}\n    </div>\n  );\n}\n\nfunction ShowClearDialog({\n  editor,\n  onClose,\n}: {\n  editor: LexicalEditor;\n  onClose: () => void;\n}): JSX.Element {\n  return (\n    <>\n      Are you sure you want to clear the editor?\n      <div className=\"Modal__content\">\n        {/* <Button\n          onClick={() => {\n            editor.dispatchCommand<void>(CLEAR_EDITOR_COMMAND, undefined);\n            editor.focus();\n            onClose();\n          }}>\n          Clear\n        </Button>{' '} */}\n        <Button\n          onClick={() => {\n            editor.focus();\n            onClose();\n          }}>\n          Cancel\n        </Button>\n      </div>\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {Spread} from 'lexical';\n\nimport {\n  DecoratorNode,\n  EditorConfig,\n  NodeKey,\n  SerializedLexicalNode,\n} from 'lexical';\nimport * as React from 'react';\n\n// import {useSharedAutocompleteContext} from '../context/SharedAutocompleteContext';\nimport {uuid as UUID} from '../plugins/AutocompletePlugin';\n\nexport type SerializedAutocompleteNode = Spread<\n  {\n    type: 'autocomplete';\n    version: 1;\n    uuid: string;\n  },\n  SerializedLexicalNode\n>;\n\nexport class AutocompleteNode extends DecoratorNode<JSX.Element | null> {\n  // TODO add comment\n  __uuid: string;\n\n  static clone(node: AutocompleteNode): AutocompleteNode {\n    return new AutocompleteNode(node.__key);\n  }\n\n  static getType(): 'autocomplete' {\n    return 'autocomplete';\n  }\n\n  static importJSON(\n    serializedNode: SerializedAutocompleteNode,\n  ): AutocompleteNode {\n    const node = $createAutocompleteNode(serializedNode.uuid);\n    return node;\n  }\n\n  exportJSON(): SerializedAutocompleteNode {\n    return {\n      ...super.exportJSON(),\n      type: 'autocomplete',\n      uuid: this.__uuid,\n      version: 1,\n    };\n  }\n\n  constructor(uuid: string, key?: NodeKey) {\n    super(key);\n    this.__uuid = uuid;\n  }\n\n  updateDOM(\n    prevNode: unknown,\n    dom: HTMLElement,\n    config: EditorConfig,\n  ): boolean {\n    return false;\n  }\n\n  createDOM(config: EditorConfig): HTMLElement {\n    return document.createElement('span');\n  }\n\n  decorate(): JSX.Element | null {\n    if (this.__uuid !== UUID) {\n      return null;\n    }\n    return <AutocompleteComponent />;\n  }\n}\n\nexport function $createAutocompleteNode(uuid: string): AutocompleteNode {\n  return new AutocompleteNode(uuid);\n}\n\nfunction AutocompleteComponent(): JSX.Element {\n  // const [suggestion] = useSharedAutocompleteContext();\n  // @ts-ignore Experimental property\n  const userAgentData = window.navigator.userAgentData;\n  const isMobile =\n    userAgentData !== undefined\n      ? userAgentData.mobile\n      : window.innerWidth <= 800 && window.innerHeight <= 600;\n  // TODO Move to theme\n  return (\n    <span style={{color: '#ccc'}} spellCheck=\"false\">\n      {/* {suggestion} {isMobile ? '(SWIPE \\u2B95)' : '(TAB)'} */}\n    </span>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\ntype Force = [number, number];\ntype Listener = (force: Force, e: TouchEvent) => void;\ntype ElementValues = {\n  start: null | Force;\n  listeners: Set<Listener>;\n  handleTouchstart: (e: TouchEvent) => void;\n  handleTouchend: (e: TouchEvent) => void;\n};\n\nconst elements = new WeakMap<HTMLElement, ElementValues>();\n\nfunction readTouch(e: TouchEvent): [number, number] | null {\n  const touch = e.changedTouches[0];\n  if (touch === undefined) {\n    return null;\n  }\n  return [touch.clientX, touch.clientY];\n}\n\nfunction addListener(element: HTMLElement, cb: Listener): () => void {\n  let elementValues = elements.get(element);\n  if (elementValues === undefined) {\n    const listeners = new Set<Listener>();\n    const handleTouchstart = (e: TouchEvent) => {\n      if (elementValues !== undefined) {\n        elementValues.start = readTouch(e);\n      }\n    };\n    const handleTouchend = (e: TouchEvent) => {\n      if (elementValues === undefined) {\n        return;\n      }\n      const start = elementValues.start;\n      if (start === null) {\n        return;\n      }\n      const end = readTouch(e);\n      for (const listener of listeners) {\n        if (end !== null) {\n          listener([end[0] - start[0], end[1] - start[1]], e);\n        }\n      }\n    };\n    element.addEventListener('touchstart', handleTouchstart);\n    element.addEventListener('touchend', handleTouchend);\n\n    elementValues = {\n      handleTouchend,\n      handleTouchstart,\n      listeners,\n      start: null,\n    };\n    elements.set(element, elementValues);\n  }\n  elementValues.listeners.add(cb);\n  return () => deleteListener(element, cb);\n}\n\nfunction deleteListener(element: HTMLElement, cb: Listener): void {\n  const elementValues = elements.get(element);\n  if (elementValues === undefined) {\n    return;\n  }\n  const listeners = elementValues.listeners;\n  listeners.delete(cb);\n  if (listeners.size === 0) {\n    elements.delete(element);\n    element.removeEventListener('touchstart', elementValues.handleTouchstart);\n    element.removeEventListener('touchend', elementValues.handleTouchend);\n  }\n}\n\nexport function addSwipeLeftListener(\n  element: HTMLElement,\n  cb: (_force: number, e: TouchEvent) => void,\n) {\n  return addListener(element, (force, e) => {\n    const [x, y] = force;\n    if (x < 0 && -x > Math.abs(y)) {\n      cb(x, e);\n    }\n  });\n}\n\nexport function addSwipeRightListener(\n  element: HTMLElement,\n  cb: (_force: number, e: TouchEvent) => void,\n) {\n  return addListener(element, (force, e) => {\n    const [x, y] = force;\n    if (x > 0 && x > Math.abs(y)) {\n      cb(x, e);\n    }\n  });\n}\n\nexport function addSwipeUpListener(\n  element: HTMLElement,\n  cb: (_force: number, e: TouchEvent) => void,\n) {\n  return addListener(element, (force, e) => {\n    const [x, y] = force;\n    if (y < 0 && -y > Math.abs(x)) {\n      cb(x, e);\n    }\n  });\n}\n\nexport function addSwipeDownListener(\n  element: HTMLElement,\n  cb: (_force: number, e: TouchEvent) => void,\n) {\n  return addListener(element, (force, e) => {\n    const [x, y] = force;\n    if (y > 0 && y > Math.abs(x)) {\n      cb(x, e);\n    }\n  });\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  GridSelection,\n  NodeKey,\n  NodeSelection,\n  RangeSelection,\n} from 'lexical';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {$isAtNodeEnd} from '@lexical/selection';\nimport {mergeRegister} from '@lexical/utils';\nimport {\n  $createTextNode,\n  $getNodeByKey,\n  $getSelection,\n  $isRangeSelection,\n  $isTextNode,\n  $setSelection,\n  COMMAND_PRIORITY_LOW,\n  KEY_ARROW_RIGHT_COMMAND,\n  KEY_TAB_COMMAND,\n} from 'lexical';\nimport {useCallback, useEffect} from 'react';\n\n// import {useSharedAutocompleteContext} from '../context/SharedAutocompleteContext';\nimport {\n  $createAutocompleteNode,\n  AutocompleteNode,\n} from '../nodes/AutocompleteNode';\nimport {addSwipeRightListener} from '../utils/swipe';\n\ntype SearchPromise = {\n  dismiss: () => void;\n  promise: Promise<null | string>;\n};\n\nexport const uuid = Math.random()\n  .toString(36)\n  .replace(/[^a-z]+/g, '')\n  .substr(0, 5);\n\n// TODO lookup should be custom\nfunction $search(\n  selection: null | RangeSelection | NodeSelection | GridSelection,\n): [boolean, string] {\n  if (!$isRangeSelection(selection) || !selection.isCollapsed()) {\n    return [false, ''];\n  }\n  const node = selection.getNodes()[0];\n  const anchor = selection.anchor;\n  // Check siblings?\n  if (!$isTextNode(node) || !node.isSimpleText() || !$isAtNodeEnd(anchor)) {\n    return [false, ''];\n  }\n  const word = [];\n  const text = node.getTextContent();\n  let i = node.getTextContentSize();\n  let c;\n  while (i-- && i >= 0 && (c = text[i]) !== ' ') {\n    word.push(c);\n  }\n  if (word.length === 0) {\n    return [false, ''];\n  }\n  return [true, word.reverse().join('')];\n}\n\n// TODO query should be custom\nfunction useQuery(): (searchText: string) => SearchPromise {\n  return useCallback((searchText: string) => {\n    const server = new AutocompleteServer();\n    console.time('query');\n    const response = server.query(searchText);\n    console.timeEnd('query');\n    return response;\n  }, []);\n}\n\nexport default function AutocompletePlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n  // const [, setSuggestion] = useSharedAutocompleteContext();\n  const query = useQuery();\n\n  useEffect(() => {\n    let autocompleteNodeKey: null | NodeKey = null;\n    let lastMatch: null | string = null;\n    let lastSuggestion: null | string = null;\n    let searchPromise: null | SearchPromise = null;\n    function $clearSuggestion() {\n      const autocompleteNode =\n        autocompleteNodeKey !== null\n          ? $getNodeByKey(autocompleteNodeKey)\n          : null;\n      if (autocompleteNode !== null && autocompleteNode.isAttached()) {\n        autocompleteNode.remove();\n        autocompleteNodeKey = null;\n      }\n      if (searchPromise !== null) {\n        searchPromise.dismiss();\n        searchPromise = null;\n      }\n      lastMatch = null;\n      lastSuggestion = null;\n      // setSuggestion(null);\n    }\n    function updateAsyncSuggestion(\n      refSearchPromise: SearchPromise,\n      newSuggestion: null | string,\n    ) {\n      if (searchPromise !== refSearchPromise || newSuggestion === null) {\n        // Outdated or no suggestion\n        return;\n      }\n      editor.update(\n        () => {\n          const selection = $getSelection();\n          // const [hasMatch, match] = $search(selection);\n          // if (\n          //   !hasMatch ||\n          //   match !== lastMatch ||\n          //   !$isRangeSelection(selection)\n          // ) {\n          //   // Outdated\n          //   return;\n          // }\n          // const selectionCopy = selection.clone();\n          // const node = $createAutocompleteNode(uuid);\n          // autocompleteNodeKey = node.getKey();\n          // selection.insertNodes([node]);\n          // $setSelection(selectionCopy);\n          lastSuggestion = newSuggestion;\n          // setSuggestion(newSuggestion);\n        },\n        {tag: 'history-merge'},\n      );\n    }\n\n    function handleAutocompleteNodeTransform(node: AutocompleteNode) {\n      const key = node.getKey();\n      if (node.__uuid === uuid && key !== autocompleteNodeKey) {\n        // Max one Autocomplete node per session\n        $clearSuggestion();\n      }\n    }\n    function handleUpdate() {\n      editor.update(() => {\n        const selection = $getSelection();\n        // const [hasMatch, match] = $search(selection);\n        // if (!hasMatch) {\n        //   $clearSuggestion();\n        //   return;\n        // }\n        // if (match === lastMatch) {\n        //   return;\n        // }\n        $clearSuggestion();\n        // searchPromise = query(match);\n        // searchPromise.promise\n        //   .then((newSuggestion) => {\n        //     if (searchPromise !== null) {\n        //       updateAsyncSuggestion(searchPromise, newSuggestion);\n        //     }\n        //   })\n        //   .catch((e) => {\n        //     console.error(e);\n        //   });\n        // lastMatch = match;\n      });\n    }\n    function $handleAutocompleteIntent(): boolean {\n      if (lastSuggestion === null || autocompleteNodeKey === null) {\n        return false;\n      }\n      const autocompleteNode = $getNodeByKey(autocompleteNodeKey);\n      if (autocompleteNode === null) {\n        return false;\n      }\n      const textNode = $createTextNode(lastSuggestion);\n      autocompleteNode.replace(textNode);\n      textNode.selectNext();\n      $clearSuggestion();\n      return true;\n    }\n    function $handleKeypressCommand(e: Event) {\n      if ($handleAutocompleteIntent()) {\n        e.preventDefault();\n        return true;\n      }\n      return false;\n    }\n    function handleSwipeRight(_force: number, e: TouchEvent) {\n      editor.update(() => {\n        if ($handleAutocompleteIntent()) {\n          e.preventDefault();\n        }\n      });\n    }\n    function unmountSuggestion() {\n      editor.update(() => {\n        $clearSuggestion();\n      });\n    }\n\n    const rootElem = editor.getRootElement();\n\n    return mergeRegister(\n      editor.registerNodeTransform(\n        AutocompleteNode,\n        handleAutocompleteNodeTransform,\n      ),\n      editor.registerUpdateListener(handleUpdate),\n      editor.registerCommand(\n        KEY_TAB_COMMAND,\n        $handleKeypressCommand,\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand(\n        KEY_ARROW_RIGHT_COMMAND,\n        $handleKeypressCommand,\n        COMMAND_PRIORITY_LOW,\n      ),\n      ...(rootElem !== null\n        ? [addSwipeRightListener(rootElem, handleSwipeRight)]\n        : []),\n      unmountSuggestion,\n    );\n  }, [editor, query]);\n\n  return null;\n}\n\n/*\n * Simulate an asynchronous autocomplete server (typical in more common use cases like GMail where\n * the data is not static).\n */\nclass AutocompleteServer {\n  DATABASE = DICTIONARY;\n  LATENCY = 200;\n\n  query = (searchText: string): SearchPromise => {\n    let isDismissed = false;\n\n    const dismiss = () => {\n      isDismissed = true;\n    };\n    const promise: Promise<null | string> = new Promise((resolve, reject) => {\n      setTimeout(() => {\n        if (isDismissed) {\n          // TODO cache result\n          return reject('Dismissed');\n        }\n        const searchTextLength = searchText.length;\n        if (searchText === '' || searchTextLength < 4) {\n          return resolve(null);\n        }\n        const char0 = searchText.charCodeAt(0);\n        const isCapitalized = char0 >= 65 && char0 <= 90;\n        const caseInsensitiveSearchText = isCapitalized\n          ? String.fromCharCode(char0 + 32) + searchText.substring(1)\n          : searchText;\n        const match = this.DATABASE.find(\n          (dictionaryWord) =>\n            dictionaryWord.startsWith(caseInsensitiveSearchText) ?? null,\n        );\n        if (match === undefined) {\n          return resolve(null);\n        }\n        const matchCapitalized = isCapitalized\n          ? String.fromCharCode(match.charCodeAt(0) - 32) + match.substring(1)\n          : match;\n        const autocompleteChunk = matchCapitalized.substring(searchTextLength);\n        if (autocompleteChunk === '') {\n          return resolve(null);\n        }\n        return resolve(autocompleteChunk);\n      }, this.LATENCY);\n    });\n\n    return {\n      dismiss,\n      promise,\n    };\n  };\n}\n\n// https://raw.githubusercontent.com/first20hours/google-10000-english/master/google-10000-english-usa-no-swears-long.txt\nconst DICTIONARY = [\n  'information',\n  'available',\n  'copyright',\n  'university',\n  'management',\n  'international',\n  'development',\n  'education',\n  'community',\n  'technology',\n  'following',\n  'resources',\n  'including',\n  'directory',\n  'government',\n  'department',\n  'description',\n  'insurance',\n  'different',\n  'categories',\n  'conditions',\n  'accessories',\n  'september',\n  'questions',\n  'application',\n  'financial',\n  'equipment',\n  'performance',\n  'experience',\n  'important',\n  'activities',\n  'additional',\n  'something',\n  'professional',\n  'committee',\n  'washington',\n  'california',\n  'reference',\n  'companies',\n  'computers',\n  'president',\n  'australia',\n  'discussion',\n  'entertainment',\n  'agreement',\n  'marketing',\n  'association',\n  'collection',\n  'solutions',\n  'electronics',\n  'technical',\n  'microsoft',\n  'conference',\n  'environment',\n  'statement',\n  'downloads',\n  'applications',\n  'requirements',\n  'individual',\n  'subscribe',\n  'everything',\n  'production',\n  'commercial',\n  'advertising',\n  'treatment',\n  'newsletter',\n  'knowledge',\n  'currently',\n  'construction',\n  'registered',\n  'protection',\n  'engineering',\n  'published',\n  'corporate',\n  'customers',\n  'materials',\n  'countries',\n  'standards',\n  'political',\n  'advertise',\n  'environmental',\n  'availability',\n  'employment',\n  'commission',\n  'administration',\n  'institute',\n  'sponsored',\n  'electronic',\n  'condition',\n  'effective',\n  'organization',\n  'selection',\n  'corporation',\n  'executive',\n  'necessary',\n  'according',\n  'particular',\n  'facilities',\n  'opportunities',\n  'appropriate',\n  'statistics',\n  'investment',\n  'christmas',\n  'registration',\n  'furniture',\n  'wednesday',\n  'structure',\n  'distribution',\n  'industrial',\n  'potential',\n  'responsible',\n  'communications',\n  'associated',\n  'foundation',\n  'documents',\n  'communication',\n  'independent',\n  'operating',\n  'developed',\n  'telephone',\n  'population',\n  'navigation',\n  'operations',\n  'therefore',\n  'christian',\n  'understand',\n  'publications',\n  'worldwide',\n  'connection',\n  'publisher',\n  'introduction',\n  'properties',\n  'accommodation',\n  'excellent',\n  'opportunity',\n  'assessment',\n  'especially',\n  'interface',\n  'operation',\n  'restaurants',\n  'beautiful',\n  'locations',\n  'significant',\n  'technologies',\n  'manufacturer',\n  'providing',\n  'authority',\n  'considered',\n  'programme',\n  'enterprise',\n  'educational',\n  'employees',\n  'alternative',\n  'processing',\n  'responsibility',\n  'resolution',\n  'publication',\n  'relations',\n  'photography',\n  'components',\n  'assistance',\n  'completed',\n  'organizations',\n  'otherwise',\n  'transportation',\n  'disclaimer',\n  'membership',\n  'recommended',\n  'background',\n  'character',\n  'maintenance',\n  'functions',\n  'trademarks',\n  'phentermine',\n  'submitted',\n  'television',\n  'interested',\n  'throughout',\n  'established',\n  'programming',\n  'regarding',\n  'instructions',\n  'increased',\n  'understanding',\n  'beginning',\n  'associates',\n  'instruments',\n  'businesses',\n  'specified',\n  'restaurant',\n  'procedures',\n  'relationship',\n  'traditional',\n  'sometimes',\n  'themselves',\n  'transport',\n  'interesting',\n  'evaluation',\n  'implementation',\n  'galleries',\n  'references',\n  'presented',\n  'literature',\n  'respective',\n  'definition',\n  'secretary',\n  'networking',\n  'australian',\n  'magazines',\n  'francisco',\n  'individuals',\n  'guidelines',\n  'installation',\n  'described',\n  'attention',\n  'difference',\n  'regulations',\n  'certificate',\n  'directions',\n  'documentation',\n  'automotive',\n  'successful',\n  'communities',\n  'situation',\n  'publishing',\n  'emergency',\n  'developing',\n  'determine',\n  'temperature',\n  'announcements',\n  'historical',\n  'ringtones',\n  'difficult',\n  'scientific',\n  'satellite',\n  'particularly',\n  'functional',\n  'monitoring',\n  'architecture',\n  'recommend',\n  'dictionary',\n  'accounting',\n  'manufacturing',\n  'professor',\n  'generally',\n  'continued',\n  'techniques',\n  'permission',\n  'generation',\n  'component',\n  'guarantee',\n  'processes',\n  'interests',\n  'paperback',\n  'classifieds',\n  'supported',\n  'competition',\n  'providers',\n  'characters',\n  'thousands',\n  'apartments',\n  'generated',\n  'administrative',\n  'practices',\n  'reporting',\n  'essential',\n  'affiliate',\n  'immediately',\n  'designated',\n  'integrated',\n  'configuration',\n  'comprehensive',\n  'universal',\n  'presentation',\n  'languages',\n  'compliance',\n  'improvement',\n  'pennsylvania',\n  'challenge',\n  'acceptance',\n  'strategies',\n  'affiliates',\n  'multimedia',\n  'certified',\n  'computing',\n  'interactive',\n  'procedure',\n  'leadership',\n  'religious',\n  'breakfast',\n  'developer',\n  'approximately',\n  'recommendations',\n  'comparison',\n  'automatically',\n  'minnesota',\n  'adventure',\n  'institutions',\n  'assistant',\n  'advertisement',\n  'headlines',\n  'yesterday',\n  'determined',\n  'wholesale',\n  'extension',\n  'statements',\n  'completely',\n  'electrical',\n  'applicable',\n  'manufacturers',\n  'classical',\n  'dedicated',\n  'direction',\n  'basketball',\n  'wisconsin',\n  'personnel',\n  'identified',\n  'professionals',\n  'advantage',\n  'newsletters',\n  'estimated',\n  'anonymous',\n  'miscellaneous',\n  'integration',\n  'interview',\n  'framework',\n  'installed',\n  'massachusetts',\n  'associate',\n  'frequently',\n  'discussions',\n  'laboratory',\n  'destination',\n  'intelligence',\n  'specifications',\n  'tripadvisor',\n  'residential',\n  'decisions',\n  'industries',\n  'partnership',\n  'editorial',\n  'expression',\n  'provisions',\n  'principles',\n  'suggestions',\n  'replacement',\n  'strategic',\n  'economics',\n  'compatible',\n  'apartment',\n  'netherlands',\n  'consulting',\n  'recreation',\n  'participants',\n  'favorites',\n  'translation',\n  'estimates',\n  'protected',\n  'philadelphia',\n  'officials',\n  'contained',\n  'legislation',\n  'parameters',\n  'relationships',\n  'tennessee',\n  'representative',\n  'frequency',\n  'introduced',\n  'departments',\n  'residents',\n  'displayed',\n  'performed',\n  'administrator',\n  'addresses',\n  'permanent',\n  'agriculture',\n  'constitutes',\n  'portfolio',\n  'practical',\n  'delivered',\n  'collectibles',\n  'infrastructure',\n  'exclusive',\n  'originally',\n  'utilities',\n  'philosophy',\n  'regulation',\n  'reduction',\n  'nutrition',\n  'recording',\n  'secondary',\n  'wonderful',\n  'announced',\n  'prevention',\n  'mentioned',\n  'automatic',\n  'healthcare',\n  'maintained',\n  'increasing',\n  'connected',\n  'directors',\n  'participation',\n  'containing',\n  'combination',\n  'amendment',\n  'guaranteed',\n  'libraries',\n  'distributed',\n  'singapore',\n  'enterprises',\n  'convention',\n  'principal',\n  'certification',\n  'previously',\n  'buildings',\n  'household',\n  'batteries',\n  'positions',\n  'subscription',\n  'contemporary',\n  'panasonic',\n  'permalink',\n  'signature',\n  'provision',\n  'certainly',\n  'newspaper',\n  'liability',\n  'trademark',\n  'trackback',\n  'americans',\n  'promotion',\n  'conversion',\n  'reasonable',\n  'broadband',\n  'influence',\n  'importance',\n  'webmaster',\n  'prescription',\n  'specifically',\n  'represent',\n  'conservation',\n  'louisiana',\n  'javascript',\n  'marketplace',\n  'evolution',\n  'certificates',\n  'objectives',\n  'suggested',\n  'concerned',\n  'structures',\n  'encyclopedia',\n  'continuing',\n  'interracial',\n  'competitive',\n  'suppliers',\n  'preparation',\n  'receiving',\n  'accordance',\n  'discussed',\n  'elizabeth',\n  'reservations',\n  'playstation',\n  'instruction',\n  'annotation',\n  'differences',\n  'establish',\n  'expressed',\n  'paragraph',\n  'mathematics',\n  'compensation',\n  'conducted',\n  'percentage',\n  'mississippi',\n  'requested',\n  'connecticut',\n  'personals',\n  'immediate',\n  'agricultural',\n  'supporting',\n  'collections',\n  'participate',\n  'specialist',\n  'experienced',\n  'investigation',\n  'institution',\n  'searching',\n  'proceedings',\n  'transmission',\n  'characteristics',\n  'experiences',\n  'extremely',\n  'verzeichnis',\n  'contracts',\n  'concerning',\n  'developers',\n  'equivalent',\n  'chemistry',\n  'neighborhood',\n  'variables',\n  'continues',\n  'curriculum',\n  'psychology',\n  'responses',\n  'circumstances',\n  'identification',\n  'appliances',\n  'elementary',\n  'unlimited',\n  'printable',\n  'enforcement',\n  'hardcover',\n  'celebrity',\n  'chocolate',\n  'hampshire',\n  'bluetooth',\n  'controlled',\n  'requirement',\n  'authorities',\n  'representatives',\n  'pregnancy',\n  'biography',\n  'attractions',\n  'transactions',\n  'authorized',\n  'retirement',\n  'financing',\n  'efficiency',\n  'efficient',\n  'commitment',\n  'specialty',\n  'interviews',\n  'qualified',\n  'discovery',\n  'classified',\n  'confidence',\n  'lifestyle',\n  'consistent',\n  'clearance',\n  'connections',\n  'inventory',\n  'converter',\n  'organisation',\n  'objective',\n  'indicated',\n  'securities',\n  'volunteer',\n  'democratic',\n  'switzerland',\n  'parameter',\n  'processor',\n  'dimensions',\n  'contribute',\n  'challenges',\n  'recognition',\n  'submission',\n  'encourage',\n  'regulatory',\n  'inspection',\n  'consumers',\n  'territory',\n  'transaction',\n  'manchester',\n  'contributions',\n  'continuous',\n  'resulting',\n  'cambridge',\n  'initiative',\n  'execution',\n  'disability',\n  'increases',\n  'contractor',\n  'examination',\n  'indicates',\n  'committed',\n  'extensive',\n  'affordable',\n  'candidate',\n  'databases',\n  'outstanding',\n  'perspective',\n  'messenger',\n  'tournament',\n  'consideration',\n  'discounts',\n  'catalogue',\n  'publishers',\n  'caribbean',\n  'reservation',\n  'remaining',\n  'depending',\n  'expansion',\n  'purchased',\n  'performing',\n  'collected',\n  'absolutely',\n  'featuring',\n  'implement',\n  'scheduled',\n  'calculator',\n  'significantly',\n  'temporary',\n  'sufficient',\n  'awareness',\n  'vancouver',\n  'contribution',\n  'measurement',\n  'constitution',\n  'packaging',\n  'consultation',\n  'northwest',\n  'classroom',\n  'democracy',\n  'wallpaper',\n  'merchandise',\n  'resistance',\n  'baltimore',\n  'candidates',\n  'charlotte',\n  'biological',\n  'transition',\n  'preferences',\n  'instrument',\n  'classification',\n  'physician',\n  'hollywood',\n  'wikipedia',\n  'spiritual',\n  'photographs',\n  'relatively',\n  'satisfaction',\n  'represents',\n  'pittsburgh',\n  'preferred',\n  'intellectual',\n  'comfortable',\n  'interaction',\n  'listening',\n  'effectively',\n  'experimental',\n  'revolution',\n  'consolidation',\n  'landscape',\n  'dependent',\n  'mechanical',\n  'consultants',\n  'applicant',\n  'cooperation',\n  'acquisition',\n  'implemented',\n  'directories',\n  'recognized',\n  'notification',\n  'licensing',\n  'textbooks',\n  'diversity',\n  'cleveland',\n  'investments',\n  'accessibility',\n  'sensitive',\n  'templates',\n  'completion',\n  'universities',\n  'technique',\n  'contractors',\n  'subscriptions',\n  'calculate',\n  'alexander',\n  'broadcast',\n  'converted',\n  'anniversary',\n  'improvements',\n  'specification',\n  'accessible',\n  'accessory',\n  'typically',\n  'representation',\n  'arrangements',\n  'conferences',\n  'uniprotkb',\n  'consumption',\n  'birmingham',\n  'afternoon',\n  'consultant',\n  'controller',\n  'ownership',\n  'committees',\n  'legislative',\n  'researchers',\n  'unsubscribe',\n  'molecular',\n  'residence',\n  'attorneys',\n  'operators',\n  'sustainable',\n  'philippines',\n  'statistical',\n  'innovation',\n  'employers',\n  'definitions',\n  'elections',\n  'stainless',\n  'newspapers',\n  'hospitals',\n  'exception',\n  'successfully',\n  'indonesia',\n  'primarily',\n  'capabilities',\n  'recommendation',\n  'recruitment',\n  'organized',\n  'improving',\n  'expensive',\n  'organisations',\n  'explained',\n  'programmes',\n  'expertise',\n  'mechanism',\n  'jewellery',\n  'eventually',\n  'agreements',\n  'considering',\n  'innovative',\n  'conclusion',\n  'disorders',\n  'collaboration',\n  'detection',\n  'formation',\n  'engineers',\n  'proposals',\n  'moderator',\n  'tutorials',\n  'settlement',\n  'collectables',\n  'fantastic',\n  'governments',\n  'purchasing',\n  'appointed',\n  'operational',\n  'corresponding',\n  'descriptions',\n  'determination',\n  'animation',\n  'productions',\n  'telecommunications',\n  'instructor',\n  'approaches',\n  'highlights',\n  'designers',\n  'melbourne',\n  'scientists',\n  'blackjack',\n  'argentina',\n  'possibility',\n  'commissioner',\n  'dangerous',\n  'reliability',\n  'unfortunately',\n  'respectively',\n  'volunteers',\n  'attachment',\n  'appointment',\n  'workshops',\n  'hurricane',\n  'represented',\n  'mortgages',\n  'responsibilities',\n  'carefully',\n  'productivity',\n  'investors',\n  'underground',\n  'diagnosis',\n  'principle',\n  'vacations',\n  'calculated',\n  'appearance',\n  'incorporated',\n  'notebooks',\n  'algorithm',\n  'valentine',\n  'involving',\n  'investing',\n  'christopher',\n  'admission',\n  'terrorism',\n  'parliament',\n  'situations',\n  'allocated',\n  'corrections',\n  'structural',\n  'municipal',\n  'describes',\n  'disabilities',\n  'substance',\n  'prohibited',\n  'addressed',\n  'simulation',\n  'initiatives',\n  'concentration',\n  'interpretation',\n  'bankruptcy',\n  'optimization',\n  'substances',\n  'discovered',\n  'restrictions',\n  'participating',\n  'exhibition',\n  'composition',\n  'nationwide',\n  'definitely',\n  'existence',\n  'commentary',\n  'limousines',\n  'developments',\n  'immigration',\n  'destinations',\n  'necessarily',\n  'attribute',\n  'apparently',\n  'surrounding',\n  'mountains',\n  'popularity',\n  'postposted',\n  'coordinator',\n  'obviously',\n  'fundamental',\n  'substantial',\n  'progressive',\n  'championship',\n  'sacramento',\n  'impossible',\n  'depression',\n  'testimonials',\n  'memorabilia',\n  'cartridge',\n  'explanation',\n  'cincinnati',\n  'subsection',\n  'electricity',\n  'permitted',\n  'workplace',\n  'confirmed',\n  'wallpapers',\n  'infection',\n  'eligibility',\n  'involvement',\n  'placement',\n  'observations',\n  'vbulletin',\n  'subsequent',\n  'motorcycle',\n  'disclosure',\n  'establishment',\n  'presentations',\n  'undergraduate',\n  'occupation',\n  'donations',\n  'associations',\n  'citysearch',\n  'radiation',\n  'seriously',\n  'elsewhere',\n  'pollution',\n  'conservative',\n  'guestbook',\n  'effectiveness',\n  'demonstrate',\n  'atmosphere',\n  'experiment',\n  'purchases',\n  'federation',\n  'assignment',\n  'chemicals',\n  'everybody',\n  'nashville',\n  'counseling',\n  'acceptable',\n  'satisfied',\n  'measurements',\n  'milwaukee',\n  'medication',\n  'warehouse',\n  'shareware',\n  'violation',\n  'configure',\n  'stability',\n  'southwest',\n  'institutional',\n  'expectations',\n  'independence',\n  'metabolism',\n  'personally',\n  'excellence',\n  'somewhere',\n  'attributes',\n  'recognize',\n  'screening',\n  'thumbnail',\n  'forgotten',\n  'intelligent',\n  'edinburgh',\n  'obligation',\n  'regardless',\n  'restricted',\n  'republican',\n  'merchants',\n  'attendance',\n  'arguments',\n  'amsterdam',\n  'adventures',\n  'announcement',\n  'appreciate',\n  'regularly',\n  'mechanisms',\n  'customize',\n  'tradition',\n  'indicators',\n  'emissions',\n  'physicians',\n  'complaint',\n  'experiments',\n  'afghanistan',\n  'scholarship',\n  'governance',\n  'supplements',\n  'camcorder',\n  'implementing',\n  'ourselves',\n  'conversation',\n  'capability',\n  'producing',\n  'precision',\n  'contributed',\n  'reproduction',\n  'ingredients',\n  'franchise',\n  'complaints',\n  'promotions',\n  'rehabilitation',\n  'maintaining',\n  'environments',\n  'reception',\n  'correctly',\n  'consequences',\n  'geography',\n  'appearing',\n  'integrity',\n  'discrimination',\n  'processed',\n  'implications',\n  'functionality',\n  'intermediate',\n  'emotional',\n  'platforms',\n  'overnight',\n  'geographic',\n  'preliminary',\n  'districts',\n  'introduce',\n  'promotional',\n  'chevrolet',\n  'specialists',\n  'generator',\n  'suspension',\n  'correction',\n  'authentication',\n  'communicate',\n  'supplement',\n  'showtimes',\n  'promoting',\n  'machinery',\n  'bandwidth',\n  'probability',\n  'dimension',\n  'schedules',\n  'admissions',\n  'quarterly',\n  'illustrated',\n  'continental',\n  'alternate',\n  'achievement',\n  'limitations',\n  'automated',\n  'passenger',\n  'convenient',\n  'orientation',\n  'childhood',\n  'flexibility',\n  'jurisdiction',\n  'displaying',\n  'encouraged',\n  'cartridges',\n  'declaration',\n  'automation',\n  'advantages',\n  'preparing',\n  'recipient',\n  'extensions',\n  'athletics',\n  'southeast',\n  'alternatives',\n  'determining',\n  'personalized',\n  'conditioning',\n  'partnerships',\n  'destruction',\n  'increasingly',\n  'migration',\n  'basically',\n  'conventional',\n  'applicants',\n  'occupational',\n  'adjustment',\n  'treatments',\n  'camcorders',\n  'difficulty',\n  'collective',\n  'coalition',\n  'enrollment',\n  'producers',\n  'collector',\n  'interfaces',\n  'advertisers',\n  'representing',\n  'observation',\n  'restoration',\n  'convenience',\n  'returning',\n  'opposition',\n  'container',\n  'defendant',\n  'confirmation',\n  'supervisor',\n  'peripherals',\n  'bestsellers',\n  'departure',\n  'minneapolis',\n  'interactions',\n  'intervention',\n  'attraction',\n  'modification',\n  'customized',\n  'understood',\n  'assurance',\n  'happening',\n  'amendments',\n  'metropolitan',\n  'compilation',\n  'verification',\n  'attractive',\n  'recordings',\n  'jefferson',\n  'gardening',\n  'obligations',\n  'orchestra',\n  'polyphonic',\n  'outsourcing',\n  'adjustable',\n  'allocation',\n  'discipline',\n  'demonstrated',\n  'identifying',\n  'alphabetical',\n  'dispatched',\n  'installing',\n  'voluntary',\n  'photographer',\n  'messaging',\n  'constructed',\n  'additions',\n  'requiring',\n  'engagement',\n  'refinance',\n  'calendars',\n  'arrangement',\n  'conclusions',\n  'bibliography',\n  'compatibility',\n  'furthermore',\n  'cooperative',\n  'measuring',\n  'jacksonville',\n  'headquarters',\n  'transfers',\n  'transformation',\n  'attachments',\n  'administrators',\n  'personality',\n  'facilitate',\n  'subscriber',\n  'priorities',\n  'bookstore',\n  'parenting',\n  'incredible',\n  'commonwealth',\n  'pharmaceutical',\n  'manhattan',\n  'workforce',\n  'organizational',\n  'portuguese',\n  'everywhere',\n  'discharge',\n  'halloween',\n  'hazardous',\n  'methodology',\n  'housewares',\n  'reputation',\n  'resistant',\n  'democrats',\n  'recycling',\n  'qualifications',\n  'slideshow',\n  'variation',\n  'transferred',\n  'photograph',\n  'distributor',\n  'underlying',\n  'wrestling',\n  'photoshop',\n  'gathering',\n  'projection',\n  'mathematical',\n  'specialized',\n  'diagnostic',\n  'indianapolis',\n  'corporations',\n  'criticism',\n  'automobile',\n  'confidential',\n  'statutory',\n  'accommodations',\n  'northeast',\n  'downloaded',\n  'paintings',\n  'injection',\n  'yorkshire',\n  'populations',\n  'protective',\n  'initially',\n  'indicator',\n  'eliminate',\n  'sunglasses',\n  'preference',\n  'threshold',\n  'venezuela',\n  'exploration',\n  'sequences',\n  'astronomy',\n  'translate',\n  'announces',\n  'compression',\n  'establishing',\n  'constitutional',\n  'perfectly',\n  'instantly',\n  'litigation',\n  'submissions',\n  'broadcasting',\n  'horizontal',\n  'terrorist',\n  'informational',\n  'ecommerce',\n  'suffering',\n  'prospective',\n  'ultimately',\n  'artificial',\n  'spectacular',\n  'coordination',\n  'connector',\n  'affiliated',\n  'activation',\n  'naturally',\n  'subscribers',\n  'mitsubishi',\n  'underwear',\n  'potentially',\n  'constraints',\n  'inclusive',\n  'dimensional',\n  'considerable',\n  'selecting',\n  'processors',\n  'pantyhose',\n  'difficulties',\n  'complexity',\n  'constantly',\n  'barcelona',\n  'presidential',\n  'documentary',\n  'territories',\n  'palestinian',\n  'legislature',\n  'hospitality',\n  'procurement',\n  'theoretical',\n  'exercises',\n  'surveillance',\n  'protocols',\n  'highlight',\n  'substitute',\n  'inclusion',\n  'hopefully',\n  'brilliant',\n  'evaluated',\n  'assignments',\n  'termination',\n  'households',\n  'authentic',\n  'montgomery',\n  'architectural',\n  'louisville',\n  'macintosh',\n  'movements',\n  'amenities',\n  'virtually',\n  'authorization',\n  'projector',\n  'comparative',\n  'psychological',\n  'surprised',\n  'genealogy',\n  'expenditure',\n  'liverpool',\n  'connectivity',\n  'algorithms',\n  'similarly',\n  'collaborative',\n  'excluding',\n  'commander',\n  'suggestion',\n  'spotlight',\n  'investigate',\n  'connecting',\n  'logistics',\n  'proportion',\n  'significance',\n  'symposium',\n  'essentials',\n  'protecting',\n  'transmitted',\n  'screenshots',\n  'intensive',\n  'switching',\n  'correspondence',\n  'supervision',\n  'expenditures',\n  'separation',\n  'testimony',\n  'celebrities',\n  'mandatory',\n  'boundaries',\n  'syndication',\n  'celebration',\n  'filtering',\n  'luxembourg',\n  'offensive',\n  'deployment',\n  'colleagues',\n  'separated',\n  'directive',\n  'governing',\n  'retailers',\n  'occasionally',\n  'attending',\n  'recruiting',\n  'instructional',\n  'traveling',\n  'permissions',\n  'biotechnology',\n  'prescribed',\n  'catherine',\n  'reproduced',\n  'calculation',\n  'consolidated',\n  'occasions',\n  'equations',\n  'exceptional',\n  'respondents',\n  'considerations',\n  'queensland',\n  'musicians',\n  'composite',\n  'unavailable',\n  'essentially',\n  'designing',\n  'assessments',\n  'brunswick',\n  'sensitivity',\n  'preservation',\n  'streaming',\n  'intensity',\n  'technological',\n  'syndicate',\n  'antivirus',\n  'addressing',\n  'discounted',\n  'bangladesh',\n  'constitute',\n  'concluded',\n  'desperate',\n  'demonstration',\n  'governmental',\n  'manufactured',\n  'graduation',\n  'variations',\n  'addiction',\n  'springfield',\n  'synthesis',\n  'undefined',\n  'unemployment',\n  'enhancement',\n  'newcastle',\n  'performances',\n  'societies',\n  'brazilian',\n  'identical',\n  'petroleum',\n  'norwegian',\n  'retention',\n  'exchanges',\n  'soundtrack',\n  'wondering',\n  'profession',\n  'separately',\n  'physiology',\n  'collecting',\n  'participant',\n  'scholarships',\n  'recreational',\n  'dominican',\n  'friendship',\n  'expanding',\n  'provincial',\n  'investigations',\n  'medications',\n  'rochester',\n  'advertiser',\n  'encryption',\n  'downloadable',\n  'sophisticated',\n  'possession',\n  'laboratories',\n  'vegetables',\n  'thumbnails',\n  'stockings',\n  'respondent',\n  'destroyed',\n  'manufacture',\n  'wordpress',\n  'vulnerability',\n  'accountability',\n  'celebrate',\n  'accredited',\n  'appliance',\n  'compressed',\n  'scheduling',\n  'perspectives',\n  'mortality',\n  'christians',\n  'therapeutic',\n  'impressive',\n  'accordingly',\n  'architect',\n  'challenging',\n  'microwave',\n  'accidents',\n  'relocation',\n  'contributors',\n  'violations',\n  'temperatures',\n  'competitions',\n  'discretion',\n  'cosmetics',\n  'repository',\n  'concentrations',\n  'christianity',\n  'negotiations',\n  'realistic',\n  'generating',\n  'christina',\n  'congressional',\n  'photographic',\n  'modifications',\n  'millennium',\n  'achieving',\n  'fisheries',\n  'exceptions',\n  'reactions',\n  'macromedia',\n  'companion',\n  'divisions',\n  'additionally',\n  'fellowship',\n  'victorian',\n  'copyrights',\n  'lithuania',\n  'mastercard',\n  'chronicles',\n  'obtaining',\n  'distribute',\n  'decorative',\n  'enlargement',\n  'campaigns',\n  'conjunction',\n  'instances',\n  'indigenous',\n  'validation',\n  'corruption',\n  'incentives',\n  'cholesterol',\n  'differential',\n  'scientist',\n  'starsmerchant',\n  'arthritis',\n  'nevertheless',\n  'practitioners',\n  'transcript',\n  'inflation',\n  'compounds',\n  'contracting',\n  'structured',\n  'reasonably',\n  'graduates',\n  'recommends',\n  'controlling',\n  'distributors',\n  'arlington',\n  'particles',\n  'extraordinary',\n  'indicating',\n  'coordinate',\n  'exclusively',\n  'limitation',\n  'widescreen',\n  'illustration',\n  'construct',\n  'inquiries',\n  'inspiration',\n  'affecting',\n  'downloading',\n  'aggregate',\n  'forecasts',\n  'complicated',\n  'shopzilla',\n  'decorating',\n  'expressions',\n  'shakespeare',\n  'connectors',\n  'conflicts',\n  'travelers',\n  'offerings',\n  'incorrect',\n  'furnishings',\n  'guatemala',\n  'perception',\n  'renaissance',\n  'pathology',\n  'ordinance',\n  'photographers',\n  'infections',\n  'configured',\n  'festivals',\n  'possibilities',\n  'contributing',\n  'analytical',\n  'circulation',\n  'assumption',\n  'jerusalem',\n  'transexuales',\n  'invention',\n  'technician',\n  'executives',\n  'enquiries',\n  'cognitive',\n  'exploring',\n  'registrar',\n  'supporters',\n  'withdrawal',\n  'predicted',\n  'saskatchewan',\n  'cancellation',\n  'ministers',\n  'veterinary',\n  'prostores',\n  'relevance',\n  'incentive',\n  'butterfly',\n  'mechanics',\n  'numerical',\n  'reflection',\n  'accompanied',\n  'invitation',\n  'princeton',\n  'spirituality',\n  'meanwhile',\n  'proprietary',\n  'childrens',\n  'thumbzilla',\n  'porcelain',\n  'pichunter',\n  'translated',\n  'columnists',\n  'consensus',\n  'delivering',\n  'journalism',\n  'intention',\n  'undertaken',\n  'statewide',\n  'semiconductor',\n  'illustrations',\n  'happiness',\n  'substantially',\n  'identifier',\n  'calculations',\n  'conducting',\n  'accomplished',\n  'calculators',\n  'impression',\n  'correlation',\n  'fragrance',\n  'neighbors',\n  'transparent',\n  'charleston',\n  'champions',\n  'selections',\n  'projectors',\n  'inappropriate',\n  'comparing',\n  'vocational',\n  'pharmacies',\n  'introducing',\n  'appreciated',\n  'albuquerque',\n  'distinguished',\n  'projected',\n  'assumptions',\n  'shareholders',\n  'developmental',\n  'regulated',\n  'anticipated',\n  'completing',\n  'comparable',\n  'confusion',\n  'copyrighted',\n  'warranties',\n  'documented',\n  'paperbacks',\n  'keyboards',\n  'vulnerable',\n  'reflected',\n  'respiratory',\n  'notifications',\n  'transexual',\n  'mainstream',\n  'evaluating',\n  'subcommittee',\n  'maternity',\n  'journalists',\n  'foundations',\n  'volleyball',\n  'liabilities',\n  'decreased',\n  'tolerance',\n  'creativity',\n  'describing',\n  'lightning',\n  'quotations',\n  'inspector',\n  'bookmarks',\n  'behavioral',\n  'riverside',\n  'bathrooms',\n  'abilities',\n  'initiated',\n  'nonprofit',\n  'lancaster',\n  'suspended',\n  'containers',\n  'attitudes',\n  'simultaneously',\n  'integrate',\n  'sociology',\n  'screenshot',\n  'exhibitions',\n  'confident',\n  'retrieved',\n  'officially',\n  'consortium',\n  'recipients',\n  'delicious',\n  'traditions',\n  'periodically',\n  'hungarian',\n  'referring',\n  'transform',\n  'educators',\n  'vegetable',\n  'humanities',\n  'independently',\n  'alignment',\n  'henderson',\n  'britannica',\n  'competitors',\n  'visibility',\n  'consciousness',\n  'encounter',\n  'resolutions',\n  'accessing',\n  'attempted',\n  'witnesses',\n  'administered',\n  'strengthen',\n  'frederick',\n  'aggressive',\n  'advertisements',\n  'sublimedirectory',\n  'disturbed',\n  'determines',\n  'sculpture',\n  'motivation',\n  'pharmacology',\n  'passengers',\n  'quantities',\n  'petersburg',\n  'consistently',\n  'powerpoint',\n  'obituaries',\n  'punishment',\n  'appreciation',\n  'subsequently',\n  'providence',\n  'restriction',\n  'incorporate',\n  'backgrounds',\n  'treasurer',\n  'lightweight',\n  'transcription',\n  'complications',\n  'scripting',\n  'remembered',\n  'synthetic',\n  'testament',\n  'specifics',\n  'partially',\n  'wilderness',\n  'generations',\n  'tournaments',\n  'sponsorship',\n  'headphones',\n  'proceeding',\n  'volkswagen',\n  'uncertainty',\n  'breakdown',\n  'reconstruction',\n  'subsidiary',\n  'strengths',\n  'encouraging',\n  'furnished',\n  'terrorists',\n  'comparisons',\n  'beneficial',\n  'distributions',\n  'viewpicture',\n  'threatened',\n  'republicans',\n  'discusses',\n  'responded',\n  'abstracts',\n  'prediction',\n  'pharmaceuticals',\n  'thesaurus',\n  'individually',\n  'battlefield',\n  'literally',\n  'ecological',\n  'appraisal',\n  'consisting',\n  'submitting',\n  'citations',\n  'geographical',\n  'mozambique',\n  'disclaimers',\n  'championships',\n  'sheffield',\n  'finishing',\n  'wellington',\n  'prospects',\n  'bulgarian',\n  'aboriginal',\n  'remarkable',\n  'preventing',\n  'productive',\n  'boulevard',\n  'compliant',\n  'penalties',\n  'imagination',\n  'refurbished',\n  'activated',\n  'conferencing',\n  'armstrong',\n  'politicians',\n  'trackbacks',\n  'accommodate',\n  'christine',\n  'accepting',\n  'precipitation',\n  'isolation',\n  'sustained',\n  'approximate',\n  'programmer',\n  'greetings',\n  'inherited',\n  'incomplete',\n  'chronicle',\n  'legitimate',\n  'biographies',\n  'investigator',\n  'plaintiff',\n  'prisoners',\n  'mediterranean',\n  'nightlife',\n  'architects',\n  'entrepreneur',\n  'freelance',\n  'excessive',\n  'screensaver',\n  'valuation',\n  'unexpected',\n  'cigarette',\n  'characteristic',\n  'metallica',\n  'consequently',\n  'appointments',\n  'narrative',\n  'academics',\n  'quantitative',\n  'screensavers',\n  'subdivision',\n  'distinction',\n  'livestock',\n  'exemption',\n  'sustainability',\n  'formatting',\n  'nutritional',\n  'nicaragua',\n  'affiliation',\n  'relatives',\n  'satisfactory',\n  'revolutionary',\n  'bracelets',\n  'telephony',\n  'breathing',\n  'thickness',\n  'adjustments',\n  'graphical',\n  'discussing',\n  'aerospace',\n  'meaningful',\n  'maintains',\n  'shortcuts',\n  'voyeurweb',\n  'extending',\n  'specifies',\n  'accreditation',\n  'blackberry',\n  'meditation',\n  'microphone',\n  'macedonia',\n  'combining',\n  'instrumental',\n  'organizing',\n  'moderators',\n  'kazakhstan',\n  'standings',\n  'partition',\n  'invisible',\n  'translations',\n  'commodity',\n  'kilometers',\n  'thanksgiving',\n  'guarantees',\n  'indication',\n  'congratulations',\n  'cigarettes',\n  'controllers',\n  'consultancy',\n  'conventions',\n  'coordinates',\n  'responding',\n  'physically',\n  'stakeholders',\n  'hydrocodone',\n  'consecutive',\n  'attempting',\n  'representations',\n  'competing',\n  'peninsula',\n  'accurately',\n  'considers',\n  'ministries',\n  'vacancies',\n  'parliamentary',\n  'acknowledge',\n  'thoroughly',\n  'nottingham',\n  'identifies',\n  'questionnaire',\n  'qualification',\n  'modelling',\n  'miniature',\n  'interstate',\n  'consequence',\n  'systematic',\n  'perceived',\n  'madagascar',\n  'presenting',\n  'troubleshooting',\n  'uzbekistan',\n  'centuries',\n  'magnitude',\n  'richardson',\n  'fragrances',\n  'vocabulary',\n  'earthquake',\n  'fundraising',\n  'geological',\n  'assessing',\n  'introduces',\n  'webmasters',\n  'computational',\n  'acdbentity',\n  'participated',\n  'handhelds',\n  'answering',\n  'impressed',\n  'conspiracy',\n  'organizer',\n  'combinations',\n  'preceding',\n  'cumulative',\n  'amplifier',\n  'arbitrary',\n  'prominent',\n  'lexington',\n  'contacted',\n  'recorders',\n  'occasional',\n  'innovations',\n  'postcards',\n  'reviewing',\n  'explicitly',\n  'transsexual',\n  'citizenship',\n  'informative',\n  'girlfriend',\n  'bloomberg',\n  'hierarchy',\n  'influenced',\n  'abandoned',\n  'complement',\n  'mauritius',\n  'checklist',\n  'requesting',\n  'lauderdale',\n  'scenarios',\n  'extraction',\n  'elevation',\n  'utilization',\n  'beverages',\n  'calibration',\n  'efficiently',\n  'entertaining',\n  'prerequisite',\n  'hypothesis',\n  'medicines',\n  'regression',\n  'enhancements',\n  'renewable',\n  'intersection',\n  'passwords',\n  'consistency',\n  'collectors',\n  'azerbaijan',\n  'astrology',\n  'occurring',\n  'supplemental',\n  'travelling',\n  'induction',\n  'precisely',\n  'spreading',\n  'provinces',\n  'widespread',\n  'incidence',\n  'incidents',\n  'enhancing',\n  'interference',\n  'palestine',\n  'listprice',\n  'atmospheric',\n  'knowledgestorm',\n  'referenced',\n  'publicity',\n  'proposition',\n  'allowance',\n  'designation',\n  'duplicate',\n  'criterion',\n  'civilization',\n  'vietnamese',\n  'tremendous',\n  'corrected',\n  'encountered',\n  'internationally',\n  'surrounded',\n  'creatures',\n  'commented',\n  'accomplish',\n  'vegetarian',\n  'newfoundland',\n  'investigated',\n  'ambassador',\n  'stephanie',\n  'contacting',\n  'vegetation',\n  'findarticles',\n  'specially',\n  'infectious',\n  'continuity',\n  'phenomenon',\n  'conscious',\n  'referrals',\n  'differently',\n  'integrating',\n  'revisions',\n  'reasoning',\n  'charitable',\n  'annotated',\n  'convinced',\n  'burlington',\n  'replacing',\n  'researcher',\n  'watershed',\n  'occupations',\n  'acknowledged',\n  'equilibrium',\n  'characterized',\n  'privilege',\n  'qualifying',\n  'estimation',\n  'pediatric',\n  'techrepublic',\n  'institutes',\n  'brochures',\n  'traveller',\n  'appropriations',\n  'suspected',\n  'benchmark',\n  'beginners',\n  'instructors',\n  'highlighted',\n  'stationery',\n  'unauthorized',\n  'competent',\n  'contributor',\n  'demonstrates',\n  'gradually',\n  'desirable',\n  'journalist',\n  'afterwards',\n  'religions',\n  'explosion',\n  'signatures',\n  'disciplines',\n  'daughters',\n  'conversations',\n  'simplified',\n  'motherboard',\n  'bibliographic',\n  'champagne',\n  'deviation',\n  'superintendent',\n  'housewives',\n  'influences',\n  'inspections',\n  'irrigation',\n  'hydraulic',\n  'robertson',\n  'penetration',\n  'conviction',\n  'omissions',\n  'retrieval',\n  'qualities',\n  'prototype',\n  'importantly',\n  'apparatus',\n  'explaining',\n  'nomination',\n  'empirical',\n  'dependence',\n  'sexuality',\n  'polyester',\n  'commitments',\n  'suggesting',\n  'remainder',\n  'privileges',\n  'televisions',\n  'specializing',\n  'commodities',\n  'motorcycles',\n  'concentrate',\n  'reproductive',\n  'molecules',\n  'refrigerator',\n  'intervals',\n  'sentences',\n  'exclusion',\n  'workstation',\n  'holocaust',\n  'receivers',\n  'disposition',\n  'navigator',\n  'investigators',\n  'marijuana',\n  'cathedral',\n  'fairfield',\n  'fascinating',\n  'landscapes',\n  'lafayette',\n  'computation',\n  'cardiovascular',\n  'salvation',\n  'predictions',\n  'accompanying',\n  'selective',\n  'arbitration',\n  'configuring',\n  'editorials',\n  'sacrifice',\n  'removable',\n  'convergence',\n  'gibraltar',\n  'anthropology',\n  'malpractice',\n  'reporters',\n  'necessity',\n  'rendering',\n  'hepatitis',\n  'nationally',\n  'waterproof',\n  'specialties',\n  'humanitarian',\n  'invitations',\n  'functioning',\n  'economies',\n  'alexandria',\n  'bacterial',\n  'undertake',\n  'continuously',\n  'achievements',\n  'convertible',\n  'secretariat',\n  'paragraphs',\n  'adolescent',\n  'nominations',\n  'cancelled',\n  'introductory',\n  'reservoir',\n  'occurrence',\n  'worcester',\n  'demographic',\n  'disciplinary',\n  'respected',\n  'portraits',\n  'interpreted',\n  'evaluations',\n  'elimination',\n  'hypothetical',\n  'immigrants',\n  'complimentary',\n  'helicopter',\n  'performer',\n  'commissions',\n  'powerseller',\n  'graduated',\n  'surprising',\n  'unnecessary',\n  'dramatically',\n  'yugoslavia',\n  'characterization',\n  'likelihood',\n  'fundamentals',\n  'contamination',\n  'endangered',\n  'compromise',\n  'expiration',\n  'namespace',\n  'peripheral',\n  'negotiation',\n  'opponents',\n  'nominated',\n  'confidentiality',\n  'electoral',\n  'changelog',\n  'alternatively',\n  'greensboro',\n  'controversial',\n  'recovered',\n  'upgrading',\n  'frontpage',\n  'demanding',\n  'defensive',\n  'forbidden',\n  'programmers',\n  'monitored',\n  'installations',\n  'deutschland',\n  'practitioner',\n  'motivated',\n  'smithsonian',\n  'examining',\n  'revelation',\n  'delegation',\n  'dictionaries',\n  'greenhouse',\n  'transparency',\n  'currencies',\n  'survivors',\n  'positioning',\n  'descending',\n  'temporarily',\n  'frequencies',\n  'reflections',\n  'municipality',\n  'detective',\n  'experiencing',\n  'fireplace',\n  'endorsement',\n  'psychiatry',\n  'persistent',\n  'summaries',\n  'looksmart',\n  'magnificent',\n  'colleague',\n  'adaptation',\n  'paintball',\n  'enclosure',\n  'supervisors',\n  'westminster',\n  'distances',\n  'absorption',\n  'treasures',\n  'transcripts',\n  'disappointed',\n  'continually',\n  'communist',\n  'collectible',\n  'entrepreneurs',\n  'creations',\n  'acquisitions',\n  'biodiversity',\n  'excitement',\n  'presently',\n  'mysterious',\n  'librarian',\n  'subsidiaries',\n  'stockholm',\n  'indonesian',\n  'therapist',\n  'promising',\n  'relaxation',\n  'thereafter',\n  'commissioners',\n  'forwarding',\n  'nightmare',\n  'reductions',\n  'southampton',\n  'organisms',\n  'telescope',\n  'portsmouth',\n  'advancement',\n  'harassment',\n  'generators',\n  'generates',\n  'replication',\n  'inexpensive',\n  'receptors',\n  'interventions',\n  'huntington',\n  'internship',\n  'aluminium',\n  'snowboard',\n  'beastality',\n  'evanescence',\n  'coordinated',\n  'shipments',\n  'antarctica',\n  'chancellor',\n  'controversy',\n  'legendary',\n  'beautifully',\n  'antibodies',\n  'examinations',\n  'immunology',\n  'departmental',\n  'terminology',\n  'gentleman',\n  'reproduce',\n  'convicted',\n  'roommates',\n  'threatening',\n  'spokesman',\n  'activists',\n  'frankfurt',\n  'encourages',\n  'assembled',\n  'restructuring',\n  'terminals',\n  'simulations',\n  'sufficiently',\n  'conditional',\n  'crossword',\n  'conceptual',\n  'liechtenstein',\n  'translator',\n  'automobiles',\n  'continent',\n  'longitude',\n  'challenged',\n  'telecharger',\n  'insertion',\n  'instrumentation',\n  'constraint',\n  'groundwater',\n  'strengthening',\n  'insulation',\n  'infringement',\n  'subjective',\n  'swaziland',\n  'varieties',\n  'mediawiki',\n  'configurations',\n];\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {AutoLinkPlugin} from '@lexical/react/LexicalAutoLinkPlugin';\nimport * as React from 'react';\n\nconst URL_MATCHER =\n  /((https?:\\/\\/(www\\.)?)|(www\\.))[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/;\n\nconst EMAIL_MATCHER =\n  /(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))/;\n\nconst MATCHERS = [\n  (text: string) => {\n    const match = URL_MATCHER.exec(text);\n    return (\n      match && {\n        index: match.index,\n        length: match[0].length,\n        text: match[0],\n        url: match[0],\n      }\n    );\n  },\n  (text: string) => {\n    const match = EMAIL_MATCHER.exec(text);\n    return (\n      match && {\n        index: match.index,\n        length: match[0].length,\n        text: match[0],\n        url: `mailto:${match[0]}`,\n      }\n    );\n  },\n];\n\nexport default function LexicalAutoLinkPlugin(): JSX.Element {\n  return <AutoLinkPlugin matchers={MATCHERS} />;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {LinkNode} from '@lexical/link';\nimport type {LexicalEditor} from 'lexical';\n\nimport {$isLinkNode} from '@lexical/link';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $getNearestNodeFromDOMNode,\n  $getSelection,\n  $isRangeSelection,\n} from 'lexical';\nimport {useEffect} from 'react';\n\ntype LinkFilter = (event: MouseEvent, linkNode: LinkNode) => boolean;\n\nexport default function ClickableLinkPlugin({\n  filter,\n  newTab = true,\n}: {\n  filter?: LinkFilter;\n  newTab?: boolean;\n}): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n  useEffect(() => {\n    function onClick(e: Event) {\n      const event = e as MouseEvent;\n      const linkDomNode = getLinkDomNode(event, editor);\n\n      if (linkDomNode === null) {\n        return;\n      }\n\n      const href = linkDomNode.getAttribute('href');\n\n      if (\n        linkDomNode.getAttribute('contenteditable') === 'false' ||\n        href === undefined\n      ) {\n        return;\n      }\n\n      // Allow user to select link text without follwing url\n      const selection = editor.getEditorState().read($getSelection);\n      if ($isRangeSelection(selection) && !selection.isCollapsed()) {\n        return;\n      }\n\n      let linkNode = null;\n      editor.update(() => {\n        const maybeLinkNode = $getNearestNodeFromDOMNode(linkDomNode);\n\n        if ($isLinkNode(maybeLinkNode)) {\n          linkNode = maybeLinkNode;\n        }\n      });\n\n      if (\n        linkNode === null ||\n        (filter !== undefined && !filter(event, linkNode))\n      ) {\n        return;\n      }\n\n      try {\n        if (href !== null) {\n          window.open(\n            href,\n            newTab || event.metaKey || event.ctrlKey ? '_blank' : '_self',\n          );\n        }\n      } catch {\n        // It didn't work, which is better than throwing an exception!\n      }\n    }\n\n    return editor.registerRootListener(\n      (\n        rootElement: null | HTMLElement,\n        prevRootElement: null | HTMLElement,\n      ) => {\n        if (prevRootElement !== null) {\n          prevRootElement.removeEventListener('click', onClick);\n        }\n\n        if (rootElement !== null) {\n          rootElement.addEventListener('click', onClick);\n        }\n      },\n    );\n  }, [editor, filter, newTab]);\n  return null;\n}\n\nfunction isLinkDomNode(domNode: Node): boolean {\n  return domNode.nodeName.toLowerCase() === 'a';\n}\n\nfunction getLinkDomNode(\n  event: MouseEvent,\n  editor: LexicalEditor,\n): HTMLAnchorElement | null {\n  return editor.getEditorState().read(() => {\n    const domNode = event.target as Node;\n\n    if (isLinkDomNode(domNode)) {\n      return domNode as HTMLAnchorElement;\n    }\n\n    if (domNode.parentNode && isLinkDomNode(domNode.parentNode)) {\n      return domNode.parentNode as HTMLAnchorElement;\n    }\n\n    return null;\n  });\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {registerCodeHighlighting} from '@lexical/code';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {useEffect} from 'react';\n\nexport default function CodeHighlightPlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    return registerCodeHighlighting(editor);\n  }, [editor]);\n\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  EditorConfig,\n  LexicalNode,\n  NodeKey,\n  SerializedTextNode,\n  Spread,\n} from 'lexical';\n\nimport {TextNode} from 'lexical';\n\nexport type SerializedEmojiNode = Spread<\n  {\n    className: string;\n    type: 'emoji';\n  },\n  SerializedTextNode\n>;\n\nexport class EmojiNode extends TextNode {\n  __className: string;\n\n  static getType(): string {\n    return 'emoji';\n  }\n\n  static clone(node: EmojiNode): EmojiNode {\n    return new EmojiNode(node.__className, node.__text, node.__key);\n  }\n\n  constructor(className: string, text: string, key?: NodeKey) {\n    super(text, key);\n    this.__className = className;\n  }\n\n  createDOM(config: EditorConfig): HTMLElement {\n    const dom = document.createElement('span');\n    const inner = super.createDOM(config);\n    dom.className = this.__className;\n    inner.className = 'emoji-inner';\n    dom.appendChild(inner);\n    return dom;\n  }\n\n  updateDOM(\n    prevNode: TextNode,\n    dom: HTMLElement,\n    config: EditorConfig,\n  ): boolean {\n    const inner = dom.firstChild;\n    if (inner === null) {\n      return true;\n    }\n    super.updateDOM(prevNode, inner as HTMLElement, config);\n    return false;\n  }\n\n  static importJSON(serializedNode: SerializedEmojiNode): EmojiNode {\n    const node = $createEmojiNode(\n      serializedNode.className,\n      serializedNode.text,\n    );\n    node.setFormat(serializedNode.format);\n    node.setDetail(serializedNode.detail);\n    node.setMode(serializedNode.mode);\n    node.setStyle(serializedNode.style);\n    return node;\n  }\n\n  exportJSON(): SerializedEmojiNode {\n    return {\n      ...super.exportJSON(),\n      className: this.getClassName(),\n      type: 'emoji',\n    };\n  }\n\n  getClassName(): string {\n    const self = this.getLatest();\n    return self.__className;\n  }\n}\n\nexport function $isEmojiNode(\n  node: LexicalNode | null | undefined,\n): node is EmojiNode {\n  return node instanceof EmojiNode;\n}\n\nexport function $createEmojiNode(\n  className: string,\n  emojiText: string,\n): EmojiNode {\n  return new EmojiNode(className, emojiText).setMode('token');\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {LexicalEditor} from 'lexical';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {TextNode} from 'lexical';\nimport {useEffect} from 'react';\n\nimport {$createEmojiNode, EmojiNode} from '../nodes/EmojiNode';\n\nconst emojis: Map<string, [string, string]> = new Map([\n  [':)', ['emoji happysmile', '🙂']],\n  [':D', ['emoji veryhappysmile', '😀']],\n  [':(', ['emoji unhappysmile', '🙁']],\n  ['<3', ['emoji heart', '❤']],\n  ['🙂', ['emoji happysmile', '🙂']],\n  ['😀', ['emoji veryhappysmile', '😀']],\n  ['🙁', ['emoji unhappysmile', '🙁']],\n  ['❤', ['emoji heart', '❤']],\n]);\n\nfunction findAndTransformEmoji(node: TextNode): null | TextNode {\n  const text = node.getTextContent();\n\n  for (let i = 0; i < text.length; i++) {\n    const emojiData = emojis.get(text[i]) || emojis.get(text.slice(i, i + 2));\n\n    if (emojiData !== undefined) {\n      const [emojiStyle, emojiText] = emojiData;\n      let targetNode;\n\n      if (i === 0) {\n        [targetNode] = node.splitText(i + 2);\n      } else {\n        [, targetNode] = node.splitText(i, i + 2);\n      }\n\n      const emojiNode = $createEmojiNode(emojiStyle, emojiText);\n      targetNode.replace(emojiNode);\n      return emojiNode;\n    }\n  }\n\n  return null;\n}\n\nfunction textNodeTransform(node: TextNode): void {\n  let targetNode: TextNode | null = node;\n\n  while (targetNode !== null) {\n    if (!targetNode.isSimpleText()) {\n      return;\n    }\n\n    targetNode = findAndTransformEmoji(targetNode);\n  }\n}\n\nfunction useEmojis(editor: LexicalEditor): void {\n  useEffect(() => {\n    if (!editor.hasNodes([EmojiNode])) {\n      throw new Error('EmojisPlugin: EmojiNode not registered on editor');\n    }\n\n    return editor.registerNodeTransform(TextNode, textNodeTransform);\n  }, [editor]);\n}\n\nexport default function EmojisPlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n  useEmojis(editor);\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\n// import './EquationEditor.css';\n\nimport * as React from 'react';\nimport {ChangeEvent, RefObject} from 'react';\n\ntype BaseEquationEditorProps = {\n  equation: string;\n  inline: boolean;\n  inputRef: {current: null | HTMLInputElement | HTMLTextAreaElement};\n  setEquation: (equation: string) => void;\n};\n\nexport default function EquationEditor({\n  equation,\n  setEquation,\n  inline,\n  inputRef,\n}: BaseEquationEditorProps): JSX.Element {\n  const onChange = (event: ChangeEvent) => {\n    setEquation((event.target as HTMLInputElement).value);\n  };\n\n  const props = {\n    equation,\n    inputRef,\n    onChange,\n  };\n\n  return inline ? (\n    <InlineEquationEditor\n      {...props}\n      inputRef={inputRef as RefObject<HTMLInputElement>}\n    />\n  ) : (\n    <BlockEquationEditor\n      {...props}\n      inputRef={inputRef as RefObject<HTMLTextAreaElement>}\n    />\n  );\n}\n\ntype EquationEditorImplProps = {\n  equation: string;\n  inputRef: {current: null | HTMLInputElement};\n  onChange: (event: ChangeEvent<HTMLInputElement>) => void;\n};\n\nfunction InlineEquationEditor({\n  equation,\n  onChange,\n  inputRef,\n}: EquationEditorImplProps): JSX.Element {\n  return (\n    <span className=\"EquationEditor_inputBackground\">\n      <span className=\"EquationEditor_dollarSign\">$</span>\n      <input\n        className=\"EquationEditor_inlineEditor\"\n        value={equation}\n        onChange={onChange}\n        autoFocus={true}\n        ref={inputRef}\n      />\n      <span className=\"EquationEditor_dollarSign\">$</span>\n    </span>\n  );\n}\n\ntype BlockEquationEditorImplProps = {\n  equation: string;\n  inputRef: {current: null | HTMLTextAreaElement};\n  onChange: (event: ChangeEvent<HTMLTextAreaElement>) => void;\n};\n\nfunction BlockEquationEditor({\n  equation,\n  onChange,\n  inputRef,\n}: BlockEquationEditorImplProps): JSX.Element {\n  return (\n    <div className=\"EquationEditor_inputBackground\">\n      <span className=\"EquationEditor_dollarSign\">{'$$\\n'}</span>\n      <textarea\n        className=\"EquationEditor_blockEditor\"\n        value={equation}\n        onChange={onChange}\n        ref={inputRef}\n      />\n      <span className=\"EquationEditor_dollarSign\">{'\\n$$'}</span>\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport katex from 'katex';\nimport * as React from 'react';\nimport {useEffect, useRef} from 'react';\n\nexport default function KatexRenderer({\n  equation,\n  inline,\n  onClick,\n}: Readonly<{\n  equation: string;\n  inline: boolean;\n  onClick: () => void;\n}>): JSX.Element {\n  const katexElementRef = useRef(null);\n\n  useEffect(() => {\n    const katexElement = katexElementRef.current;\n\n    if (katexElement !== null) {\n      katex.render(equation, katexElement, {\n        displayMode: !inline, // true === block display //\n        errorColor: '#cc0000',\n        output: 'html',\n        strict: 'warn',\n        throwOnError: false,\n        trust: false,\n      });\n    }\n  }, [equation, inline]);\n\n  return (\n    // We use spacers either side to ensure Android doesn't try and compose from the\n    // inner text from Katex. There didn't seem to be any other way of making this work,\n    // without having a physical space.\n    <>\n      <span className=\"spacer\"> </span>\n      <span\n        role=\"button\"\n        tabIndex={-1}\n        onClick={onClick}\n        ref={katexElementRef}\n      />\n      <span className=\"spacer\"> </span>\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  EditorConfig,\n  LexicalNode,\n  NodeKey,\n  SerializedLexicalNode,\n  Spread,\n} from 'lexical';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {mergeRegister} from '@lexical/utils';\nimport {\n  $getNodeByKey,\n  COMMAND_PRIORITY_HIGH,\n  DecoratorNode,\n  KEY_ESCAPE_COMMAND,\n  SELECTION_CHANGE_COMMAND,\n} from 'lexical';\nimport * as React from 'react';\nimport {useCallback, useEffect, useRef, useState} from 'react';\n\nimport EquationEditor from '../ui/EquationEditor';\nimport KatexRenderer from '../ui/KatexRenderer';\n\ntype EquationComponentProps = {\n  equation: string;\n  inline: boolean;\n  nodeKey: NodeKey;\n};\n\nfunction EquationComponent({\n  equation,\n  inline,\n  nodeKey,\n}: EquationComponentProps): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n  const [equationValue, setEquationValue] = useState(equation);\n  const [showEquationEditor, setShowEquationEditor] = useState<boolean>(false);\n  const inputRef = useRef(null);\n\n  const onHide = useCallback(\n    (restoreSelection?: boolean) => {\n      setShowEquationEditor(false);\n      editor.update(() => {\n        const node = $getNodeByKey(nodeKey);\n        if ($isEquationNode(node)) {\n          node.setEquation(equationValue);\n          if (restoreSelection) {\n            node.selectNext(0, 0);\n          }\n        }\n      });\n    },\n    [editor, equationValue, nodeKey],\n  );\n\n  useEffect(() => {\n    if (showEquationEditor) {\n      return mergeRegister(\n        editor.registerCommand(\n          SELECTION_CHANGE_COMMAND,\n          (payload) => {\n            const activeElement = document.activeElement;\n            const inputElem = inputRef.current;\n            if (inputElem !== activeElement) {\n              onHide();\n            }\n            return false;\n          },\n          COMMAND_PRIORITY_HIGH,\n        ),\n        editor.registerCommand(\n          KEY_ESCAPE_COMMAND,\n          (payload) => {\n            const activeElement = document.activeElement;\n            const inputElem = inputRef.current;\n            if (inputElem === activeElement) {\n              onHide(true);\n              return true;\n            }\n            return false;\n          },\n          COMMAND_PRIORITY_HIGH,\n        ),\n      );\n    }\n  }, [editor, onHide, showEquationEditor]);\n\n  return (\n    <>\n      {showEquationEditor ? (\n        <EquationEditor\n          equation={equationValue}\n          setEquation={setEquationValue}\n          inline={inline}\n          inputRef={inputRef}\n        />\n      ) : (\n        <KatexRenderer\n          equation={equationValue}\n          inline={inline}\n          onClick={() => {\n            setShowEquationEditor(true);\n          }}\n        />\n      )}\n    </>\n  );\n}\n\nexport type SerializedEquationNode = Spread<\n  {\n    type: 'equation';\n    equation: string;\n    inline: boolean;\n  },\n  SerializedLexicalNode\n>;\n\nexport class EquationNode extends DecoratorNode<JSX.Element> {\n  __equation: string;\n  __inline: boolean;\n\n  static getType(): string {\n    return 'equation';\n  }\n\n  static clone(node: EquationNode): EquationNode {\n    return new EquationNode(node.__equation, node.__inline, node.__key);\n  }\n\n  constructor(equation: string, inline?: boolean, key?: NodeKey) {\n    super(key);\n    this.__equation = equation;\n    this.__inline = inline ?? false;\n  }\n\n  static importJSON(serializedNode: SerializedEquationNode): EquationNode {\n    const node = $createEquationNode(\n      serializedNode.equation,\n      serializedNode.inline,\n    );\n    return node;\n  }\n\n  exportJSON(): SerializedEquationNode {\n    return {\n      equation: this.getEquation(),\n      inline: this.__inline,\n      type: 'equation',\n      version: 1,\n    };\n  }\n\n  createDOM(_config: EditorConfig): HTMLElement {\n    return document.createElement(this.__inline ? 'span' : 'div');\n  }\n\n  updateDOM(prevNode: EquationNode): boolean {\n    // If the inline property changes, replace the element\n    return this.__inline !== prevNode.__inline;\n  }\n\n  getEquation(): string {\n    return this.__equation;\n  }\n\n  setEquation(equation: string): void {\n    const writable = this.getWritable();\n    writable.__equation = equation;\n  }\n\n  decorate(): JSX.Element {\n    return (\n      <EquationComponent\n        equation={this.__equation}\n        inline={this.__inline}\n        nodeKey={this.__key}\n      />\n    );\n  }\n}\n\nexport function $createEquationNode(\n  equation = '',\n  inline = false,\n): EquationNode {\n  const equationNode = new EquationNode(equation, inline);\n  return equationNode;\n}\n\nexport function $isEquationNode(\n  node: LexicalNode | null | undefined,\n): node is EquationNode {\n  return node instanceof EquationNode;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {LexicalCommand} from 'lexical';\n\nimport 'katex/dist/katex.css';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $getSelection,\n  $isRangeSelection,\n  COMMAND_PRIORITY_EDITOR,\n  createCommand,\n} from 'lexical';\nimport {useEffect} from 'react';\n\nimport {$createEquationNode, EquationNode} from '../nodes/EquationNode';\n\ntype CommandPayload = {\n  equation: string;\n  inline: boolean;\n};\n\nexport const INSERT_EQUATION_COMMAND: LexicalCommand<CommandPayload> =\n  createCommand();\n\nexport default function EquationsPlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    if (!editor.hasNodes([EquationNode])) {\n      throw new Error(\n        'EquationsPlugins: EquationsNode not registered on editor',\n      );\n    }\n\n    return editor.registerCommand<CommandPayload>(\n      INSERT_EQUATION_COMMAND,\n      (payload) => {\n        const {equation, inline} = payload;\n        const selection = $getSelection();\n\n        if ($isRangeSelection(selection)) {\n          const equationNode = $createEquationNode(equation, inline);\n          selection.insertNodes([equationNode]);\n        }\n\n        return true;\n      },\n      COMMAND_PRIORITY_EDITOR,\n    );\n  }, [editor]);\n\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {LexicalEditor} from 'lexical';\n\nimport * as React from 'react';\nimport {useRef} from 'react';\n\nfunction clamp(value: number, min: number, max: number) {\n  return Math.min(Math.max(value, min), max);\n}\n\nconst Direction = {\n  east: 1 << 0,\n  north: 1 << 3,\n  south: 1 << 1,\n  west: 1 << 2,\n};\n\nexport default function ImageResizer({\n  onResizeStart,\n  onResizeEnd,\n  imageRef,\n  maxWidth,\n  editor,\n  showCaption,\n  setShowCaption,\n}: {\n  editor: LexicalEditor;\n  imageRef: {current: null | HTMLElement};\n  maxWidth?: number;\n  onResizeEnd: (width: 'inherit' | number, height: 'inherit' | number) => void;\n  onResizeStart: () => void;\n  setShowCaption: (show: boolean) => void;\n  showCaption: boolean;\n}): JSX.Element {\n  const buttonRef = useRef(null);\n  const controlWrapperRef = useRef<HTMLDivElement>(null);\n  const userSelect = useRef({\n    priority: '',\n    value: 'default',\n  });\n  const positioningRef = useRef<{\n    currentHeight: 'inherit' | number;\n    currentWidth: 'inherit' | number;\n    direction: number;\n    isResizing: boolean;\n    ratio: number;\n    startHeight: number;\n    startWidth: number;\n    startX: number;\n    startY: number;\n  }>({\n    currentHeight: 0,\n    currentWidth: 0,\n    direction: 0,\n    isResizing: false,\n    ratio: 0,\n    startHeight: 0,\n    startWidth: 0,\n    startX: 0,\n    startY: 0,\n  });\n  const editorRootElement = editor.getRootElement();\n  // Find max width, accounting for editor padding.\n  const maxWidthContainer = maxWidth\n    ? maxWidth\n    : editorRootElement !== null\n    ? editorRootElement.getBoundingClientRect().width - 20\n    : 100;\n  const maxHeightContainer =\n    editorRootElement !== null\n      ? editorRootElement.getBoundingClientRect().height - 20\n      : 100;\n\n  const minWidth = 100;\n  const minHeight = 100;\n\n  const setStartCursor = (direction: number) => {\n    const ew = direction === Direction.east || direction === Direction.west;\n    const ns = direction === Direction.north || direction === Direction.south;\n    const nwse =\n      (direction & Direction.north && direction & Direction.west) ||\n      (direction & Direction.south && direction & Direction.east);\n\n    const cursorDir = ew ? 'ew' : ns ? 'ns' : nwse ? 'nwse' : 'nesw';\n\n    if (editorRootElement !== null) {\n      editorRootElement.style.setProperty(\n        'cursor',\n        `${cursorDir}-resize`,\n        'important',\n      );\n    }\n    if (document.body !== null) {\n      document.body.style.setProperty(\n        'cursor',\n        `${cursorDir}-resize`,\n        'important',\n      );\n      userSelect.current.value = document.body.style.getPropertyValue(\n        '-webkit-user-select',\n      );\n      userSelect.current.priority = document.body.style.getPropertyPriority(\n        '-webkit-user-select',\n      );\n      document.body.style.setProperty(\n        '-webkit-user-select',\n        `none`,\n        'important',\n      );\n    }\n  };\n\n  const setEndCursor = () => {\n    if (editorRootElement !== null) {\n      editorRootElement.style.setProperty('cursor', 'default');\n    }\n    if (document.body !== null) {\n      document.body.style.setProperty('cursor', 'default');\n      document.body.style.setProperty(\n        '-webkit-user-select',\n        userSelect.current.value,\n        userSelect.current.priority,\n      );\n    }\n  };\n\n  const handlePointerDown = (\n    event: React.PointerEvent<HTMLDivElement>,\n    direction: number,\n  ) => {\n    const image = imageRef.current;\n    const controlWrapper = controlWrapperRef.current;\n\n    if (image !== null && controlWrapper !== null) {\n      const {width, height} = image.getBoundingClientRect();\n      const positioning = positioningRef.current;\n      positioning.startWidth = width;\n      positioning.startHeight = height;\n      positioning.ratio = width / height;\n      positioning.currentWidth = width;\n      positioning.currentHeight = height;\n      positioning.startX = event.clientX;\n      positioning.startY = event.clientY;\n      positioning.isResizing = true;\n      positioning.direction = direction;\n\n      setStartCursor(direction);\n      onResizeStart();\n\n      controlWrapper.classList.add('image-control-wrapper--resizing');\n      image.style.height = `${height}px`;\n      image.style.width = `${width}px`;\n\n      document.addEventListener('pointermove', handlePointerMove);\n      document.addEventListener('pointerup', handlePointerUp);\n    }\n  };\n  const handlePointerMove = (event: PointerEvent) => {\n    const image = imageRef.current;\n    const positioning = positioningRef.current;\n\n    const isHorizontal =\n      positioning.direction & (Direction.east | Direction.west);\n    const isVertical =\n      positioning.direction & (Direction.south | Direction.north);\n\n    if (image !== null && positioning.isResizing) {\n      // Corner cursor\n      if (isHorizontal && isVertical) {\n        let diff = Math.floor(positioning.startX - event.clientX);\n        diff = positioning.direction & Direction.east ? -diff : diff;\n\n        const width = clamp(\n          positioning.startWidth + diff,\n          minWidth,\n          maxWidthContainer,\n        );\n\n        const height = width / positioning.ratio;\n        image.style.width = `${width}px`;\n        image.style.height = `${height}px`;\n        positioning.currentHeight = height;\n        positioning.currentWidth = width;\n      } else if (isVertical) {\n        let diff = Math.floor(positioning.startY - event.clientY);\n        diff = positioning.direction & Direction.south ? -diff : diff;\n\n        const height = clamp(\n          positioning.startHeight + diff,\n          minHeight,\n          maxHeightContainer,\n        );\n\n        image.style.height = `${height}px`;\n        positioning.currentHeight = height;\n      } else {\n        let diff = Math.floor(positioning.startX - event.clientX);\n        diff = positioning.direction & Direction.east ? -diff : diff;\n\n        const width = clamp(\n          positioning.startWidth + diff,\n          minWidth,\n          maxWidthContainer,\n        );\n\n        image.style.width = `${width}px`;\n        positioning.currentWidth = width;\n      }\n    }\n  };\n  const handlePointerUp = () => {\n    const image = imageRef.current;\n    const positioning = positioningRef.current;\n    const controlWrapper = controlWrapperRef.current;\n    if (image !== null && controlWrapper !== null && positioning.isResizing) {\n      const width = positioning.currentWidth;\n      const height = positioning.currentHeight;\n      positioning.startWidth = 0;\n      positioning.startHeight = 0;\n      positioning.ratio = 0;\n      positioning.startX = 0;\n      positioning.startY = 0;\n      positioning.currentWidth = 0;\n      positioning.currentHeight = 0;\n      positioning.isResizing = false;\n\n      controlWrapper.classList.remove('image-control-wrapper--resizing');\n\n      setEndCursor();\n      onResizeEnd(width, height);\n\n      document.removeEventListener('pointermove', handlePointerMove);\n      document.removeEventListener('pointerup', handlePointerUp);\n    }\n  };\n  return (\n    <div ref={controlWrapperRef}>\n      {!showCaption && (\n        <button\n          className=\"image-caption-button\"\n          ref={buttonRef}\n          onClick={() => {\n            setShowCaption(!showCaption);\n          }}>\n          Add Caption\n        </button>\n      )}\n      <div\n        className=\"image-resizer image-resizer-n\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.north);\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-ne\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.north | Direction.east);\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-e\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.east);\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-se\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.south | Direction.east);\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-s\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.south);\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-sw\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.south | Direction.west);\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-w\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.west);\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-nw\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.north | Direction.west);\n        }}\n      />\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {exportToSvg} from '@excalidraw/excalidraw';\nimport {\n  ExcalidrawElement,\n  NonDeleted,\n} from '@excalidraw/excalidraw/types/element/types';\nimport {AppState} from '@excalidraw/excalidraw/types/types';\nimport * as React from 'react';\nimport {useEffect, useState} from 'react';\n\ntype ImageType = 'svg' | 'canvas';\n\ntype Props = {\n  /**\n   * Configures the export setting for SVG/Canvas\n   */\n  appState?: Partial<Omit<AppState, 'offsetTop' | 'offsetLeft'>> | null;\n  /**\n   * The css class applied to image to be rendered\n   */\n  className?: string;\n  /**\n   * The Excalidraw elements to be rendered as an image\n   */\n  elements: NonDeleted<ExcalidrawElement>[];\n  /**\n   * The height of the image to be rendered\n   */\n  height?: number | null;\n  /**\n   * The ref object to be used to render the image\n   */\n  imageContainerRef: {current: null | HTMLDivElement};\n  /**\n   * The type of image to be rendered\n   */\n  imageType?: ImageType;\n  /**\n   * The css class applied to the root element of this component\n   */\n  rootClassName?: string | null;\n  /**\n   * The width of the image to be rendered\n   */\n  width?: number | null;\n};\n\n// exportToSvg has fonts from excalidraw.com\n// We don't want them to be used in open source\nconst removeStyleFromSvg_HACK = (svg: SVGElement) => {\n  const styleTag = svg?.firstElementChild?.firstElementChild;\n\n  // Generated SVG is getting double-sized by height and width attributes\n  // We want to match the real size of the SVG element\n  const viewBox = svg.getAttribute('viewBox');\n  if (viewBox != null) {\n    const viewBoxDimensions = viewBox.split(' ');\n    svg.setAttribute('width', viewBoxDimensions[2]);\n    svg.setAttribute('height', viewBoxDimensions[3]);\n  }\n\n  if (styleTag && styleTag.tagName === 'style') {\n    styleTag.remove();\n  }\n};\n\n/**\n * @explorer-desc\n * A component for rendering Excalidraw elements as a static image\n */\nexport default function ExcalidrawImage({\n  elements,\n  imageContainerRef,\n  appState = null,\n  rootClassName = null,\n}: Props): JSX.Element {\n  const [Svg, setSvg] = useState<SVGElement | null>(null);\n\n  useEffect(() => {\n    const setContent = async () => {\n      if (appState === null) {\n        return;\n      }\n\n      const svg: SVGElement = await exportToSvg({\n        appState,\n        elements,\n        files: null,\n      });\n      removeStyleFromSvg_HACK(svg);\n\n      svg.setAttribute('width', '100%');\n      svg.setAttribute('height', '100%');\n      svg.setAttribute('display', 'block');\n\n      setSvg(svg);\n    };\n    setContent();\n  }, [elements, appState]);\n\n  return (\n    <div\n      ref={imageContainerRef}\n      className={rootClassName ?? ''}\n      dangerouslySetInnerHTML={{__html: Svg?.outerHTML ?? ''}}\n    />\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {ExcalidrawElementFragment} from './ExcalidrawModal';\nimport type {\n  DOMConversionMap,\n  DOMConversionOutput,\n  DOMExportOutput,\n  EditorConfig,\n  LexicalEditor,\n  LexicalNode,\n  NodeKey,\n  SerializedLexicalNode,\n  Spread,\n} from 'lexical';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {useLexicalNodeSelection} from '@lexical/react/useLexicalNodeSelection';\nimport {mergeRegister} from '@lexical/utils';\nimport {\n  $getNodeByKey,\n  $getSelection,\n  $isNodeSelection,\n  CLICK_COMMAND,\n  COMMAND_PRIORITY_LOW,\n  DecoratorNode,\n  KEY_BACKSPACE_COMMAND,\n  KEY_DELETE_COMMAND,\n} from 'lexical';\nimport * as React from 'react';\nimport {useCallback, useEffect, useMemo, useRef, useState} from 'react';\n\nimport ImageResizer from '../../ui/ImageResizer';\nimport ExcalidrawImage from './ExcalidrawImage';\nimport ExcalidrawModal from './ExcalidrawModal';\n\nfunction ExcalidrawComponent({\n  nodeKey,\n  data,\n}: {\n  data: string;\n  nodeKey: NodeKey;\n}): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n  // const [isModalOpen, setModalOpen] = useState<boolean>(\n  //   data === '[]' && !editor.isReadOnly(),\n  // );\n  const imageContainerRef = useRef<HTMLImageElement | null>(null);\n  const buttonRef = useRef<HTMLButtonElement | null>(null);\n  const [isSelected, setSelected, clearSelection] =\n    useLexicalNodeSelection(nodeKey);\n  const [isResizing, setIsResizing] = useState<boolean>(false);\n\n  const onDelete = useCallback(\n    (event: KeyboardEvent) => {\n      if (isSelected && $isNodeSelection($getSelection())) {\n        event.preventDefault();\n        editor.update(() => {\n          const node = $getNodeByKey(nodeKey);\n          if ($isExcalidrawNode(node)) {\n            node.remove();\n          }\n          setSelected(false);\n        });\n      }\n      return false;\n    },\n    [editor, isSelected, nodeKey, setSelected],\n  );\n\n  // Set editor to readOnly if excalidraw is open to prevent unwanted changes\n  // useEffect(() => {\n  //   if (isModalOpen) {\n  //     editor.setReadOnly(true);\n  //   } else {\n  //     editor.setReadOnly(false);\n  //   }\n  // }, [isModalOpen, editor]);\n\n  useEffect(() => {\n    return mergeRegister(\n      editor.registerCommand(\n        CLICK_COMMAND,\n        (event: MouseEvent) => {\n          const buttonElem = buttonRef.current;\n          const eventTarget = event.target;\n\n          if (isResizing) {\n            return true;\n          }\n\n          if (buttonElem !== null && buttonElem.contains(eventTarget as Node)) {\n            if (!event.shiftKey) {\n              clearSelection();\n            }\n            setSelected(!isSelected);\n            if (event.detail > 1) {\n              // setModalOpen(true);\n            }\n            return true;\n          }\n\n          return false;\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand(\n        KEY_DELETE_COMMAND,\n        onDelete,\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand(\n        KEY_BACKSPACE_COMMAND,\n        onDelete,\n        COMMAND_PRIORITY_LOW,\n      ),\n    );\n  }, [clearSelection, editor, isSelected, isResizing, onDelete, setSelected]);\n\n  const deleteNode = useCallback(() => {\n    // setModalOpen(false);\n    return editor.update(() => {\n      const node = $getNodeByKey(nodeKey);\n      if ($isExcalidrawNode(node)) {\n        node.remove();\n      }\n    });\n  }, [editor, nodeKey]);\n\n  const setData = (newData: ReadonlyArray<ExcalidrawElementFragment>) => {\n    // if (editor.isReadOnly()) {\n    //   return;\n    // }\n    return editor.update(() => {\n      const node = $getNodeByKey(nodeKey);\n      if ($isExcalidrawNode(node)) {\n        if (newData.length > 0) {\n          node.setData(JSON.stringify(newData));\n        } else {\n          node.remove();\n        }\n      }\n    });\n  };\n\n  const onResizeStart = () => {\n    setIsResizing(true);\n  };\n\n  const onResizeEnd = () => {\n    // Delay hiding the resize bars for click case\n    setTimeout(() => {\n      setIsResizing(false);\n    }, 200);\n  };\n\n  const elements = useMemo(() => JSON.parse(data), [data]);\n  return (\n    <>\n      {/* <ExcalidrawModal\n        initialElements={elements}\n        isShown={isModalOpen}\n        onDelete={deleteNode}\n        onHide={() => {\n          editor.setReadOnly(false);\n          setModalOpen(false);\n        }}\n        onSave={(newData) => {\n          editor.setReadOnly(false);\n          setData(newData);\n          setModalOpen(false);\n        }}\n        closeOnClickOutside={true}\n      /> */}\n      {elements.length > 0 && (\n        <button\n          ref={buttonRef}\n          className={`excalidraw-button ${isSelected ? 'selected' : ''}`}>\n          <ExcalidrawImage\n            imageContainerRef={imageContainerRef}\n            className=\"image\"\n            elements={elements}\n          />\n          {(isSelected || isResizing) && (\n            <ImageResizer\n              showCaption={true}\n              setShowCaption={() => null}\n              imageRef={imageContainerRef}\n              editor={editor}\n              onResizeStart={onResizeStart}\n              onResizeEnd={onResizeEnd}\n            />\n          )}\n        </button>\n      )}\n    </>\n  );\n}\n\nexport type SerializedExcalidrawNode = Spread<\n  {\n    data: string;\n    type: 'excalidraw';\n    version: 1;\n  },\n  SerializedLexicalNode\n>;\n\nfunction convertExcalidrawElement(\n  domNode: HTMLElement,\n): DOMConversionOutput | null {\n  const excalidrawData = domNode.getAttribute('data-lexical-excalidraw-json');\n  if (excalidrawData) {\n    const node = $createExcalidrawNode();\n    node.__data = excalidrawData;\n    return {\n      node,\n    };\n  }\n  return null;\n}\n\nexport class ExcalidrawNode extends DecoratorNode<JSX.Element> {\n  __data: string;\n\n  static getType(): string {\n    return 'excalidraw';\n  }\n\n  static clone(node: ExcalidrawNode): ExcalidrawNode {\n    return new ExcalidrawNode(node.__data, node.__key);\n  }\n\n  static importJSON(serializedNode: SerializedExcalidrawNode): ExcalidrawNode {\n    return new ExcalidrawNode(serializedNode.data);\n  }\n\n  exportJSON(): SerializedExcalidrawNode {\n    return {\n      data: this.__data,\n      type: 'excalidraw',\n      version: 1,\n    };\n  }\n\n  constructor(data = '[]', key?: NodeKey) {\n    super(key);\n    this.__data = data;\n  }\n\n  // View\n  createDOM(config: EditorConfig): HTMLElement {\n    const span = document.createElement('span');\n    const theme = config.theme;\n    const className = theme.image;\n    if (className !== undefined) {\n      span.className = className;\n    }\n    return span;\n  }\n\n  updateDOM(): false {\n    return false;\n  }\n\n  static importDOM(): DOMConversionMap<HTMLSpanElement> | null {\n    return {\n      span: (domNode: HTMLSpanElement) => {\n        if (!domNode.hasAttribute('data-lexical-excalidraw-json')) {\n          return null;\n        }\n        return {\n          conversion: convertExcalidrawElement,\n          priority: 1,\n        };\n      },\n    };\n  }\n\n  exportDOM(editor: LexicalEditor): DOMExportOutput {\n    const element = document.createElement('span');\n    const content = editor.getElementByKey(this.getKey());\n    if (content !== null) {\n      const svg = content.querySelector('svg');\n      if (svg !== null) {\n        element.innerHTML = svg.outerHTML;\n      }\n    }\n    element.setAttribute('data-lexical-excalidraw-json', this.__data);\n    return {element};\n  }\n\n  setData(data: string): void {\n    const self = this.getWritable();\n    self.__data = data;\n  }\n\n  decorate(editor: LexicalEditor, config: EditorConfig): JSX.Element {\n    return <ExcalidrawComponent nodeKey={this.getKey()} data={this.__data} />;\n  }\n}\n\nexport function $createExcalidrawNode(): ExcalidrawNode {\n  return new ExcalidrawNode();\n}\n\nexport function $isExcalidrawNode(\n  node: LexicalNode | null,\n): node is ExcalidrawNode {\n  return node instanceof ExcalidrawNode;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport type {LexicalCommand} from 'lexical';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $getSelection,\n  $isRangeSelection,\n  COMMAND_PRIORITY_EDITOR,\n  createCommand,\n} from 'lexical';\nimport {useEffect} from 'react';\n\nimport {$createExcalidrawNode, ExcalidrawNode} from '../nodes/ExcalidrawNode';\n\nexport const INSERT_EXCALIDRAW_COMMAND: LexicalCommand<void> = createCommand();\nexport default function ExcalidrawPlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n  useEffect(() => {\n    if (!editor.hasNodes([ExcalidrawNode])) {\n      throw new Error(\n        'ExcalidrawPlugin: ExcalidrawNode not registered on editor',\n      );\n    }\n\n    return editor.registerCommand(\n      INSERT_EXCALIDRAW_COMMAND,\n      () => {\n        const selection = $getSelection();\n\n        if ($isRangeSelection(selection)) {\n          const excalidrawNode = $createExcalidrawNode();\n          selection.insertNodes([excalidrawNode]);\n        }\n\n        return true;\n      },\n      COMMAND_PRIORITY_EDITOR,\n    );\n  }, [editor]);\n\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $createHorizontalRuleNode,\n  INSERT_HORIZONTAL_RULE_COMMAND,\n} from '@lexical/react/LexicalHorizontalRuleNode';\nimport {\n  $getSelection,\n  $isRangeSelection,\n  COMMAND_PRIORITY_EDITOR,\n} from 'lexical';\nimport {useEffect} from 'react';\n\nexport default function HorizontalRulePlugin(): null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    return editor.registerCommand(\n      INSERT_HORIZONTAL_RULE_COMMAND,\n      (type) => {\n        const selection = $getSelection();\n\n        if (!$isRangeSelection(selection)) {\n          return false;\n        }\n\n        const focusNode = selection.focus.getNode();\n\n        if (focusNode !== null) {\n          const horizontalRuleNode = $createHorizontalRuleNode();\n          selection.insertParagraph();\n          selection.focus\n            .getNode()\n            .getTopLevelElementOrThrow()\n            .insertBefore(horizontalRuleNode);\n        }\n\n        return true;\n      },\n      COMMAND_PRIORITY_EDITOR,\n    );\n  }, [editor]);\n\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nconst getSelection = (): Selection | null => window.getSelection();\n\nexport default getSelection;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  EditorConfig,\n  LexicalNode,\n  SerializedTextNode,\n  Spread,\n} from 'lexical';\n\nimport {TextNode} from 'lexical';\n\nexport type SerializedKeywordNode = Spread<\n  {\n    type: 'keyword';\n    version: 1;\n  },\n  SerializedTextNode\n>;\n\nexport class KeywordNode extends TextNode {\n  static getType(): string {\n    return 'keyword';\n  }\n\n  static clone(node: KeywordNode): KeywordNode {\n    return new KeywordNode(node.__text, node.__key);\n  }\n\n  static importJSON(serializedNode: SerializedKeywordNode): KeywordNode {\n    const node = $createKeywordNode(serializedNode.text);\n    node.setFormat(serializedNode.format);\n    node.setDetail(serializedNode.detail);\n    node.setMode(serializedNode.mode);\n    node.setStyle(serializedNode.style);\n    return node;\n  }\n\n  exportJSON(): SerializedKeywordNode {\n    return {\n      ...super.exportJSON(),\n      type: 'keyword',\n      version: 1,\n    };\n  }\n\n  createDOM(config: EditorConfig): HTMLElement {\n    const dom = super.createDOM(config);\n    dom.style.cursor = 'default';\n    dom.className = 'keyword';\n    return dom;\n  }\n\n  canInsertTextBefore(): boolean {\n    return false;\n  }\n\n  canInsertTextAfter(): boolean {\n    return false;\n  }\n\n  isTextEntity(): true {\n    return true;\n  }\n}\n\nexport function $createKeywordNode(keyword: string): KeywordNode {\n  return new KeywordNode(keyword);\n}\n\nexport function $isKeywordNode(\n  node: LexicalNode | null | undefined | undefined,\n): boolean {\n  return node instanceof KeywordNode;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {TextNode} from 'lexical';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {useLexicalTextEntity} from '@lexical/react/useLexicalTextEntity';\nimport {useCallback, useEffect} from 'react';\n\nimport {$createKeywordNode, KeywordNode} from '../nodes/KeywordNode';\n\nconst KEYWORDS_REGEX =\n  /(^|$|[^A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ])(congrats|congratulations|gratuluju|gratuluji|gratulujeme|blahopřeju|blahopřeji|blahopřejeme|Til lykke|Tillykke|Glückwunsch|Gratuliere|felicitaciones|enhorabuena|paljon onnea|onnittelut|Félicitations|gratula|gratulálok|gratulálunk|congratulazioni|complimenti|おめでとう|おめでとうございます|축하해|축하해요|gratulerer|Gefeliciteerd|gratulacje|Parabéns|parabéns|felicitações|felicitări|мои поздравления|поздравляем|поздравляю|gratulujem|blahoželám|ยินดีด้วย|ขอแสดงความยินดี|tebrikler|tebrik ederim|恭喜|祝贺你|恭喜你|恭喜|恭喜|baie geluk|veels geluk|অভিনন্দন|Čestitam|Čestitke|Čestitamo|Συγχαρητήρια|Μπράβο|અભિનંદન|badhai|बधाई|अभिनंदन|Честитам|Свака част|hongera|வாழ்த்துகள்|வாழ்த்துக்கள்|అభినందనలు|അഭിനന്ദനങ്ങൾ|Chúc mừng|מזל טוב|mazel tov|mazal tov)(^|$|[^A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ])/i;\n\nexport default function KeywordsPlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    if (!editor.hasNodes([KeywordNode])) {\n      throw new Error('KeywordsPlugin: KeywordNode not registered on editor');\n    }\n  }, [editor]);\n\n  const createKeywordNode = useCallback((textNode: TextNode): KeywordNode => {\n    return $createKeywordNode(textNode.getTextContent());\n  }, []);\n\n  const getKeywordMatch = useCallback((text: string) => {\n    const matchArr = KEYWORDS_REGEX.exec(text);\n\n    if (matchArr === null) {\n      return null;\n    }\n\n    const hashtagLength = matchArr[2].length;\n    const startOffset = matchArr.index + matchArr[1].length;\n    const endOffset = startOffset + hashtagLength;\n    return {\n      end: endOffset,\n      start: startOffset,\n    };\n  }, []);\n\n  useLexicalTextEntity<KeywordNode>(\n    getKeywordMatch,\n    KeywordNode,\n    createKeywordNode,\n  );\n\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nexport const CAN_USE_DOM: boolean =\n  typeof window !== 'undefined' &&\n  typeof window.document !== 'undefined' &&\n  typeof window.document.createElement !== 'undefined';\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useEffect, useLayoutEffect} from 'react';\nimport {CAN_USE_DOM} from '../../shared/src/canUseDOM';\n\nconst useLayoutEffectImpl: typeof useLayoutEffect = CAN_USE_DOM\n  ? useLayoutEffect\n  : useEffect;\n\nexport default useLayoutEffectImpl;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {Spread} from 'lexical';\n\nimport {\n  DOMConversionMap,\n  DOMConversionOutput,\n  DOMExportOutput,\n  EditorConfig,\n  LexicalNode,\n  NodeKey,\n  SerializedTextNode,\n  TextNode,\n} from 'lexical';\n\nexport type SerializedMentionNode = Spread<\n  {\n    mentionName: string;\n    type: 'mention';\n    version: 1;\n  },\n  SerializedTextNode\n>;\n\nfunction convertMentionElement(\n  domNode: HTMLElement,\n): DOMConversionOutput | null {\n  const textContent = domNode.textContent;\n\n  if (textContent !== null) {\n    const node = $createMentionNode(textContent);\n    return {\n      node,\n    };\n  }\n\n  return null;\n}\n\nconst mentionStyle = 'background-color: rgba(24, 119, 232, 0.2)';\nexport class MentionNode extends TextNode {\n  __mention: string;\n\n  static getType(): string {\n    return 'mention';\n  }\n\n  static clone(node: MentionNode): MentionNode {\n    return new MentionNode(node.__mention, node.__text, node.__key);\n  }\n  static importJSON(serializedNode: SerializedMentionNode): MentionNode {\n    const node = $createMentionNode(serializedNode.mentionName);\n    node.setTextContent(serializedNode.text);\n    node.setFormat(serializedNode.format);\n    node.setDetail(serializedNode.detail);\n    node.setMode(serializedNode.mode);\n    node.setStyle(serializedNode.style);\n    return node;\n  }\n\n  constructor(mentionName: string, text?: string, key?: NodeKey) {\n    super(text ?? mentionName, key);\n    this.__mention = mentionName;\n  }\n\n  exportJSON(): SerializedMentionNode {\n    return {\n      ...super.exportJSON(),\n      mentionName: this.__mention,\n      type: 'mention',\n      version: 1,\n    };\n  }\n\n  createDOM(config: EditorConfig): HTMLElement {\n    const dom = super.createDOM(config);\n    dom.style.cssText = mentionStyle;\n    dom.className = 'mention';\n    return dom;\n  }\n\n  exportDOM(): DOMExportOutput {\n    const element = document.createElement('span');\n    element.setAttribute('data-lexical-mention', 'true');\n    element.textContent = this.__text;\n    return {element};\n  }\n\n  static importDOM(): DOMConversionMap | null {\n    return {\n      span: (domNode: HTMLElement) => {\n        if (!domNode.hasAttribute('data-lexical-mention')) {\n          return null;\n        }\n        return {\n          conversion: convertMentionElement,\n          priority: 1,\n        };\n      },\n    };\n  }\n\n  isTextEntity(): true {\n    return true;\n  }\n}\n\nexport function $createMentionNode(mentionName: string): MentionNode {\n  const mentionNode = new MentionNode(mentionName);\n  mentionNode.setMode('segmented').toggleDirectionless();\n  return mentionNode;\n}\n\nexport function $isMentionNode(\n  node: LexicalNode | null | undefined,\n): node is MentionNode {\n  return node instanceof MentionNode;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {LexicalEditor, RangeSelection} from 'lexical';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {mergeRegister} from '@lexical/utils';\nimport {\n  $getSelection,\n  $isRangeSelection,\n  $isTextNode,\n  COMMAND_PRIORITY_LOW,\n  KEY_ARROW_DOWN_COMMAND,\n  KEY_ARROW_UP_COMMAND,\n  KEY_ENTER_COMMAND,\n  KEY_ESCAPE_COMMAND,\n  KEY_TAB_COMMAND,\n} from 'lexical';\nimport {\n  ReactPortal,\n  startTransition,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport * as React from 'react';\nimport {createPortal} from 'react-dom';\nimport useLayoutEffect from '../shared/src/useLayoutEffect';\n\nimport {$createMentionNode, MentionNode} from '../nodes/MentionNode';\n\ntype MentionMatch = {\n  leadOffset: number;\n  matchingString: string;\n  replaceableString: string;\n};\n\ntype Resolution = {\n  match: MentionMatch;\n  range: Range;\n};\n\nconst PUNCTUATION =\n  '\\\\.,\\\\+\\\\*\\\\?\\\\$\\\\@\\\\|#{}\\\\(\\\\)\\\\^\\\\-\\\\[\\\\]\\\\\\\\/!%\\'\"~=<>_:;';\nconst NAME = '\\\\b[A-Z][^\\\\s' + PUNCTUATION + ']';\n\nconst DocumentMentionsRegex = {\n  NAME,\n  PUNCTUATION,\n};\n\nconst CapitalizedNameMentionsRegex = new RegExp(\n  '(^|[^#])((?:' + DocumentMentionsRegex.NAME + '{' + 1 + ',})$)',\n);\n\nconst PUNC = DocumentMentionsRegex.PUNCTUATION;\n\nconst TRIGGERS = ['@', '\\\\uff20'].join('');\n\n// Chars we expect to see in a mention (non-space, non-punctuation).\nconst VALID_CHARS = '[^' + TRIGGERS + PUNC + '\\\\s]';\n\n// Non-standard series of chars. Each series must be preceded and followed by\n// a valid char.\nconst VALID_JOINS =\n  '(?:' +\n  '\\\\.[ |$]|' + // E.g. \"r. \" in \"Mr. Smith\"\n  ' |' + // E.g. \" \" in \"Josh Duck\"\n  '[' +\n  PUNC +\n  ']|' + // E.g. \"-' in \"Salier-Hellendag\"\n  ')';\n\nconst LENGTH_LIMIT = 75;\n\nconst AtSignMentionsRegex = new RegExp(\n  '(^|\\\\s|\\\\()(' +\n    '[' +\n    TRIGGERS +\n    ']' +\n    '((?:' +\n    VALID_CHARS +\n    VALID_JOINS +\n    '){0,' +\n    LENGTH_LIMIT +\n    '})' +\n    ')$',\n);\n\n// 50 is the longest alias length limit.\nconst ALIAS_LENGTH_LIMIT = 50;\n\n// Regex used to match alias.\nconst AtSignMentionsRegexAliasRegex = new RegExp(\n  '(^|\\\\s|\\\\()(' +\n    '[' +\n    TRIGGERS +\n    ']' +\n    '((?:' +\n    VALID_CHARS +\n    '){0,' +\n    ALIAS_LENGTH_LIMIT +\n    '})' +\n    ')$',\n);\n\n// At most, 5 suggestions are shown in the popup.\nconst SUGGESTION_LIST_LENGTH_LIMIT = 5;\n\nconst mentionsCache = new Map();\n\nconst dummyMentionsData = [\n  'Aayla Secura',\n  'Adi Gallia',\n  'Admiral Dodd Rancit',\n  'Admiral Firmus Piett',\n  'Admiral Gial Ackbar',\n  'Admiral Ozzel',\n  'Admiral Raddus',\n  'Admiral Terrinald Screed',\n  'Admiral Trench',\n  'Admiral U.O. Statura',\n  'Agen Kolar',\n  'Agent Kallus',\n  'Aiolin and Morit Astarte',\n  'Aks Moe',\n  'Almec',\n  'Alton Kastle',\n  'Amee',\n  'AP-5',\n  'Armitage Hux',\n  'Artoo',\n  'Arvel Crynyd',\n  'Asajj Ventress',\n  'Aurra Sing',\n  'AZI-3',\n  'Bala-Tik',\n  'Barada',\n  'Bargwill Tomder',\n  'Baron Papanoida',\n  'Barriss Offee',\n  'Baze Malbus',\n  'Bazine Netal',\n  'BB-8',\n  'BB-9E',\n  'Ben Quadinaros',\n  'Berch Teller',\n  'Beru Lars',\n  'Bib Fortuna',\n  'Biggs Darklighter',\n  'Black Krrsantan',\n  'Bo-Katan Kryze',\n  'Boba Fett',\n  'Bobbajo',\n  'Bodhi Rook',\n  'Borvo the Hutt',\n  'Boss Nass',\n  'Bossk',\n  'Breha Antilles-Organa',\n  'Bren Derlin',\n  'Brendol Hux',\n  'BT-1',\n  'C-3PO',\n  'C1-10P',\n  'Cad Bane',\n  'Caluan Ematt',\n  'Captain Gregor',\n  'Captain Phasma',\n  'Captain Quarsh Panaka',\n  'Captain Rex',\n  'Carlist Rieekan',\n  'Casca Panzoro',\n  'Cassian Andor',\n  'Cassio Tagge',\n  'Cham Syndulla',\n  'Che Amanwe Papanoida',\n  'Chewbacca',\n  'Chi Eekway Papanoida',\n  'Chief Chirpa',\n  'Chirrut Îmwe',\n  'Ciena Ree',\n  'Cin Drallig',\n  'Clegg Holdfast',\n  'Cliegg Lars',\n  'Coleman Kcaj',\n  'Coleman Trebor',\n  'Colonel Kaplan',\n  'Commander Bly',\n  'Commander Cody (CC-2224)',\n  'Commander Fil (CC-3714)',\n  'Commander Fox',\n  'Commander Gree',\n  'Commander Jet',\n  'Commander Wolffe',\n  'Conan Antonio Motti',\n  'Conder Kyl',\n  'Constable Zuvio',\n  'Cordé',\n  'Cpatain Typho',\n  'Crix Madine',\n  'Cut Lawquane',\n  'Dak Ralter',\n  'Dapp',\n  'Darth Bane',\n  'Darth Maul',\n  'Darth Tyranus',\n  'Daultay Dofine',\n  'Del Meeko',\n  'Delian Mors',\n  'Dengar',\n  'Depa Billaba',\n  'Derek Klivian',\n  'Dexter Jettster',\n  'Dineé Ellberger',\n  'DJ',\n  'Doctor Aphra',\n  'Doctor Evazan',\n  'Dogma',\n  'Dormé',\n  'Dr. Cylo',\n  'Droidbait',\n  'Droopy McCool',\n  'Dryden Vos',\n  'Dud Bolt',\n  'Ebe E. Endocott',\n  'Echuu Shen-Jon',\n  'Eeth Koth',\n  'Eighth Brother',\n  'Eirtaé',\n  'Eli Vanto',\n  'Ellé',\n  'Ello Asty',\n  'Embo',\n  'Eneb Ray',\n  'Enfys Nest',\n  'EV-9D9',\n  'Evaan Verlaine',\n  'Even Piell',\n  'Ezra Bridger',\n  'Faro Argyus',\n  'Feral',\n  'Fifth Brother',\n  'Finis Valorum',\n  'Finn',\n  'Fives',\n  'FN-1824',\n  'FN-2003',\n  'Fodesinbeed Annodue',\n  'Fulcrum',\n  'FX-7',\n  'GA-97',\n  'Galen Erso',\n  'Gallius Rax',\n  'Garazeb \"Zeb\" Orrelios',\n  'Gardulla the Hutt',\n  'Garrick Versio',\n  'Garven Dreis',\n  'Gavyn Sykes',\n  'Gideon Hask',\n  'Gizor Dellso',\n  'Gonk droid',\n  'Grand Inquisitor',\n  'Greeata Jendowanian',\n  'Greedo',\n  'Greer Sonnel',\n  'Grievous',\n  'Grummgar',\n  'Gungi',\n  'Hammerhead',\n  'Han Solo',\n  'Harter Kalonia',\n  'Has Obbit',\n  'Hera Syndulla',\n  'Hevy',\n  'Hondo Ohnaka',\n  'Huyang',\n  'Iden Versio',\n  'IG-88',\n  'Ima-Gun Di',\n  'Inquisitors',\n  'Inspector Thanoth',\n  'Jabba',\n  'Jacen Syndulla',\n  'Jan Dodonna',\n  'Jango Fett',\n  'Janus Greejatus',\n  'Jar Jar Binks',\n  'Jas Emari',\n  'Jaxxon',\n  'Jek Tono Porkins',\n  'Jeremoch Colton',\n  'Jira',\n  'Jobal Naberrie',\n  'Jocasta Nu',\n  'Joclad Danva',\n  'Joh Yowza',\n  'Jom Barell',\n  'Joph Seastriker',\n  'Jova Tarkin',\n  'Jubnuk',\n  'Jyn Erso',\n  'K-2SO',\n  'Kanan Jarrus',\n  'Karbin',\n  'Karina the Great',\n  'Kes Dameron',\n  'Ketsu Onyo',\n  'Ki-Adi-Mundi',\n  'King Katuunko',\n  'Kit Fisto',\n  'Kitster Banai',\n  'Klaatu',\n  'Klik-Klak',\n  'Korr Sella',\n  'Kylo Ren',\n  'L3-37',\n  'Lama Su',\n  'Lando Calrissian',\n  'Lanever Villecham',\n  'Leia Organa',\n  'Letta Turmond',\n  'Lieutenant Kaydel Ko Connix',\n  'Lieutenant Thire',\n  'Lobot',\n  'Logray',\n  'Lok Durd',\n  'Longo Two-Guns',\n  'Lor San Tekka',\n  'Lorth Needa',\n  'Lott Dod',\n  'Luke Skywalker',\n  'Lumat',\n  'Luminara Unduli',\n  'Lux Bonteri',\n  'Lyn Me',\n  'Lyra Erso',\n  'Mace Windu',\n  'Malakili',\n  'Mama the Hutt',\n  'Mars Guo',\n  'Mas Amedda',\n  'Mawhonic',\n  'Max Rebo',\n  'Maximilian Veers',\n  'Maz Kanata',\n  'ME-8D9',\n  'Meena Tills',\n  'Mercurial Swift',\n  'Mina Bonteri',\n  'Miraj Scintel',\n  'Mister Bones',\n  'Mod Terrik',\n  'Moden Canady',\n  'Mon Mothma',\n  'Moradmin Bast',\n  'Moralo Eval',\n  'Morley',\n  'Mother Talzin',\n  'Nahdar Vebb',\n  'Nahdonnis Praji',\n  'Nien Nunb',\n  'Niima the Hutt',\n  'Nines',\n  'Norra Wexley',\n  'Nute Gunray',\n  'Nuvo Vindi',\n  'Obi-Wan Kenobi',\n  'Odd Ball',\n  'Ody Mandrell',\n  'Omi',\n  'Onaconda Farr',\n  'Oola',\n  'OOM-9',\n  'Oppo Rancisis',\n  'Orn Free Taa',\n  'Oro Dassyne',\n  'Orrimarko',\n  'Osi Sobeck',\n  'Owen Lars',\n  'Pablo-Jill',\n  'Padmé Amidala',\n  'Pagetti Rook',\n  'Paige Tico',\n  'Paploo',\n  'Petty Officer Thanisson',\n  'Pharl McQuarrie',\n  'Plo Koon',\n  'Po Nudo',\n  'Poe Dameron',\n  'Poggle the Lesser',\n  'Pong Krell',\n  'Pooja Naberrie',\n  'PZ-4CO',\n  'Quarrie',\n  'Quay Tolsite',\n  'Queen Apailana',\n  'Queen Jamillia',\n  'Queen Neeyutnee',\n  'Qui-Gon Jinn',\n  'Quiggold',\n  'Quinlan Vos',\n  'R2-D2',\n  'R2-KT',\n  'R3-S6',\n  'R4-P17',\n  'R5-D4',\n  'RA-7',\n  'Rabé',\n  'Rako Hardeen',\n  'Ransolm Casterfo',\n  'Rappertunie',\n  'Ratts Tyerell',\n  'Raymus Antilles',\n  'Ree-Yees',\n  'Reeve Panzoro',\n  'Rey',\n  'Ric Olié',\n  'Riff Tamson',\n  'Riley',\n  'Rinnriyin Di',\n  'Rio Durant',\n  'Rogue Squadron',\n  'Romba',\n  'Roos Tarpals',\n  'Rose Tico',\n  'Rotta the Hutt',\n  'Rukh',\n  'Rune Haako',\n  'Rush Clovis',\n  'Ruwee Naberrie',\n  'Ryoo Naberrie',\n  'Sabé',\n  'Sabine Wren',\n  'Saché',\n  'Saelt-Marae',\n  'Saesee Tiin',\n  'Salacious B. Crumb',\n  'San Hill',\n  'Sana Starros',\n  'Sarco Plank',\n  'Sarkli',\n  'Satine Kryze',\n  'Savage Opress',\n  'Sebulba',\n  'Senator Organa',\n  'Sergeant Kreel',\n  'Seventh Sister',\n  'Shaak Ti',\n  'Shara Bey',\n  'Shmi Skywalker',\n  'Shu Mai',\n  'Sidon Ithano',\n  'Sifo-Dyas',\n  'Sim Aloo',\n  'Siniir Rath Velus',\n  'Sio Bibble',\n  'Sixth Brother',\n  'Slowen Lo',\n  'Sly Moore',\n  'Snaggletooth',\n  'Snap Wexley',\n  'Snoke',\n  'Sola Naberrie',\n  'Sora Bulq',\n  'Strono Tuggs',\n  'Sy Snootles',\n  'Tallissan Lintra',\n  'Tarfful',\n  'Tasu Leech',\n  'Taun We',\n  'TC-14',\n  'Tee Watt Kaa',\n  'Teebo',\n  'Teedo',\n  'Teemto Pagalies',\n  'Temiri Blagg',\n  'Tessek',\n  'Tey How',\n  'Thane Kyrell',\n  'The Bendu',\n  'The Smuggler',\n  'Thrawn',\n  'Tiaan Jerjerrod',\n  'Tion Medon',\n  'Tobias Beckett',\n  'Tulon Voidgazer',\n  'Tup',\n  'U9-C4',\n  'Unkar Plutt',\n  'Val Beckett',\n  'Vanden Willard',\n  'Vice Admiral Amilyn Holdo',\n  'Vober Dand',\n  'WAC-47',\n  'Wag Too',\n  'Wald',\n  'Walrus Man',\n  'Warok',\n  'Wat Tambor',\n  'Watto',\n  'Wedge Antilles',\n  'Wes Janson',\n  'Wicket W. Warrick',\n  'Wilhuff Tarkin',\n  'Wollivan',\n  'Wuher',\n  'Wullf Yularen',\n  'Xamuel Lennox',\n  'Yaddle',\n  'Yarael Poof',\n  'Yoda',\n  'Zam Wesell',\n  'Zev Senesca',\n  'Ziro the Hutt',\n  'Zuckuss',\n];\n\nconst dummyLookupService = {\n  search(\n    string: string,\n    callback: (results: Array<string> | null) => void,\n  ): void {\n    setTimeout(() => {\n      const results = dummyMentionsData.filter((mention) =>\n        mention.toLowerCase().includes(string.toLowerCase()),\n      );\n      if (results.length === 0) {\n        callback(null);\n      } else {\n        callback(results);\n      }\n    }, 500);\n  },\n};\n\nfunction useMentionLookupService(mentionString: string) {\n  const [results, setResults] = useState<Array<string> | null>(null);\n\n  useEffect(() => {\n    const cachedResults = mentionsCache.get(mentionString);\n\n    if (cachedResults === null) {\n      return;\n    } else if (cachedResults !== undefined) {\n      setResults(cachedResults);\n      return;\n    }\n\n    mentionsCache.set(mentionString, null);\n    dummyLookupService.search(mentionString, (newResults) => {\n      mentionsCache.set(mentionString, newResults);\n      setResults(newResults);\n    });\n  }, [mentionString]);\n\n  return results;\n}\n\nfunction MentionsTypeaheadItem({\n  index,\n  isSelected,\n  onClick,\n  onMouseEnter,\n  result,\n}: {\n  index: number;\n  isSelected: boolean;\n  onClick: () => void;\n  onMouseEnter: () => void;\n  result: string;\n}) {\n  const liRef = useRef(null);\n\n  let className = 'item';\n  if (isSelected) {\n    className += ' selected';\n  }\n\n  return (\n    <li\n      key={result}\n      tabIndex={-1}\n      className={className}\n      ref={liRef}\n      role=\"option\"\n      aria-selected={isSelected}\n      id={'typeahead-item-' + index}\n      onMouseEnter={onMouseEnter}\n      onClick={onClick}>\n      {result}\n    </li>\n  );\n}\n\nfunction MentionsTypeahead({\n  close,\n  editor,\n  resolution,\n}: {\n  close: () => void;\n  editor: LexicalEditor;\n  resolution: Resolution;\n}): JSX.Element | null {\n  const divRef = useRef<HTMLDivElement>(null);\n  const match = resolution.match;\n  const results = useMentionLookupService(match.matchingString);\n  const [selectedIndex, setSelectedIndex] = useState<null | number>(null);\n\n  useEffect(() => {\n    const div = divRef.current;\n    const rootElement = editor.getRootElement();\n    if (results !== null && div !== null && rootElement !== null) {\n      const range = resolution.range;\n      const {left, top, height} = range.getBoundingClientRect();\n      div.style.top = `${top + height + 2}px`;\n      div.style.left = `${left - 14}px`;\n      div.style.display = 'block';\n      rootElement.setAttribute('aria-controls', 'mentions-typeahead');\n\n      return () => {\n        div.style.display = 'none';\n        rootElement.removeAttribute('aria-controls');\n      };\n    }\n  }, [editor, resolution, results]);\n\n  const applyCurrentSelected = useCallback(() => {\n    if (results === null || selectedIndex === null) {\n      return;\n    }\n    const selectedEntry = results[selectedIndex];\n\n    close();\n\n    createMentionNodeFromSearchResult(editor, selectedEntry, match);\n  }, [close, match, editor, results, selectedIndex]);\n\n  const updateSelectedIndex = useCallback(\n    (index: number) => {\n      const rootElem = editor.getRootElement();\n      if (rootElem !== null) {\n        rootElem.setAttribute(\n          'aria-activedescendant',\n          'typeahead-item-' + index,\n        );\n        setSelectedIndex(index);\n      }\n    },\n    [editor],\n  );\n\n  useEffect(() => {\n    return () => {\n      const rootElem = editor.getRootElement();\n      if (rootElem !== null) {\n        rootElem.removeAttribute('aria-activedescendant');\n      }\n    };\n  }, [editor]);\n\n  useLayoutEffect(() => {\n    if (results === null) {\n      setSelectedIndex(null);\n    } else if (selectedIndex === null) {\n      updateSelectedIndex(0);\n    }\n  }, [results, selectedIndex, updateSelectedIndex]);\n\n  useEffect(() => {\n    return mergeRegister(\n      editor.registerCommand<KeyboardEvent>(\n        KEY_ARROW_DOWN_COMMAND,\n        (payload) => {\n          const event = payload;\n          if (results !== null && selectedIndex !== null) {\n            if (\n              selectedIndex < SUGGESTION_LIST_LENGTH_LIMIT - 1 &&\n              selectedIndex !== results.length - 1\n            ) {\n              updateSelectedIndex(selectedIndex + 1);\n            }\n            event.preventDefault();\n            event.stopImmediatePropagation();\n          }\n          return true;\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand<KeyboardEvent>(\n        KEY_ARROW_UP_COMMAND,\n        (payload) => {\n          const event = payload;\n          if (results !== null && selectedIndex !== null) {\n            if (selectedIndex !== 0) {\n              updateSelectedIndex(selectedIndex - 1);\n            }\n            event.preventDefault();\n            event.stopImmediatePropagation();\n          }\n          return true;\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand<KeyboardEvent>(\n        KEY_ESCAPE_COMMAND,\n        (payload) => {\n          const event = payload;\n          if (results === null || selectedIndex === null) {\n            return false;\n          }\n          event.preventDefault();\n          event.stopImmediatePropagation();\n          close();\n          return true;\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand<KeyboardEvent>(\n        KEY_TAB_COMMAND,\n        (payload) => {\n          const event = payload;\n          if (results === null || selectedIndex === null) {\n            return false;\n          }\n          event.preventDefault();\n          event.stopImmediatePropagation();\n          applyCurrentSelected();\n          return true;\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand(\n        KEY_ENTER_COMMAND,\n        (event: KeyboardEvent | null) => {\n          if (results === null || selectedIndex === null) {\n            return false;\n          }\n          if (event !== null) {\n            event.preventDefault();\n            event.stopImmediatePropagation();\n          }\n          applyCurrentSelected();\n          return true;\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n    );\n  }, [\n    applyCurrentSelected,\n    close,\n    editor,\n    results,\n    selectedIndex,\n    updateSelectedIndex,\n  ]);\n\n  if (results === null) {\n    return null;\n  }\n\n  return (\n    <div\n      aria-label=\"Suggested mentions\"\n      id=\"mentions-typeahead\"\n      ref={divRef}\n      role=\"listbox\">\n      <ul>\n        {results.slice(0, SUGGESTION_LIST_LENGTH_LIMIT).map((result, i) => (\n          <MentionsTypeaheadItem\n            index={i}\n            isSelected={i === selectedIndex}\n            onClick={() => {\n              setSelectedIndex(i);\n              applyCurrentSelected();\n            }}\n            onMouseEnter={() => {\n              setSelectedIndex(i);\n            }}\n            key={result}\n            result={result}\n          />\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nfunction checkForCapitalizedNameMentions(\n  text: string,\n  minMatchLength: number,\n): MentionMatch | null {\n  const match = CapitalizedNameMentionsRegex.exec(text);\n  if (match !== null) {\n    // The strategy ignores leading whitespace but we need to know it's\n    // length to add it to the leadOffset\n    const maybeLeadingWhitespace = match[1];\n\n    const matchingString = match[2];\n    if (matchingString != null && matchingString.length >= minMatchLength) {\n      return {\n        leadOffset: match.index + maybeLeadingWhitespace.length,\n        matchingString,\n        replaceableString: matchingString,\n      };\n    }\n  }\n  return null;\n}\n\nfunction checkForAtSignMentions(\n  text: string,\n  minMatchLength: number,\n): MentionMatch | null {\n  let match = AtSignMentionsRegex.exec(text);\n\n  if (match === null) {\n    match = AtSignMentionsRegexAliasRegex.exec(text);\n  }\n  if (match !== null) {\n    // The strategy ignores leading whitespace but we need to know it's\n    // length to add it to the leadOffset\n    const maybeLeadingWhitespace = match[1];\n\n    const matchingString = match[3];\n    if (matchingString.length >= minMatchLength) {\n      return {\n        leadOffset: match.index + maybeLeadingWhitespace.length,\n        matchingString,\n        replaceableString: match[2],\n      };\n    }\n  }\n  return null;\n}\n\nfunction getPossibleMentionMatch(text: string): MentionMatch | null {\n  const match = checkForAtSignMentions(text, 1);\n  return match === null ? checkForCapitalizedNameMentions(text, 3) : match;\n}\n\nfunction getTextUpToAnchor(selection: RangeSelection): string | null {\n  const anchor = selection.anchor;\n  if (anchor.type !== 'text') {\n    return null;\n  }\n  const anchorNode = anchor.getNode();\n  // We should not be attempting to extract mentions out of nodes\n  // that are already being used for other core things. This is\n  // especially true for token nodes, which can't be mutated at all.\n  if (!anchorNode.isSimpleText()) {\n    return null;\n  }\n  const anchorOffset = anchor.offset;\n  return anchorNode.getTextContent().slice(0, anchorOffset);\n}\n\nfunction tryToPositionRange(match: MentionMatch, range: Range): boolean {\n  const domSelection = window.getSelection();\n  if (domSelection === null || !domSelection.isCollapsed) {\n    return false;\n  }\n  const anchorNode = domSelection.anchorNode;\n  const startOffset = match.leadOffset;\n  const endOffset = domSelection.anchorOffset;\n  try {\n    if (anchorNode) {\n      range.setStart(anchorNode, startOffset);\n      range.setEnd(anchorNode, endOffset);\n    }\n  } catch (error) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction getMentionsTextToSearch(editor: LexicalEditor): string | null {\n  let text = null;\n  editor.getEditorState().read(() => {\n    const selection = $getSelection();\n    if (!$isRangeSelection(selection)) {\n      return;\n    }\n    text = getTextUpToAnchor(selection);\n  });\n  return text;\n}\n\n/**\n * Walk backwards along user input and forward through entity title to try\n * and replace more of the user's text with entity.\n *\n * E.g. User types \"Hello Sarah Smit\" and we match \"Smit\" to \"Sarah Smith\".\n * Replacing just the match would give us \"Hello Sarah Sarah Smith\".\n * Instead we find the string \"Sarah Smit\" and replace all of it.\n */\nfunction getMentionOffset(\n  documentText: string,\n  entryText: string,\n  offset: number,\n): number {\n  let triggerOffset = offset;\n  for (let ii = triggerOffset; ii <= entryText.length; ii++) {\n    if (documentText.substr(-ii) === entryText.substr(0, ii)) {\n      triggerOffset = ii;\n    }\n  }\n\n  return triggerOffset;\n}\n\n/**\n * From a Typeahead Search Result, replace plain text from search offset and\n * render a newly created MentionNode.\n */\nfunction createMentionNodeFromSearchResult(\n  editor: LexicalEditor,\n  entryText: string,\n  match: MentionMatch,\n): void {\n  editor.update(() => {\n    const selection = $getSelection();\n    if (!$isRangeSelection(selection) || !selection.isCollapsed()) {\n      return;\n    }\n    const anchor = selection.anchor;\n    if (anchor.type !== 'text') {\n      return;\n    }\n    const anchorNode = anchor.getNode();\n    // We should not be attempting to extract mentions out of nodes\n    // that are already being used for other core things. This is\n    // especially true for token nodes, which can't be mutated at all.\n    if (!anchorNode.isSimpleText()) {\n      return;\n    }\n    const selectionOffset = anchor.offset;\n    const textContent = anchorNode.getTextContent().slice(0, selectionOffset);\n    const characterOffset = match.replaceableString.length;\n\n    // Given a known offset for the mention match, look backward in the\n    // text to see if there's a longer match to replace.\n    const mentionOffset = getMentionOffset(\n      textContent,\n      entryText,\n      characterOffset,\n    );\n    const startOffset = selectionOffset - mentionOffset;\n    if (startOffset < 0) {\n      return;\n    }\n\n    let nodeToReplace;\n    if (startOffset === 0) {\n      [nodeToReplace] = anchorNode.splitText(selectionOffset);\n    } else {\n      [, nodeToReplace] = anchorNode.splitText(startOffset, selectionOffset);\n    }\n\n    const mentionNode = $createMentionNode(entryText);\n    nodeToReplace.replace(mentionNode);\n    mentionNode.select();\n  });\n}\n\nfunction isSelectionOnEntityBoundary(\n  editor: LexicalEditor,\n  offset: number,\n): boolean {\n  if (offset !== 0) {\n    return false;\n  }\n  return editor.getEditorState().read(() => {\n    const selection = $getSelection();\n    if ($isRangeSelection(selection)) {\n      const anchor = selection.anchor;\n      const anchorNode = anchor.getNode();\n      const prevSibling = anchorNode.getPreviousSibling();\n      return $isTextNode(prevSibling) && prevSibling.isTextEntity();\n    }\n    return false;\n  });\n}\n\nfunction useMentions(editor: LexicalEditor): ReactPortal | null {\n  const [resolution, setResolution] = useState<Resolution | null>(null);\n\n  useEffect(() => {\n    if (!editor.hasNodes([MentionNode])) {\n      throw new Error('MentionsPlugin: MentionNode not registered on editor');\n    }\n  }, [editor]);\n\n  useEffect(() => {\n    let activeRange: Range | null = document.createRange();\n    let previousText: string | null = null;\n\n    const updateListener = () => {\n      const range = activeRange;\n      const text = getMentionsTextToSearch(editor);\n\n      if (text === previousText || range === null) {\n        return;\n      }\n      previousText = text;\n\n      if (text === null) {\n        return;\n      }\n      const match = getPossibleMentionMatch(text);\n      if (\n        match !== null &&\n        !isSelectionOnEntityBoundary(editor, match.leadOffset)\n      ) {\n        const isRangePositioned = tryToPositionRange(match, range);\n        if (isRangePositioned !== null) {\n          startTransition(() =>\n            setResolution({\n              match,\n              range,\n            }),\n          );\n          return;\n        }\n      }\n      startTransition(() => setResolution(null));\n    };\n\n    const removeUpdateListener = editor.registerUpdateListener(updateListener);\n\n    return () => {\n      activeRange = null;\n      removeUpdateListener();\n    };\n  }, [editor]);\n\n  const closeTypeahead = useCallback(() => {\n    setResolution(null);\n  }, []);\n\n  return resolution === null || editor === null\n    ? null\n    : createPortal(\n        <MentionsTypeahead\n          close={closeTypeahead}\n          resolution={resolution}\n          editor={editor}\n        />,\n        document.body,\n      );\n}\n\nexport default function MentionsPlugin(): ReactPortal | null {\n  const [editor] = useLexicalComposerContext();\n  return useMentions(editor);\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $deleteTableColumn,\n  $getElementGridForTableNode,\n  $getTableCellNodeFromLexicalNode,\n  $getTableColumnIndexFromTableCellNode,\n  $getTableNodeFromLexicalNodeOrThrow,\n  $getTableRowIndexFromTableCellNode,\n  $isTableCellNode,\n  $isTableRowNode,\n  $removeTableRowAtIndex,\n  getTableSelectionFromTableElement,\n  HTMLTableElementWithWithTableSelectionState,\n  TableCellHeaderStates,\n  TableCellNode,\n} from '@lexical/table';\nimport {\n  $getSelection,\n  $isRangeSelection,\n  $setSelection,\n} from 'lexical';\nimport * as React from 'react';\nimport {ReactPortal, useCallback, useEffect, useRef, useState} from 'react';\nimport {createPortal} from 'react-dom';\n\ntype TableCellActionMenuProps = Readonly<{\n  contextRef: {current: null | HTMLElement};\n  onClose: () => void;\n  setIsMenuOpen: (isOpen: boolean) => void;\n  tableCellNode: TableCellNode;\n}>;\n\nfunction TableActionMenu({\n  onClose,\n  tableCellNode: _tableCellNode,\n  setIsMenuOpen,\n  contextRef,\n}: TableCellActionMenuProps) {\n  const [editor] = useLexicalComposerContext();\n  const dropDownRef = useRef<HTMLDivElement | null>(null);\n  const [tableCellNode, updateTableCellNode] = useState(_tableCellNode);\n  const [selectionCounts, updateSelectionCounts] = useState({\n    columns: 1,\n    rows: 1,\n  });\n\n  useEffect(() => {\n    return editor.registerMutationListener(TableCellNode, (nodeMutations) => {\n      const nodeUpdated =\n        nodeMutations.get(tableCellNode.getKey()) === 'updated';\n\n      if (nodeUpdated) {\n        editor.getEditorState().read(() => {\n          updateTableCellNode(tableCellNode.getLatest());\n        });\n      }\n    });\n  }, [editor, tableCellNode]);\n\n  useEffect(() => {\n    editor.getEditorState().read(() => {\n      const selection = $getSelection();\n\n\n    });\n  }, [editor]);\n\n  useEffect(() => {\n    const menuButtonElement = contextRef.current;\n    const dropDownElement = dropDownRef.current;\n\n    if (menuButtonElement != null && dropDownElement != null) {\n      const menuButtonRect = menuButtonElement.getBoundingClientRect();\n\n      dropDownElement.style.opacity = '1';\n\n      dropDownElement.style.left = `${\n        menuButtonRect.left + menuButtonRect.width + window.pageXOffset + 5\n      }px`;\n\n      dropDownElement.style.top = `${\n        menuButtonRect.top + window.pageYOffset\n      }px`;\n    }\n  }, [contextRef, dropDownRef]);\n\n  useEffect(() => {\n    function handleClickOutside(event: MouseEvent) {\n      if (\n        dropDownRef.current != null &&\n        contextRef.current != null &&\n        !dropDownRef.current.contains(event.target as Node) &&\n        !contextRef.current.contains(event.target as Node)\n      ) {\n        setIsMenuOpen(false);\n      }\n    }\n\n    window.addEventListener('click', handleClickOutside);\n\n    return () => window.removeEventListener('click', handleClickOutside);\n  }, [setIsMenuOpen, contextRef]);\n\n  const clearTableSelection = useCallback(() => {\n    editor.update(() => {\n      if (tableCellNode.isAttached()) {\n        const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n        const tableElement = editor.getElementByKey(\n          tableNode.getKey(),\n        ) as HTMLTableElementWithWithTableSelectionState;\n\n        if (!tableElement) {\n          throw new Error('Expected to find tableElement in DOM');\n        }\n\n        const tableSelection = getTableSelectionFromTableElement(tableElement);\n        if (tableSelection !== null) {\n          tableSelection.clearHighlight();\n        }\n\n        tableNode.markDirty();\n        updateTableCellNode(tableCellNode.getLatest());\n      }\n\n      $setSelection(null);\n    });\n  }, [editor, tableCellNode]);\n\n  const insertTableRowAtSelection = useCallback(\n    (shouldInsertAfter: boolean) => {\n      editor.update(() => {\n        const selection = $getSelection();\n\n        const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n        let tableRowIndex;\n\n \n\n        const grid = $getElementGridForTableNode(editor, tableNode);\n\n      \n        clearTableSelection();\n\n        onClose();\n      });\n    },\n    [editor, tableCellNode, selectionCounts.rows, clearTableSelection, onClose],\n  );\n\n  const insertTableColumnAtSelection = useCallback(\n    (shouldInsertAfter: boolean) => {\n      editor.update(() => {\n        const selection = $getSelection();\n\n        const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n        let tableColumnIndex;\n\n    \n        clearTableSelection();\n\n        onClose();\n      });\n    },\n    [\n      editor,\n      tableCellNode,\n      selectionCounts.columns,\n      clearTableSelection,\n      onClose,\n    ],\n  );\n\n  const deleteTableRowAtSelection = useCallback(() => {\n    editor.update(() => {\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n      const tableRowIndex = $getTableRowIndexFromTableCellNode(tableCellNode);\n\n      $removeTableRowAtIndex(tableNode, tableRowIndex);\n\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  const deleteTableAtSelection = useCallback(() => {\n    editor.update(() => {\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n      tableNode.remove();\n\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  const deleteTableColumnAtSelection = useCallback(() => {\n    editor.update(() => {\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n      const tableColumnIndex =\n        $getTableColumnIndexFromTableCellNode(tableCellNode);\n\n      $deleteTableColumn(tableNode, tableColumnIndex);\n\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  const toggleTableRowIsHeader = useCallback(() => {\n    editor.update(() => {\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n      const tableRowIndex = $getTableRowIndexFromTableCellNode(tableCellNode);\n\n      const tableRows = tableNode.getChildren();\n\n      if (tableRowIndex >= tableRows.length || tableRowIndex < 0) {\n        throw new Error('Expected table cell to be inside of table row.');\n      }\n\n      const tableRow = tableRows[tableRowIndex];\n\n      if (!$isTableRowNode(tableRow)) {\n        throw new Error('Expected table row');\n      }\n\n      tableRow.getChildren().forEach((tableCell) => {\n        if (!$isTableCellNode(tableCell)) {\n          throw new Error('Expected table cell');\n        }\n\n        tableCell.toggleHeaderStyle(TableCellHeaderStates.ROW);\n      });\n\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  const toggleTableColumnIsHeader = useCallback(() => {\n    editor.update(() => {\n      const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n      const tableColumnIndex =\n        $getTableColumnIndexFromTableCellNode(tableCellNode);\n\n      const tableRows = tableNode.getChildren();\n\n      for (let r = 0; r < tableRows.length; r++) {\n        const tableRow = tableRows[r];\n\n        if (!$isTableRowNode(tableRow)) {\n          throw new Error('Expected table row');\n        }\n\n        const tableCells = tableRow.getChildren();\n\n        if (tableColumnIndex >= tableCells.length || tableColumnIndex < 0) {\n          throw new Error('Expected table cell to be inside of table row.');\n        }\n\n        const tableCell = tableCells[tableColumnIndex];\n\n        if (!$isTableCellNode(tableCell)) {\n          throw new Error('Expected table cell');\n        }\n\n        tableCell.toggleHeaderStyle(TableCellHeaderStates.COLUMN);\n      }\n\n      clearTableSelection();\n      onClose();\n    });\n  }, [editor, tableCellNode, clearTableSelection, onClose]);\n\n  return createPortal(\n    <div\n      className=\"dropdown\"\n      ref={dropDownRef}\n      onClick={(e) => {\n        e.stopPropagation();\n      }}>\n      <button className=\"item\" onClick={() => insertTableRowAtSelection(false)}>\n        <span className=\"text\">\n          Insert{' '}\n          {selectionCounts.rows === 1 ? 'row' : `${selectionCounts.rows} rows`}{' '}\n          above\n        </span>\n      </button>\n      <button className=\"item\" onClick={() => insertTableRowAtSelection(true)}>\n        <span className=\"text\">\n          Insert{' '}\n          {selectionCounts.rows === 1 ? 'row' : `${selectionCounts.rows} rows`}{' '}\n          below\n        </span>\n      </button>\n      <hr />\n      <button\n        className=\"item\"\n        onClick={() => insertTableColumnAtSelection(false)}>\n        <span className=\"text\">\n          Insert{' '}\n          {selectionCounts.columns === 1\n            ? 'column'\n            : `${selectionCounts.columns} columns`}{' '}\n          left\n        </span>\n      </button>\n      <button\n        className=\"item\"\n        onClick={() => insertTableColumnAtSelection(true)}>\n        <span className=\"text\">\n          Insert{' '}\n          {selectionCounts.columns === 1\n            ? 'column'\n            : `${selectionCounts.columns} columns`}{' '}\n          right\n        </span>\n      </button>\n      <hr />\n      <button className=\"item\" onClick={() => deleteTableColumnAtSelection()}>\n        <span className=\"text\">Delete column</span>\n      </button>\n      <button className=\"item\" onClick={() => deleteTableRowAtSelection()}>\n        <span className=\"text\">Delete row</span>\n      </button>\n      <button className=\"item\" onClick={() => deleteTableAtSelection()}>\n        <span className=\"text\">Delete table</span>\n      </button>\n      <hr />\n      <button className=\"item\" onClick={() => toggleTableRowIsHeader()}>\n        <span className=\"text\">\n          {(tableCellNode.__headerState & TableCellHeaderStates.ROW) ===\n          TableCellHeaderStates.ROW\n            ? 'Remove'\n            : 'Add'}{' '}\n          row header\n        </span>\n      </button>\n      <button className=\"item\" onClick={() => toggleTableColumnIsHeader()}>\n        <span className=\"text\">\n          {(tableCellNode.__headerState & TableCellHeaderStates.COLUMN) ===\n          TableCellHeaderStates.COLUMN\n            ? 'Remove'\n            : 'Add'}{' '}\n          column header\n        </span>\n      </button>\n    </div>,\n    document.body,\n  );\n}\n\nfunction TableCellActionMenuContainer(): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n\n  const menuButtonRef = useRef(null);\n  const menuRootRef = useRef(null);\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\n\n  const [tableCellNode, setTableMenuCellNode] = useState<TableCellNode | null>(\n    null,\n  );\n\n  const moveMenu = useCallback(() => {\n    const menu = menuButtonRef.current;\n    const selection = $getSelection();\n    const nativeSelection = window.getSelection();\n    const activeElement = document.activeElement;\n\n    if (selection == null || menu == null) {\n      setTableMenuCellNode(null);\n      return;\n    }\n\n    const rootElement = editor.getRootElement();\n\n    if (\n      $isRangeSelection(selection) &&\n      rootElement !== null &&\n      nativeSelection !== null &&\n      rootElement.contains(nativeSelection.anchorNode)\n    ) {\n      const tableCellNodeFromSelection = $getTableCellNodeFromLexicalNode(\n        selection.anchor.getNode(),\n      );\n\n      if (tableCellNodeFromSelection == null) {\n        setTableMenuCellNode(null);\n        return;\n      }\n\n      const tableCellParentNodeDOM = editor.getElementByKey(\n        tableCellNodeFromSelection.getKey(),\n      );\n\n      if (tableCellParentNodeDOM == null) {\n        setTableMenuCellNode(null);\n        return;\n      }\n\n      setTableMenuCellNode(tableCellNodeFromSelection);\n    } else if (!activeElement) {\n      setTableMenuCellNode(null);\n    }\n  }, [editor]);\n\n  useEffect(() => {\n    return editor.registerUpdateListener(() => {\n      editor.getEditorState().read(() => {\n        moveMenu();\n      });\n    });\n  });\n\n  useEffect(() => {\n    const menuButtonDOM = menuButtonRef.current as HTMLButtonElement | null;\n\n    if (menuButtonDOM != null && tableCellNode != null) {\n      const tableCellNodeDOM = editor.getElementByKey(tableCellNode.getKey());\n\n      if (tableCellNodeDOM != null) {\n        const tableCellRect = tableCellNodeDOM.getBoundingClientRect();\n        const menuRect = menuButtonDOM.getBoundingClientRect();\n\n        menuButtonDOM.style.opacity = '1';\n\n        menuButtonDOM.style.left = `${\n          tableCellRect.left +\n          window.pageXOffset -\n          menuRect.width +\n          tableCellRect.width -\n          10\n        }px`;\n\n        menuButtonDOM.style.top = `${\n          tableCellRect.top + window.pageYOffset + 5\n        }px`;\n      } else {\n        menuButtonDOM.style.opacity = '0';\n      }\n    }\n  }, [menuButtonRef, tableCellNode, editor]);\n\n  const prevTableCellDOM = useRef(tableCellNode);\n\n  useEffect(() => {\n    if (prevTableCellDOM.current !== tableCellNode) {\n      setIsMenuOpen(false);\n    }\n\n    prevTableCellDOM.current = tableCellNode;\n  }, [prevTableCellDOM, tableCellNode]);\n\n  return (\n    <div className=\"table-cell-action-button-container\" ref={menuButtonRef}>\n      {tableCellNode != null && (\n        <>\n          <button\n            className=\"table-cell-action-button chevron-down\"\n            onClick={(e) => {\n              e.stopPropagation();\n              setIsMenuOpen(!isMenuOpen);\n            }}\n            ref={menuRootRef}>\n            <i className=\"chevron-down\" />\n          </button>\n          {isMenuOpen && (\n            <TableActionMenu\n              contextRef={menuRootRef}\n              setIsMenuOpen={setIsMenuOpen}\n              onClose={() => setIsMenuOpen(false)}\n              tableCellNode={tableCellNode}\n            />\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default function TableActionMenuPlugin(): ReactPortal {\n  return createPortal(<TableCellActionMenuContainer />, document.body);\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  DOMConversionMap,\n  DOMConversionOutput,\n  DOMExportOutput,\n  EditorConfig,\n  GridSelection,\n  LexicalEditor,\n  LexicalNode,\n  NodeKey,\n  NodeSelection,\n  RangeSelection,\n  SerializedEditor,\n  SerializedLexicalNode,\n  Spread,\n} from 'lexical';\n\n// import './ImageNode.css';\n\nimport {\n  CollaborationPlugin,\n} from '@lexical/react/LexicalCollaborationPlugin';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {HashtagPlugin} from '@lexical/react/LexicalHashtagPlugin';\nimport {HistoryPlugin} from '@lexical/react/LexicalHistoryPlugin';\nimport {LinkPlugin} from '@lexical/react/LexicalLinkPlugin';\nimport {LexicalNestedComposer} from '@lexical/react/LexicalNestedComposer';\nimport {RichTextPlugin} from '@lexical/react/LexicalRichTextPlugin';\nimport {TablePlugin} from '@lexical/react/LexicalTablePlugin';\nimport {useLexicalNodeSelection} from '@lexical/react/useLexicalNodeSelection';\nimport {mergeRegister} from '@lexical/utils';\nimport {\n  $getNodeByKey,\n  $getSelection,\n  $isNodeSelection,\n  CLICK_COMMAND,\n  COMMAND_PRIORITY_LOW,\n  createEditor,\n  DecoratorNode,\n  KEY_BACKSPACE_COMMAND,\n  KEY_DELETE_COMMAND,\n} from 'lexical';\nimport * as React from 'react';\nimport {Suspense, useCallback, useEffect, useRef, useState} from 'react';\n\nimport {createWebsocketProvider} from '../collaboration';\nimport {useSettings} from '../context/SettingsContext';\nimport {useSharedHistoryContext} from '../context/SharedHistoryContext';\nimport EmojisPlugin from '../plugins/EmojisPlugin';\nimport ImagesPlugin from '../plugins/ImagesPlugin';\nimport KeywordsPlugin from '../plugins/KeywordsPlugin';\nimport MentionsPlugin from '../plugins/MentionsPlugin';\nimport TableCellActionMenuPlugin from '../plugins/TableActionMenuPlugin';\n// import TreeViewPlugin from '../plugins/TreeViewPlugin';\nimport ContentEditable from '../ui/ContentEditable';\nimport ImageResizer from '../ui/ImageResizer';\nimport Placeholder from '../ui/Placeholder';\n\nexport interface ImagePayload {\n  altText: string;\n  caption?: LexicalEditor;\n  height?: number;\n  key?: NodeKey;\n  maxWidth?: number;\n  showCaption?: boolean;\n  src: string;\n  width?: number;\n}\n\nconst imageCache = new Set();\n\nfunction useSuspenseImage(src: string) {\n  if (!imageCache.has(src)) {\n    throw new Promise((resolve) => {\n      const img = new Image();\n      img.src = src;\n      img.onload = () => {\n        imageCache.add(src);\n        resolve(null);\n      };\n    });\n  }\n}\n\nfunction convertImageElement(domNode: Node): null | DOMConversionOutput {\n  if (domNode instanceof HTMLImageElement) {\n    const {alt: altText, src} = domNode;\n    const node = $createImageNode({altText, src});\n    return {node};\n  }\n  return null;\n}\n\nfunction LazyImage({\n  altText,\n  className,\n  imageRef,\n  src,\n  width,\n  height,\n  maxWidth,\n}: {\n  altText: string;\n  className: string | null;\n  height: 'inherit' | number;\n  imageRef: {current: null | HTMLImageElement};\n  maxWidth: number;\n  src: string;\n  width: 'inherit' | number;\n}): JSX.Element {\n  useSuspenseImage(src);\n  return (\n    <img\n      className={className || undefined}\n      src={src}\n      alt={altText}\n      ref={imageRef}\n      style={{\n        height,\n        maxWidth,\n        width,\n      }}\n      draggable=\"false\"\n    />\n  );\n}\n\nfunction ImageComponent({\n  src,\n  altText,\n  nodeKey,\n  width,\n  height,\n  maxWidth,\n  resizable,\n  showCaption,\n  caption,\n}: {\n  altText: string;\n  caption: LexicalEditor;\n  height: 'inherit' | number;\n  maxWidth: number;\n  nodeKey: NodeKey;\n  resizable: boolean;\n  showCaption: boolean;\n  src: string;\n  width: 'inherit' | number;\n}): JSX.Element {\n  const ref = useRef(null);\n  const [isSelected, setSelected, clearSelection] =\n    useLexicalNodeSelection(nodeKey);\n  const [isResizing, setIsResizing] = useState<boolean>(false);\n  // const {yjsDocMap} = useCollaborationContext();\n  const [editor] = useLexicalComposerContext();\n  // const isCollab = yjsDocMap.get('main') !== undefined;\n  const [selection, setSelection] = useState<\n    RangeSelection | NodeSelection | GridSelection | null\n  >(null);\n\n  const onDelete = useCallback(\n    (payload: KeyboardEvent) => {\n      if (isSelected && $isNodeSelection($getSelection())) {\n        const event: KeyboardEvent = payload;\n        event.preventDefault();\n        const node = $getNodeByKey(nodeKey);\n        if ($isImageNode(node)) {\n          node.remove();\n        }\n        setSelected(false);\n      }\n      return false;\n    },\n    [isSelected, nodeKey, setSelected],\n  );\n\n  useEffect(() => {\n    return mergeRegister(\n      // editor.registerUpdateListener(({editorState}) => {\n      //   setSelection(editorState.read(() => $getSelection()));\n      // }),\n      editor.registerCommand<MouseEvent>(\n        CLICK_COMMAND,\n        (payload) => {\n          const event = payload;\n\n          if (isResizing) {\n            return true;\n          }\n          if (event.target === ref.current) {\n            if (!event.shiftKey) {\n              clearSelection();\n            }\n            setSelected(!isSelected);\n            return true;\n          }\n\n          return false;\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand(\n        KEY_DELETE_COMMAND,\n        onDelete,\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand(\n        KEY_BACKSPACE_COMMAND,\n        onDelete,\n        COMMAND_PRIORITY_LOW,\n      ),\n    );\n  }, [\n    clearSelection,\n    editor,\n    isResizing,\n    isSelected,\n    nodeKey,\n    onDelete,\n    setSelected,\n  ]);\n\n  const setShowCaption = () => {\n    editor.update(() => {\n      const node = $getNodeByKey(nodeKey);\n      if ($isImageNode(node)) {\n        node.setShowCaption(true);\n      }\n    });\n  };\n\n  const onResizeEnd = (\n    nextWidth: 'inherit' | number,\n    nextHeight: 'inherit' | number,\n  ) => {\n    // Delay hiding the resize bars for click case\n    setTimeout(() => {\n      setIsResizing(false);\n    }, 200);\n\n    editor.update(() => {\n      const node = $getNodeByKey(nodeKey);\n      if ($isImageNode(node)) {\n        node.setWidthAndHeight(nextWidth, nextHeight);\n      }\n    });\n  };\n\n  const onResizeStart = () => {\n    setIsResizing(true);\n  };\n\n  const {historyState} = useSharedHistoryContext();\n  const {\n    settings: {showNestedEditorTreeView},\n  } = useSettings();\n\n  const draggable = isSelected && $isNodeSelection(selection);\n  const isFocused = $isNodeSelection(selection) && (isSelected || isResizing);\n\n  return (\n    <Suspense fallback={null}>\n      <>\n        <div draggable={draggable}>\n          <LazyImage\n            className={isFocused ? 'focused' : null}\n            src={src}\n            altText={altText}\n            imageRef={ref}\n            width={width}\n            height={height}\n            maxWidth={maxWidth}\n          />\n        </div>\n        {showCaption && (\n          <div className=\"image-caption-container\">\n            <LexicalNestedComposer initialEditor={caption}>\n              <MentionsPlugin />\n              <TablePlugin />\n              <TableCellActionMenuPlugin />\n              <ImagesPlugin />\n              <LinkPlugin />\n              <EmojisPlugin />\n              <HashtagPlugin />\n              <KeywordsPlugin />\n              {/* {isCollab ? (\n                <CollaborationPlugin\n                  id={caption.getKey()}\n                  providerFactory={createWebsocketProvider}\n                  shouldBootstrap={true}\n                />\n              ) : (\n                <HistoryPlugin externalHistoryState={historyState} />\n              )} */}\n              {/* <RichTextPlugin\n                contentEditable={\n                  <ContentEditable className=\"ImageNode__contentEditable\" />\n                }\n                placeholder={\n                  <Placeholder className=\"ImageNode__placeholder\">\n                    Enter a caption...\n                  </Placeholder>\n                }\n                // TODO Remove after it's inherited from the parent (LexicalComposer)\n                initialEditorState={null}\n              /> */}\n              {/* {showNestedEditorTreeView === true ? <TreeViewPlugin /> : null} */}\n            </LexicalNestedComposer>\n          </div>\n        )}\n        {resizable && isFocused && (\n          <ImageResizer\n            showCaption={showCaption}\n            setShowCaption={setShowCaption}\n            editor={editor}\n            imageRef={ref}\n            maxWidth={maxWidth}\n            onResizeStart={onResizeStart}\n            onResizeEnd={onResizeEnd}\n          />\n        )}\n      </>\n    </Suspense>\n  );\n}\n\nexport type SerializedImageNode = Spread<\n  {\n    altText: string;\n    caption: SerializedEditor;\n    height?: number;\n    maxWidth: number;\n    showCaption: boolean;\n    src: string;\n    width?: number;\n    type: 'image';\n    version: 1;\n  },\n  SerializedLexicalNode\n>;\n\nexport class ImageNode extends DecoratorNode<JSX.Element> {\n  __src: string;\n  __altText: string;\n  __width: 'inherit' | number;\n  __height: 'inherit' | number;\n  __maxWidth: number;\n  __showCaption: boolean;\n  __caption: LexicalEditor;\n\n  static getType(): string {\n    return 'image';\n  }\n\n  static clone(node: ImageNode): ImageNode {\n    return new ImageNode(\n      node.__src,\n      node.__altText,\n      node.__maxWidth,\n      node.__width,\n      node.__height,\n      node.__showCaption,\n      node.__caption,\n      node.__key,\n    );\n  }\n\n  static importJSON(serializedNode: SerializedImageNode): ImageNode {\n    const {altText, height, width, maxWidth, caption, src, showCaption} =\n      serializedNode;\n    const node = $createImageNode({\n      altText,\n      height,\n      maxWidth,\n      showCaption,\n      src,\n      width,\n    });\n    const nestedEditor = node.__caption;\n    const editorState = nestedEditor.parseEditorState(caption.editorState);\n    if (!editorState.isEmpty()) {\n      nestedEditor.setEditorState(editorState);\n    }\n    return node;\n  }\n\n  exportDOM(): DOMExportOutput {\n    const element = document.createElement('img');\n    element.setAttribute('src', this.__src);\n    element.setAttribute('alt', this.__altText);\n    return {element};\n  }\n\n  static importDOM(): DOMConversionMap | null {\n    return {\n      img: (node: Node) => ({\n        conversion: convertImageElement,\n        priority: 0,\n      }),\n    };\n  }\n\n  constructor(\n    src: string,\n    altText: string,\n    maxWidth: number,\n    width?: 'inherit' | number,\n    height?: 'inherit' | number,\n    showCaption?: boolean,\n    caption?: LexicalEditor,\n    key?: NodeKey,\n  ) {\n    super(key);\n    this.__src = src;\n    this.__altText = altText;\n    this.__maxWidth = maxWidth;\n    this.__width = width || 'inherit';\n    this.__height = height || 'inherit';\n    this.__showCaption = showCaption || false;\n    this.__caption = caption || createEditor();\n  }\n\n  exportJSON(): SerializedImageNode {\n    return {\n      altText: this.getAltText(),\n      caption: this.__caption.toJSON(),\n      height: this.__height === 'inherit' ? 0 : this.__height,\n      maxWidth: this.__maxWidth,\n      showCaption: this.__showCaption,\n      src: this.getSrc(),\n      type: 'image',\n      version: 1,\n      width: this.__width === 'inherit' ? 0 : this.__width,\n    };\n  }\n\n  setWidthAndHeight(\n    width: 'inherit' | number,\n    height: 'inherit' | number,\n  ): void {\n    const writable = this.getWritable();\n    writable.__width = width;\n    writable.__height = height;\n  }\n\n  setShowCaption(showCaption: boolean): void {\n    const writable = this.getWritable();\n    writable.__showCaption = showCaption;\n  }\n\n  // View\n\n  createDOM(config: EditorConfig): HTMLElement {\n    const span = document.createElement('span');\n    const theme = config.theme;\n    const className = theme.image;\n    if (className !== undefined) {\n      span.className = className;\n    }\n    return span;\n  }\n\n  updateDOM(): false {\n    return false;\n  }\n\n  getSrc(): string {\n    return this.__src;\n  }\n\n  getAltText(): string {\n    return this.__altText;\n  }\n\n  decorate(): JSX.Element {\n    return (\n      <ImageComponent\n        src={this.__src}\n        altText={this.__altText}\n        width={this.__width}\n        height={this.__height}\n        maxWidth={this.__maxWidth}\n        nodeKey={this.getKey()}\n        showCaption={this.__showCaption}\n        caption={this.__caption}\n        resizable={true}\n      />\n    );\n  }\n}\n\nexport function $createImageNode({\n  altText,\n  height,\n  maxWidth = 500,\n  src,\n  width,\n  showCaption,\n  caption,\n  key,\n}: ImagePayload): ImageNode {\n  return new ImageNode(\n    src,\n    altText,\n    maxWidth,\n    width,\n    height,\n    showCaption,\n    caption,\n    key,\n  );\n}\n\nexport function $isImageNode(\n  node: LexicalNode | null | undefined,\n): node is ImageNode {\n  return node instanceof ImageNode;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport type {LexicalCommand, LexicalEditor} from 'lexical';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {mergeRegister} from '@lexical/utils';\nimport {\n  $createRangeSelection,\n  $getSelection,\n  $isNodeSelection,\n  $isRangeSelection,\n  $isRootNode,\n  $setSelection,\n  COMMAND_PRIORITY_EDITOR,\n  COMMAND_PRIORITY_HIGH,\n  COMMAND_PRIORITY_LOW,\n  createCommand,\n  DRAGOVER_COMMAND,\n  DRAGSTART_COMMAND,\n  DROP_COMMAND,\n} from 'lexical';\nimport {useEffect} from 'react';\nimport getSelection from '../shared/src/getDOMSelection';\n\nimport {\n  $createImageNode,\n  $isImageNode,\n  ImageNode,\n  ImagePayload,\n} from '../nodes/ImageNode';\n\nexport type InsertImagePayload = Readonly<ImagePayload>;\n\nexport const INSERT_IMAGE_COMMAND: LexicalCommand<InsertImagePayload> =\n  createCommand();\nexport default function ImagesPlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    if (!editor.hasNodes([ImageNode])) {\n      throw new Error('ImagesPlugin: ImageNode not registered on editor');\n    }\n\n    return mergeRegister(\n      editor.registerCommand<InsertImagePayload>(\n        INSERT_IMAGE_COMMAND,\n        (payload) => {\n          const selection = $getSelection();\n          if ($isRangeSelection(selection)) {\n            if ($isRootNode(selection.anchor.getNode())) {\n              selection.insertParagraph();\n            }\n            const imageNode = $createImageNode(payload);\n            selection.insertNodes([imageNode]);\n          }\n          return true;\n        },\n        COMMAND_PRIORITY_EDITOR,\n      ),\n      editor.registerCommand<DragEvent>(\n        DRAGSTART_COMMAND,\n        (event) => {\n          return onDragStart(event);\n        },\n        COMMAND_PRIORITY_HIGH,\n      ),\n      editor.registerCommand<DragEvent>(\n        DRAGOVER_COMMAND,\n        (event) => {\n          return onDragover(event);\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand<DragEvent>(\n        DROP_COMMAND,\n        (event) => {\n          return onDrop(event, editor);\n        },\n        COMMAND_PRIORITY_HIGH,\n      ),\n    );\n  }, [editor]);\n\n  return null;\n}\n\nconst TRANSPARENT_IMAGE =\n  'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\nconst img = document.createElement('img');\nimg.src = TRANSPARENT_IMAGE;\n\nfunction onDragStart(event: DragEvent): boolean {\n  const node = getImageNodeInSelection();\n  if (!node) {\n    return false;\n  }\n  const dataTransfer = event.dataTransfer;\n  if (!dataTransfer) {\n    return false;\n  }\n  dataTransfer.setData('text/plain', '_');\n  dataTransfer.setDragImage(img, 0, 0);\n  dataTransfer.setData(\n    'application/x-lexical-drag',\n    JSON.stringify({\n      data: {\n        altText: node.__altText,\n        caption: node.__caption,\n        height: node.__height,\n        key: node.getKey(),\n        maxWidth: node.__maxWidth,\n        showCaption: node.__showCaption,\n        src: node.__src,\n        width: node.__width,\n      },\n      type: 'image',\n    }),\n  );\n\n  return true;\n}\n\nfunction onDragover(event: DragEvent): boolean {\n  const node = getImageNodeInSelection();\n  if (!node) {\n    return false;\n  }\n  if (!canDropImage(event)) {\n    event.preventDefault();\n  }\n  return true;\n}\n\nfunction onDrop(event: DragEvent, editor: LexicalEditor): boolean {\n  const node = getImageNodeInSelection();\n  if (!node) {\n    return false;\n  }\n  const data = getDragImageData(event);\n  if (!data) {\n    return false;\n  }\n  event.preventDefault();\n  if (canDropImage(event)) {\n    const range = getDragSelection(event);\n    node.remove();\n    const rangeSelection = $createRangeSelection();\n    if (range !== null && range !== undefined) {\n      rangeSelection.applyDOMRange(range);\n    }\n    $setSelection(rangeSelection);\n    editor.dispatchCommand(INSERT_IMAGE_COMMAND, data);\n  }\n  return true;\n}\n\nfunction getImageNodeInSelection(): ImageNode | null {\n  const selection = $getSelection();\n  if (!$isNodeSelection(selection)) {\n    return null;\n  }\n  const nodes = selection.getNodes();\n  const node = nodes[0];\n  return $isImageNode(node) ? node : null;\n}\n\nfunction getDragImageData(event: DragEvent): null | InsertImagePayload {\n  const dragData = event.dataTransfer?.getData('application/x-lexical-drag');\n  if (!dragData) {\n    return null;\n  }\n  const {type, data} = JSON.parse(dragData);\n  if (type !== 'image') {\n    return null;\n  }\n\n  return data;\n}\n\ndeclare global {\n  interface DragEvent {\n    rangeOffset?: number;\n    rangeParent?: Node;\n  }\n}\n\nfunction canDropImage(event: DragEvent): boolean {\n  const target = event.target;\n  return !!(\n    target &&\n    target instanceof HTMLElement &&\n    !target.closest('code, span.editor-image') &&\n    target.parentElement &&\n    target.parentElement.closest('div.ContentEditable__root')\n  );\n}\n\nfunction getDragSelection(event: DragEvent): Range | null | undefined {\n  let range;\n  const domSelection = getSelection();\n  if (document.caretRangeFromPoint) {\n    range = document.caretRangeFromPoint(event.clientX, event.clientY);\n  } else if (event.rangeParent && domSelection !== null) {\n    domSelection.collapse(event.rangeParent, event.rangeOffset || 0);\n    range = domSelection.getRangeAt(0);\n  } else {\n    throw Error(`Cannot get the selection when dragging`);\n  }\n\n  return range;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {RangeSelection} from 'lexical';\n\nimport {$getListDepth, $isListItemNode, $isListNode} from '@lexical/list';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $getSelection,\n  $isElementNode,\n  $isRangeSelection,\n  COMMAND_PRIORITY_CRITICAL,\n  ElementNode,\n  INDENT_CONTENT_COMMAND,\n} from 'lexical';\nimport {useEffect} from 'react';\n\ntype Props = Readonly<{\n  maxDepth: number | null | undefined;\n}>;\n\nfunction getElementNodesInSelection(\n  selection: RangeSelection,\n): Set<ElementNode> {\n  const nodesInSelection = selection.getNodes();\n\n  if (nodesInSelection.length === 0) {\n    return new Set([\n      selection.anchor.getNode().getParentOrThrow(),\n      selection.focus.getNode().getParentOrThrow(),\n    ]);\n  }\n\n  return new Set(\n    nodesInSelection.map((n) => ($isElementNode(n) ? n : n.getParentOrThrow())),\n  );\n}\n\nfunction isIndentPermitted(maxDepth: number): boolean {\n  const selection = $getSelection();\n\n  if (!$isRangeSelection(selection)) {\n    return false;\n  }\n\n  const elementNodesInSelection: Set<ElementNode> =\n    getElementNodesInSelection(selection);\n\n  let totalDepth = 0;\n\n  for (const elementNode of elementNodesInSelection) {\n    if ($isListNode(elementNode)) {\n      totalDepth = Math.max($getListDepth(elementNode) + 1, totalDepth);\n    } else if ($isListItemNode(elementNode)) {\n      const parent = elementNode.getParent();\n\n      if (!$isListNode(parent)) {\n        throw new Error(\n          'ListMaxIndentLevelPlugin: A ListItemNode must have a ListNode for a parent.',\n        );\n      }\n\n      totalDepth = Math.max($getListDepth(parent) + 1, totalDepth);\n    }\n  }\n\n  return totalDepth <= maxDepth;\n}\n\nexport default function ListMaxIndentLevelPlugin({maxDepth}: Props): null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    return editor.registerCommand(\n      INDENT_CONTENT_COMMAND,\n      () => !isIndentPermitted(maxDepth ?? 7),\n      COMMAND_PRIORITY_CRITICAL,\n    );\n  }, [editor, maxDepth]);\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {trimTextContentFromAnchor} from '@lexical/selection';\nimport {$restoreEditorState} from '@lexical/utils';\nimport {$getSelection, $isRangeSelection, EditorState, RootNode} from 'lexical';\nimport {useEffect} from 'react';\n\nexport function MaxLengthPlugin({maxLength}: {maxLength: number}): null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    let lastRestoredEditorState: EditorState | null = null;\n\n    return editor.registerNodeTransform(RootNode, (rootNode: RootNode) => {\n      const selection = $getSelection();\n      if (!$isRangeSelection(selection) || !selection.isCollapsed()) {\n        return;\n      }\n      const prevEditorState = editor.getEditorState();\n      const prevTextContent = prevEditorState.read(() =>\n        rootNode.getTextContent(),\n      );\n      const textContent = rootNode.getTextContent();\n      if (prevTextContent !== textContent) {\n        const textLength = textContent.length;\n        const delCount = textLength - maxLength;\n        const anchor = selection.anchor;\n\n        if (delCount > 0) {\n          // Restore the old editor state instead if the last\n          // text content was already at the limit.\n          if (\n            prevTextContent.length === maxLength &&\n            lastRestoredEditorState !== prevEditorState\n          ) {\n            lastRestoredEditorState = prevEditorState;\n            $restoreEditorState(editor, prevEditorState);\n          } else {\n            trimTextContentFromAnchor(editor, anchor, delCount);\n          }\n        }\n      }\n    });\n  }, [editor, maxLength]);\n\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\n// import './PollNode.css';\n\n// import {useCollaborationContext} from '@lexical/react/LexicalCollaborationPlugin';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {useLexicalNodeSelection} from '@lexical/react/useLexicalNodeSelection';\nimport {mergeRegister} from '@lexical/utils';\nimport {\n  $getNodeByKey,\n  $getSelection,\n  $isNodeSelection,\n  CLICK_COMMAND,\n  COMMAND_PRIORITY_LOW,\n  DecoratorNode,\n  DOMConversionMap,\n  DOMConversionOutput,\n  DOMExportOutput,\n  GridSelection,\n  KEY_BACKSPACE_COMMAND,\n  KEY_DELETE_COMMAND,\n  LexicalNode,\n  NodeKey,\n  NodeSelection,\n  RangeSelection,\n  SerializedLexicalNode,\n  Spread,\n} from 'lexical';\nimport * as React from 'react';\nimport {useCallback, useEffect, useMemo, useRef, useState} from 'react';\n\nimport Button from '../ui/Button';\nimport joinClasses from '../utils/join-classes';\n\ntype Options = ReadonlyArray<Option>;\n\ntype Option = Readonly<{\n  text: string;\n  uid: string;\n  votes: Array<number>;\n}>;\n\nfunction createUID(): string {\n  return Math.random()\n    .toString(36)\n    .replace(/[^a-z]+/g, '')\n    .substr(0, 5);\n}\n\nfunction createPollOption(text = ''): Option {\n  return {\n    text,\n    uid: createUID(),\n    votes: [],\n  };\n}\n\nfunction cloneOption(\n  option: Option,\n  text: string,\n  votes?: Array<number>,\n): Option {\n  return {\n    text,\n    uid: option.uid,\n    votes: votes || Array.from(option.votes),\n  };\n}\n\nfunction getTotalVotes(options: Options): number {\n  return options.reduce((totalVotes, next) => {\n    return totalVotes + next.votes.length;\n  }, 0);\n}\n\nfunction PollOptionComponent({\n  option,\n  index,\n  options,\n  totalVotes,\n  withPollNode,\n}: {\n  index: number;\n  option: Option;\n  options: Options;\n  totalVotes: number;\n  withPollNode: (cb: (pollNode: PollNode) => void) => void;\n}): JSX.Element {\n  // const {clientID} = useCollaborationContext();\n  const checkboxRef = useRef(null);\n  const votesArray = option.votes;\n  // const checkedIndex = votesArray.indexOf(clientID);\n  // const checked = checkedIndex !== -1;\n  const votes = votesArray.length;\n  const text = option.text;\n\n  return (\n    <div className=\"PollNode__optionContainer\">\n      {/* <div\n        className={joinClasses(\n          'PollNode__optionCheckboxWrapper',\n          checked && 'PollNode__optionCheckboxChecked',\n        )}>\n        <input\n          ref={checkboxRef}\n          className=\"PollNode__optionCheckbox\"\n          type=\"checkbox\"\n          onChange={(e) => {\n            withPollNode((node) => {\n              node.toggleVote(option, clientID);\n            });\n          }}\n          checked={checked}\n        />\n      </div> */}\n      <div className=\"PollNode__optionInputWrapper\">\n        <div\n          className=\"PollNode__optionInputVotes\"\n          style={{width: `${votes === 0 ? 0 : (votes / totalVotes) * 100}%`}}\n        />\n        <span className=\"PollNode__optionInputVotesCount\">\n          {votes > 0 && (votes === 1 ? '1 vote' : `${votes} votes`)}\n        </span>\n        <input\n          className=\"PollNode__optionInput\"\n          type=\"text\"\n          value={text}\n          onChange={(e) => {\n            withPollNode((node) => {\n              node.setOptionText(option, e.target.value);\n            });\n          }}\n          placeholder={`Option ${index + 1}`}\n        />\n      </div>\n      <button\n        disabled={options.length < 3}\n        className={joinClasses(\n          'PollNode__optionDelete',\n          options.length < 3 && 'PollNode__optionDeleteDisabled',\n        )}\n        arial-label=\"Remove\"\n        onClick={() => {\n          withPollNode((node) => {\n            node.deleteOption(option);\n          });\n        }}\n      />\n    </div>\n  );\n}\n\nfunction PollComponent({\n  question,\n  options,\n  nodeKey,\n}: {\n  nodeKey: NodeKey;\n  options: Options;\n  question: string;\n}): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n  const totalVotes = useMemo(() => getTotalVotes(options), [options]);\n  const [isSelected, setSelected, clearSelection] =\n    useLexicalNodeSelection(nodeKey);\n  const [selection, setSelection] = useState<\n    RangeSelection | NodeSelection | GridSelection | null\n  >(null);\n  const ref = useRef(null);\n\n  const onDelete = useCallback(\n    (payload: KeyboardEvent) => {\n      if (isSelected && $isNodeSelection($getSelection())) {\n        const event: KeyboardEvent = payload;\n        event.preventDefault();\n        const node = $getNodeByKey(nodeKey);\n        if ($isPollNode(node)) {\n          node.remove();\n        }\n        setSelected(false);\n      }\n      return false;\n    },\n    [isSelected, nodeKey, setSelected],\n  );\n\n  useEffect(() => {\n    return mergeRegister(\n      // editor.registerUpdateListener(({editorState}) => {\n      //   setSelection(editorState.read(() => $getSelection()));\n      // }),\n      editor.registerCommand<MouseEvent>(\n        CLICK_COMMAND,\n        (payload) => {\n          const event = payload;\n\n          if (event.target === ref.current) {\n            if (!event.shiftKey) {\n              clearSelection();\n            }\n            setSelected(!isSelected);\n            return true;\n          }\n\n          return false;\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand(\n        KEY_DELETE_COMMAND,\n        onDelete,\n        COMMAND_PRIORITY_LOW,\n      ),\n      editor.registerCommand(\n        KEY_BACKSPACE_COMMAND,\n        onDelete,\n        COMMAND_PRIORITY_LOW,\n      ),\n    );\n  }, [clearSelection, editor, isSelected, nodeKey, onDelete, setSelected]);\n\n  const withPollNode = (cb: (node: PollNode) => void): void => {\n    editor.update(() => {\n      const node = $getNodeByKey(nodeKey);\n      if ($isPollNode(node)) {\n        cb(node);\n      }\n    });\n  };\n\n  const addOption = () => {\n    withPollNode((node) => {\n      node.addOption(createPollOption());\n    });\n  };\n\n  const isFocused = $isNodeSelection(selection) && isSelected;\n\n  return (\n    <div\n      className={`PollNode__container ${isFocused ? 'focused' : ''}`}\n      ref={ref}>\n      <div className=\"PollNode__inner\">\n        <h2 className=\"PollNode__heading\">{question}</h2>\n        {options.map((option, index) => {\n          const key = option.uid;\n          return (\n            <PollOptionComponent\n              key={key}\n              withPollNode={withPollNode}\n              option={option}\n              index={index}\n              options={options}\n              totalVotes={totalVotes}\n            />\n          );\n        })}\n        <div className=\"PollNode__footer\">\n          <Button onClick={addOption} small={true}>\n            Add Option\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport type SerializedPollNode = Spread<\n  {\n    question: string;\n    options: Options;\n    type: 'poll';\n    version: 1;\n  },\n  SerializedLexicalNode\n>;\n\nfunction convertPollElement(domNode: HTMLElement): DOMConversionOutput | null {\n  const question = domNode.getAttribute('data-lexical-poll-question');\n  if (question !== null) {\n    const node = $createPollNode(question);\n    return {node};\n  }\n  return null;\n}\n\nexport class PollNode extends DecoratorNode<JSX.Element> {\n  __question: string;\n  __options: Options;\n\n  static getType(): string {\n    return 'poll';\n  }\n\n  static clone(node: PollNode): PollNode {\n    return new PollNode(node.__question, node.__options, node.__key);\n  }\n\n  static importJSON(serializedNode: SerializedPollNode): PollNode {\n    const node = $createPollNode(serializedNode.question);\n    serializedNode.options.forEach(node.addOption);\n    return node;\n  }\n\n  constructor(question: string, options?: Options, key?: NodeKey) {\n    super(key);\n    this.__question = question;\n    this.__options = options || [createPollOption(), createPollOption()];\n  }\n\n  exportJSON(): SerializedPollNode {\n    return {\n      options: this.__options,\n      question: this.__question,\n      type: 'poll',\n      version: 1,\n    };\n  }\n\n  addOption(option: Option): void {\n    const self = this.getWritable();\n    const options = Array.from(self.__options);\n    options.push(option);\n    self.__options = options;\n  }\n\n  deleteOption(option: Option): void {\n    const self = this.getWritable();\n    const options = Array.from(self.__options);\n    const index = options.indexOf(option);\n    options.splice(index, 1);\n    self.__options = options;\n  }\n\n  setOptionText(option: Option, text: string): void {\n    const self = this.getWritable();\n    const clonedOption = cloneOption(option, text);\n    const options = Array.from(self.__options);\n    const index = options.indexOf(option);\n    options[index] = clonedOption;\n    self.__options = options;\n  }\n\n  toggleVote(option: Option, clientID: number): void {\n    const self = this.getWritable();\n    const votes = option.votes;\n    const votesClone = Array.from(votes);\n    const voteIndex = votes.indexOf(clientID);\n    if (voteIndex === -1) {\n      votesClone.push(clientID);\n    } else {\n      votesClone.splice(voteIndex, 1);\n    }\n    const clonedOption = cloneOption(option, option.text, votesClone);\n    const options = Array.from(self.__options);\n    const index = options.indexOf(option);\n    options[index] = clonedOption;\n    self.__options = options;\n  }\n\n  static importDOM(): DOMConversionMap | null {\n    return {\n      span: (domNode: HTMLElement) => {\n        if (!domNode.hasAttribute('data-lexical-poll-question')) {\n          return null;\n        }\n        return {\n          conversion: convertPollElement,\n          priority: 2,\n        };\n      },\n    };\n  }\n\n  exportDOM(): DOMExportOutput {\n    const element = document.createElement('span');\n    element.setAttribute('data-lexical-poll-question', this.__question);\n    return {element};\n  }\n\n  createDOM(): HTMLElement {\n    const elem = document.createElement('span');\n    elem.style.display = 'inline-block';\n    return elem;\n  }\n\n  updateDOM(): false {\n    return false;\n  }\n\n  decorate(): JSX.Element {\n    return (\n      <PollComponent\n        question={this.__question}\n        options={this.__options}\n        nodeKey={this.__key}\n      />\n    );\n  }\n}\n\nexport function $createPollNode(question: string): PollNode {\n  return new PollNode(question);\n}\n\nexport function $isPollNode(\n  node: LexicalNode | null | undefined,\n): node is PollNode {\n  return node instanceof PollNode;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {LexicalCommand} from 'lexical';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $getSelection,\n  $isRangeSelection,\n  $isRootNode,\n  COMMAND_PRIORITY_EDITOR,\n  createCommand,\n} from 'lexical';\nimport {useEffect} from 'react';\n\nimport {$createPollNode, PollNode} from '../nodes/PollNode';\n\nexport const INSERT_POLL_COMMAND: LexicalCommand<string> = createCommand();\n\nexport default function PollPlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n  useEffect(() => {\n    if (!editor.hasNodes([PollNode])) {\n      throw new Error('PollPlugin: PollNode not registered on editor');\n    }\n\n    return editor.registerCommand<string>(\n      INSERT_POLL_COMMAND,\n      (payload) => {\n        const selection = $getSelection();\n\n        if ($isRangeSelection(selection)) {\n          const question = payload;\n          const pollNode = $createPollNode(question);\n\n          if ($isRootNode(selection.anchor.getNode())) {\n            selection.insertParagraph();\n          }\n\n          selection.insertNodes([pollNode]);\n        }\n\n        return true;\n      },\n      COMMAND_PRIORITY_EDITOR,\n    );\n  }, [editor]);\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useCallback, useEffect, useRef} from 'react';\n\nconst getElement = (): HTMLElement => {\n  let element = document.getElementById('report-container');\n\n  if (element === null) {\n    element = document.createElement('div');\n    element.id = 'report-container';\n    element.style.position = 'fixed';\n    element.style.top = '50%';\n    element.style.left = '50%';\n    element.style.fontSize = '32px';\n    element.style.transform = 'translate(-50%, -50px)';\n    element.style.padding = '20px';\n    element.style.background = 'rgba(240, 240, 240, 0.4)';\n    element.style.borderRadius = '20px';\n\n    if (document.body) {\n      document.body.appendChild(element);\n    }\n  }\n\n  return element;\n};\n\nexport default function useReport(): (arg0: string) => NodeJS.Timeout {\n  const timer = useRef<NodeJS.Timeout | null>(null);\n  const cleanup = useCallback(() => {\n    if (timer !== null) {\n      clearTimeout(timer.current as NodeJS.Timeout);\n    }\n\n    if (document.body) {\n      document.body.removeChild(getElement());\n    }\n  }, []);\n\n  useEffect(() => {\n    return cleanup;\n  }, [cleanup]);\n\n  return useCallback(\n    (content) => {\n      // eslint-disable-next-line no-console\n      console.log(content);\n      const element = getElement();\n      clearTimeout(timer.current as NodeJS.Timeout);\n      element.innerHTML = content;\n      timer.current = setTimeout(cleanup, 1000);\n      return timer.current;\n    },\n    [cleanup],\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {LexicalCommand, LexicalEditor, RangeSelection} from 'lexical';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $getSelection,\n  $isRangeSelection,\n  COMMAND_PRIORITY_EDITOR,\n  createCommand,\n  REDO_COMMAND,\n  UNDO_COMMAND,\n} from 'lexical';\nimport {useEffect, useRef, useState} from 'react';\n\nimport useReport from '../hooks/useReport';\n\nexport const SPEECH_TO_TEXT_COMMAND: LexicalCommand<boolean> = createCommand();\n\nconst VOICE_COMMANDS: Readonly<\n  Record<\n    string,\n    (arg0: {editor: LexicalEditor; selection: RangeSelection}) => void\n  >\n> = {\n  '\\n': ({selection}) => {\n    selection.insertParagraph();\n  },\n  redo: ({editor}) => {\n    editor.dispatchCommand(REDO_COMMAND, undefined);\n  },\n  undo: ({editor}) => {\n    editor.dispatchCommand(UNDO_COMMAND, undefined);\n  },\n};\n\nexport const SUPPORT_SPEECH_RECOGNITION: boolean =\n  'SpeechRecognition' in window || 'webkitSpeechRecognition' in window;\n\nfunction SpeechToTextPlugin(): null {\n  const [editor] = useLexicalComposerContext();\n  const [isEnabled, setIsEnabled] = useState<boolean>(false);\n  const SpeechRecognition =\n    // @ts-ignore\n    window.SpeechRecognition || window.webkitSpeechRecognition;\n  const recognition = useRef<typeof SpeechRecognition | null>(null);\n  const report = useReport();\n\n  useEffect(() => {\n    if (isEnabled && recognition.current === null) {\n      recognition.current = new SpeechRecognition();\n      recognition.current.continuous = true;\n      recognition.current.interimResults = true;\n      recognition.current.addEventListener(\n        'result',\n        (event: typeof SpeechRecognition) => {\n          const resultItem = event.results.item(event.resultIndex);\n          const {transcript} = resultItem.item(0);\n          report(transcript);\n\n          if (!resultItem.isFinal) {\n            return;\n          }\n\n          editor.update(() => {\n            const selection = $getSelection();\n\n            if ($isRangeSelection(selection)) {\n              const command = VOICE_COMMANDS[transcript.toLowerCase().trim()];\n\n              if (command) {\n                command({\n                  editor,\n                  selection,\n                });\n              } else if (transcript.match(/\\s*\\n\\s*/)) {\n                selection.insertParagraph();\n              } else {\n                selection.insertText(transcript);\n              }\n            }\n          });\n        },\n      );\n    }\n\n    if (recognition.current) {\n      if (isEnabled) {\n        recognition.current.start();\n      } else {\n        recognition.current.stop();\n      }\n    }\n\n    return () => {\n      if (recognition.current !== null) {\n        recognition.current.stop();\n      }\n    };\n  }, [SpeechRecognition, editor, isEnabled, report]);\n  useEffect(() => {\n    return editor.registerCommand(\n      SPEECH_TO_TEXT_COMMAND,\n      (_isEnabled: boolean) => {\n        setIsEnabled(_isEnabled);\n        return true;\n      },\n      COMMAND_PRIORITY_EDITOR,\n    );\n  }, [editor]);\n\n  return null;\n}\n\nexport default (SUPPORT_SPEECH_RECOGNITION\n  ? SpeechToTextPlugin\n  : () => null) as () => null;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $getSelection,\n  $isRangeSelection,\n  $setSelection,\n  FOCUS_COMMAND,\n} from 'lexical';\nimport {useEffect} from 'react';\n\nconst COMMAND_PRIORITY_LOW = 1;\nconst TAB_TO_FOCUS_INTERVAL = 100;\n\nlet lastTabKeyDownTimestamp = 0;\nlet hasRegisteredKeyDownListener = false;\n\nfunction registerKeyTimeStampTracker() {\n  window.addEventListener(\n    'keydown',\n    (event: KeyboardEvent) => {\n      // Tab\n      if (event.keyCode === 9) {\n        lastTabKeyDownTimestamp = event.timeStamp;\n      }\n    },\n    true,\n  );\n}\n\nexport default function TabFocusPlugin(): null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    if (!hasRegisteredKeyDownListener) {\n      registerKeyTimeStampTracker();\n      hasRegisteredKeyDownListener = true;\n    }\n\n    return editor.registerCommand(\n      FOCUS_COMMAND,\n      (event: FocusEvent) => {\n        const selection = $getSelection();\n        if ($isRangeSelection(selection)) {\n          if (\n            lastTabKeyDownTimestamp + TAB_TO_FOCUS_INTERVAL >\n            event.timeStamp\n          ) {\n            $setSelection(selection.clone());\n          }\n        }\n        return false;\n      },\n      COMMAND_PRIORITY_LOW,\n    );\n  }, [editor]);\n\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport type {Cell} from '@lexical/table';\nimport type {LexicalEditor} from 'lexical';\n\n// import './TableCellResizer.css';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $getTableColumnIndexFromTableCellNode,\n  $getTableNodeFromLexicalNodeOrThrow,\n  $getTableRowIndexFromTableCellNode,\n  $isTableCellNode,\n  $isTableRowNode,\n  getCellFromTarget,\n} from '@lexical/table';\nimport {\n  $getNearestNodeFromDOMNode,\n  $getSelection,\n  // $isGridSelection,\n  COMMAND_PRIORITY_HIGH,\n  SELECTION_CHANGE_COMMAND,\n} from 'lexical';\nimport * as React from 'react';\nimport {\n  MouseEventHandler,\n  ReactPortal,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport {createPortal} from 'react-dom';\n\ntype MousePosition = {\n  x: number;\n  y: number;\n};\n\ntype MouseDraggingDirection = 'right' | 'bottom';\n\nconst MIN_ROW_HEIGHT = 33;\nconst MIN_COLUMN_WIDTH = 50;\n\nfunction TableCellResizer({editor}: {editor: LexicalEditor}): JSX.Element {\n  const targetRef = useRef<HTMLElement | null>(null);\n  const resizerRef = useRef<HTMLDivElement | null>(null);\n  const tableRectRef = useRef<ClientRect | null>(null);\n\n  const mouseStartPosRef = useRef<MousePosition | null>(null);\n  const [mouseCurrentPos, updateMouseCurrentPos] =\n    useState<MousePosition | null>(null);\n\n  const [activeCell, updateActiveCell] = useState<Cell | null>(null);\n  const [isSelectingGrid, updateIsSelectingGrid] = useState<boolean>(false);\n  const [draggingDirection, updateDraggingDirection] =\n    useState<MouseDraggingDirection | null>(null);\n\n  useEffect(() => {\n    return editor.registerCommand(\n      SELECTION_CHANGE_COMMAND,\n      (payload) => {\n        const selection = $getSelection();\n        // const isGridSelection = $isGridSelection(selection);\n\n        // if (isSelectingGrid !== isGridSelection) {\n        //   updateIsSelectingGrid(isGridSelection);\n        // }\n\n        return false;\n      },\n      COMMAND_PRIORITY_HIGH,\n    );\n  });\n\n  const resetState = useCallback(() => {\n    updateActiveCell(null);\n    targetRef.current = null;\n    updateDraggingDirection(null);\n    mouseStartPosRef.current = null;\n    tableRectRef.current = null;\n  }, []);\n\n  useEffect(() => {\n    const onMouseMove = (event: MouseEvent) => {\n      setTimeout(() => {\n        const target = event.target;\n\n        if (draggingDirection) {\n          updateMouseCurrentPos({\n            x: event.clientX,\n            y: event.clientY,\n          });\n          return;\n        }\n\n        if (resizerRef.current && resizerRef.current.contains(target as Node)) {\n          return;\n        }\n\n        if (targetRef.current !== target) {\n          targetRef.current = target as HTMLElement;\n          const cell = getCellFromTarget(target as HTMLElement);\n\n          if (cell && activeCell !== cell) {\n            editor.update(() => {\n              const tableCellNode = $getNearestNodeFromDOMNode(cell.elem);\n              if (!tableCellNode) {\n                throw new Error('TableCellResizer: Table cell node not found.');\n              }\n\n              const tableNode =\n                $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n              const tableElement = editor.getElementByKey(tableNode.getKey());\n\n              if (!tableElement) {\n                throw new Error('TableCellResizer: Table element not found.');\n              }\n\n              targetRef.current = target as HTMLElement;\n              tableRectRef.current = tableElement.getBoundingClientRect();\n              updateActiveCell(cell);\n            });\n          } else if (cell == null) {\n            resetState();\n          }\n        }\n      }, 0);\n    };\n\n    document.addEventListener('mousemove', onMouseMove);\n\n    return () => {\n      document.removeEventListener('mousemove', onMouseMove);\n    };\n  }, [activeCell, draggingDirection, editor, resetState]);\n\n  const isHeightChanging = (direction: MouseDraggingDirection) => {\n    if (direction === 'bottom') return true;\n    return false;\n  };\n\n  const updateRowHeight = useCallback(\n    (newHeight: number) => {\n      if (!activeCell) {\n        throw new Error('TableCellResizer: Expected active cell.');\n      }\n\n      editor.update(() => {\n        const tableCellNode = $getNearestNodeFromDOMNode(activeCell.elem);\n        if (!$isTableCellNode(tableCellNode)) {\n          throw new Error('TableCellResizer: Table cell node not found.');\n        }\n\n        const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n        const tableRowIndex = $getTableRowIndexFromTableCellNode(tableCellNode);\n\n        const tableRows = tableNode.getChildren();\n\n        if (tableRowIndex >= tableRows.length || tableRowIndex < 0) {\n          throw new Error('Expected table cell to be inside of table row.');\n        }\n\n        const tableRow = tableRows[tableRowIndex];\n\n        if (!$isTableRowNode(tableRow)) {\n          throw new Error('Expected table row');\n        }\n\n        tableRow.setHeight(newHeight);\n      });\n    },\n    [activeCell, editor],\n  );\n\n  const updateColumnWidth = useCallback(\n    (newWidth: number) => {\n      if (!activeCell) {\n        throw new Error('TableCellResizer: Expected active cell.');\n      }\n      editor.update(() => {\n        const tableCellNode = $getNearestNodeFromDOMNode(activeCell.elem);\n        if (!$isTableCellNode(tableCellNode)) {\n          throw new Error('TableCellResizer: Table cell node not found.');\n        }\n\n        const tableNode = $getTableNodeFromLexicalNodeOrThrow(tableCellNode);\n\n        const tableColumnIndex =\n          $getTableColumnIndexFromTableCellNode(tableCellNode);\n\n        const tableRows = tableNode.getChildren();\n\n        for (let r = 0; r < tableRows.length; r++) {\n          const tableRow = tableRows[r];\n\n          if (!$isTableRowNode(tableRow)) {\n            throw new Error('Expected table row');\n          }\n\n          const tableCells = tableRow.getChildren();\n\n          if (tableColumnIndex >= tableCells.length || tableColumnIndex < 0) {\n            throw new Error('Expected table cell to be inside of table row.');\n          }\n\n          const tableCell = tableCells[tableColumnIndex];\n\n          if (!$isTableCellNode(tableCell)) {\n            throw new Error('Expected table cell');\n          }\n\n          tableCell.setWidth(newWidth);\n        }\n      });\n    },\n    [activeCell, editor],\n  );\n\n  const toggleResize = useCallback(\n    (direction: MouseDraggingDirection): MouseEventHandler<HTMLDivElement> =>\n      (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        if (!activeCell) {\n          throw new Error('TableCellResizer: Expected active cell.');\n        }\n\n        if (draggingDirection === direction && mouseStartPosRef.current) {\n          const {x, y} = mouseStartPosRef.current;\n\n          if (activeCell === null) {\n            return;\n          }\n\n          const {height, width} = activeCell.elem.getBoundingClientRect();\n\n          if (isHeightChanging(direction)) {\n            const heightChange = Math.abs(event.clientY - y);\n\n            const isShrinking = direction === 'bottom' && y > event.clientY;\n\n            updateRowHeight(\n              Math.max(\n                isShrinking ? height - heightChange : heightChange + height,\n                MIN_ROW_HEIGHT,\n              ),\n            );\n          } else {\n            const widthChange = Math.abs(event.clientX - x);\n\n            const isShrinking = direction === 'right' && x > event.clientX;\n\n            updateColumnWidth(\n              Math.max(\n                isShrinking ? width - widthChange : widthChange + width,\n                MIN_COLUMN_WIDTH,\n              ),\n            );\n          }\n\n          resetState();\n        } else {\n          mouseStartPosRef.current = {\n            x: event.clientX,\n            y: event.clientY,\n          };\n          updateMouseCurrentPos(mouseStartPosRef.current);\n          updateDraggingDirection(direction);\n        }\n      },\n    [\n      activeCell,\n      draggingDirection,\n      resetState,\n      updateColumnWidth,\n      updateRowHeight,\n    ],\n  );\n\n  const getResizers = useCallback(() => {\n    if (activeCell) {\n      const {height, width, top, left} =\n        activeCell.elem.getBoundingClientRect();\n\n      const styles = {\n        bottom: {\n          backgroundColor: 'none',\n          cursor: 'row-resize',\n          height: '10px',\n          left: `${window.pageXOffset + left}px`,\n          top: `${window.pageYOffset + top + height}px`,\n          width: `${width}px`,\n        },\n        right: {\n          backgroundColor: 'none',\n          cursor: 'col-resize',\n          height: `${height}px`,\n          left: `${window.pageXOffset + left + width}px`,\n          top: `${window.pageYOffset + top}px`,\n          width: '10px',\n        },\n      };\n\n      const tableRect = tableRectRef.current;\n\n      if (draggingDirection && mouseCurrentPos && tableRect) {\n        if (isHeightChanging(draggingDirection)) {\n          styles[draggingDirection].left = `${\n            window.pageXOffset + tableRect.left\n          }px`;\n          styles[draggingDirection].top = `${\n            window.pageYOffset + mouseCurrentPos.y\n          }px`;\n          styles[draggingDirection].height = '3px';\n          styles[draggingDirection].width = `${tableRect.width}px`;\n        } else {\n          styles[draggingDirection].top = `${\n            window.pageYOffset + tableRect.top\n          }px`;\n          styles[draggingDirection].left = `${\n            window.pageXOffset + mouseCurrentPos.x\n          }px`;\n          styles[draggingDirection].width = '3px';\n          styles[draggingDirection].height = `${tableRect.height}px`;\n        }\n\n        styles[draggingDirection].backgroundColor = '#adf';\n      }\n\n      return styles;\n    }\n\n    return {\n      bottom: null,\n      left: null,\n      right: null,\n      top: null,\n    };\n  }, [activeCell, draggingDirection, mouseCurrentPos]);\n\n  const resizerStyles = getResizers();\n\n  return (\n    <div ref={resizerRef}>\n      {activeCell != null && !isSelectingGrid && (\n        <>\n          <div\n            className=\"TableCellResizer__resizer TableCellResizer__ui\"\n            style={resizerStyles.right || undefined}\n            onMouseDown={toggleResize('right')}\n            onMouseUp={toggleResize('right')}\n          />\n          <div\n            className=\"TableCellResizer__resizer TableCellResizer__ui\"\n            style={resizerStyles.bottom || undefined}\n            onMouseDown={toggleResize('bottom')}\n            onMouseUp={toggleResize('bottom')}\n          />\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default function TableCellResizerPlugin(): ReactPortal {\n  const [editor] = useLexicalComposerContext();\n\n  return useMemo(\n    () => createPortal(<TableCellResizer editor={editor} />, document.body),\n    [editor],\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {$isCodeHighlightNode} from '@lexical/code';\nimport {$isLinkNode, TOGGLE_LINK_COMMAND} from '@lexical/link';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {$isAtNodeEnd} from '@lexical/selection';\nimport {mergeRegister} from '@lexical/utils';\nimport {\n  $getSelection,\n  $isRangeSelection,\n  $isTextNode,\n  COMMAND_PRIORITY_LOW,\n  ElementNode,\n  FORMAT_TEXT_COMMAND,\n  LexicalEditor,\n  RangeSelection,\n  SELECTION_CHANGE_COMMAND,\n  TextNode,\n} from 'lexical';\nimport {useCallback, useEffect, useRef, useState} from 'react';\nimport * as React from 'react';\nimport {createPortal} from 'react-dom';\n\n// import {INSERT_INLINE_COMMAND} from './CommentPlugin';\n\nfunction setPopupPosition(\n  editor: HTMLElement,\n  rect: ClientRect,\n  rootElementRect: ClientRect,\n): void {\n  let top = rect.top - 8 + window.pageYOffset;\n  let left =\n    rect.left + 340 + window.pageXOffset - editor.offsetWidth + rect.width;\n  if (left + editor.offsetWidth > rootElementRect.right) {\n    left = rect.right - editor.offsetWidth;\n    top = rect.top - 50 + window.pageYOffset;\n  }\n  if (left < 0) {\n    left = rect.left;\n    top = rect.bottom + 20;\n  }\n  if (rect.width >= rootElementRect.width - 25) {\n    left = rect.left;\n    top = rect.top - 50 + window.pageYOffset;\n  }\n  if (top < rootElementRect.top) {\n    top = rect.bottom + 20;\n  }\n  editor.style.opacity = '1';\n  editor.style.top = `${top}px`;\n  editor.style.left = `${left}px`;\n}\n\nfunction TextFormatFloatingToolbar({\n  editor,\n  isLink,\n  isBold,\n  isItalic,\n  isUnderline,\n  isCode,\n  isStrikethrough,\n  isSubscript,\n  isSuperscript,\n}: {\n  editor: LexicalEditor;\n  isBold: boolean;\n  isCode: boolean;\n  isItalic: boolean;\n  isLink: boolean;\n  isStrikethrough: boolean;\n  isSubscript: boolean;\n  isSuperscript: boolean;\n  isUnderline: boolean;\n}): JSX.Element {\n  const popupCharStylesEditorRef = useRef<HTMLDivElement | null>(null);\n\n  const insertLink = useCallback(() => {\n    if (!isLink) {\n      editor.dispatchCommand(TOGGLE_LINK_COMMAND, 'https://');\n    } else {\n      editor.dispatchCommand(TOGGLE_LINK_COMMAND, null);\n    }\n  }, [editor, isLink]);\n\n  // const insertComment = () => {\n  //   editor.dispatchCommand(INSERT_INLINE_COMMAND, null);\n  // };\n\n  const updateTextFormatFloatingToolbar = useCallback(() => {\n    const selection = $getSelection();\n\n    const popupCharStylesEditorElem = popupCharStylesEditorRef.current;\n    const nativeSelection = window.getSelection();\n\n    if (popupCharStylesEditorElem === null) {\n      return;\n    }\n\n    const rootElement = editor.getRootElement();\n    if (\n      selection !== null &&\n      nativeSelection !== null &&\n      !nativeSelection.isCollapsed &&\n      rootElement !== null &&\n      rootElement.contains(nativeSelection.anchorNode)\n    ) {\n      const domRange = nativeSelection.getRangeAt(0);\n      const rootElementRect = rootElement.getBoundingClientRect();\n      let rect;\n\n      if (nativeSelection.anchorNode === rootElement) {\n        let inner = rootElement;\n        while (inner.firstElementChild != null) {\n          inner = inner.firstElementChild as HTMLElement;\n        }\n        rect = inner.getBoundingClientRect();\n      } else {\n        rect = domRange.getBoundingClientRect();\n      }\n\n      setPopupPosition(popupCharStylesEditorElem, rect, rootElementRect);\n    }\n  }, [editor]);\n\n  useEffect(() => {\n    const onResize = () => {\n      editor.getEditorState().read(() => {\n        updateTextFormatFloatingToolbar();\n      });\n    };\n    window.addEventListener('resize', onResize);\n\n    return () => {\n      window.removeEventListener('resize', onResize);\n    };\n  }, [editor, updateTextFormatFloatingToolbar]);\n\n  useEffect(() => {\n    editor.getEditorState().read(() => {\n      updateTextFormatFloatingToolbar();\n    });\n    return mergeRegister(\n      editor.registerUpdateListener(({editorState}) => {\n        editorState.read(() => {\n          updateTextFormatFloatingToolbar();\n        });\n      }),\n\n      editor.registerCommand(\n        SELECTION_CHANGE_COMMAND,\n        () => {\n          updateTextFormatFloatingToolbar();\n          return false;\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n    );\n  }, [editor, updateTextFormatFloatingToolbar]);\n\n  return (\n    <div ref={popupCharStylesEditorRef} className=\"floating-text-format-popup\">\n      <button\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'bold');\n        }}\n        className={'popup-item spaced ' + (isBold ? 'active' : '')}\n        aria-label=\"Format text as bold\">\n        <i className=\"format bold\" />\n      </button>\n      <button\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'italic');\n        }}\n        className={'popup-item spaced ' + (isItalic ? 'active' : '')}\n        aria-label=\"Format text as italics\">\n        <i className=\"format italic\" />\n      </button>\n      <button\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'underline');\n        }}\n        className={'popup-item spaced ' + (isUnderline ? 'active' : '')}\n        aria-label=\"Format text to underlined\">\n        <i className=\"format underline\" />\n      </button>\n      <button\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'strikethrough');\n        }}\n        className={'popup-item spaced ' + (isStrikethrough ? 'active' : '')}\n        aria-label=\"Format text with a strikethrough\">\n        <i className=\"format strikethrough\" />\n      </button>\n      <button\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'subscript');\n        }}\n        className={'popup-item spaced ' + (isSubscript ? 'active' : '')}\n        title=\"Subscript\"\n        aria-label=\"Format Subscript\">\n        <i className=\"format subscript\" />\n      </button>\n      <button\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'superscript');\n        }}\n        className={'popup-item spaced ' + (isSuperscript ? 'active' : '')}\n        title=\"Superscript\"\n        aria-label=\"Format Superscript\">\n        <i className=\"format superscript\" />\n      </button>\n      <button\n        onClick={() => {\n          editor.dispatchCommand(FORMAT_TEXT_COMMAND, 'code');\n        }}\n        className={'popup-item spaced ' + (isCode ? 'active' : '')}\n        aria-label=\"Insert code block\">\n        <i className=\"format code\" />\n      </button>\n      <button\n        onClick={insertLink}\n        className={'popup-item spaced ' + (isLink ? 'active' : '')}\n        aria-label=\"Insert link\">\n        <i className=\"format link\" />\n      </button>\n      {/* <button\n        onClick={insertComment}\n        className={'popup-item spaced ' + (isLink ? 'active' : '')}\n        aria-label=\"Insert link\">\n        <i className=\"format add-comment\" />\n      </button> */}\n    </div>\n  );\n}\n\nfunction getSelectedNode(selection: RangeSelection): TextNode | ElementNode {\n  const anchor = selection.anchor;\n  const focus = selection.focus;\n  const anchorNode = selection.anchor.getNode();\n  const focusNode = selection.focus.getNode();\n  if (anchorNode === focusNode) {\n    return anchorNode;\n  }\n  const isBackward = selection.isBackward();\n  if (isBackward) {\n    return $isAtNodeEnd(focus) ? anchorNode : focusNode;\n  } else {\n    return $isAtNodeEnd(anchor) ? focusNode : anchorNode;\n  }\n}\n\nfunction useTextFormatFloatingToolbar(\n  editor: LexicalEditor,\n): JSX.Element | null {\n  const [isText, setIsText] = useState(false);\n  const [isLink, setIsLink] = useState(false);\n  const [isBold, setIsBold] = useState(false);\n  const [isItalic, setIsItalic] = useState(false);\n  const [isUnderline, setIsUnderline] = useState(false);\n  const [isStrikethrough, setIsStrikethrough] = useState(false);\n  const [isSubscript, setIsSubscript] = useState(false);\n  const [isSuperscript, setIsSuperscript] = useState(false);\n  const [isCode, setIsCode] = useState(false);\n\n  const updatePopup = useCallback(() => {\n    editor.getEditorState().read(() => {\n      // Should not to pop up the floating toolbar when using IME input\n      if (editor.isComposing()) {\n        return;\n      }\n      const selection = $getSelection();\n      const nativeSelection = window.getSelection();\n      const rootElement = editor.getRootElement();\n\n      if (\n        nativeSelection !== null &&\n        (!$isRangeSelection(selection) ||\n          rootElement === null ||\n          !rootElement.contains(nativeSelection.anchorNode))\n      ) {\n        setIsText(false);\n        return;\n      }\n\n      if (!$isRangeSelection(selection)) {\n        return;\n      }\n\n      const node = getSelectedNode(selection);\n\n      // Update text format\n      setIsBold(selection.hasFormat('bold'));\n      setIsItalic(selection.hasFormat('italic'));\n      setIsUnderline(selection.hasFormat('underline'));\n      setIsStrikethrough(selection.hasFormat('strikethrough'));\n      setIsSubscript(selection.hasFormat('subscript'));\n      setIsSuperscript(selection.hasFormat('superscript'));\n      setIsCode(selection.hasFormat('code'));\n\n      // Update links\n      const parent = node.getParent();\n      if ($isLinkNode(parent) || $isLinkNode(node)) {\n        setIsLink(true);\n      } else {\n        setIsLink(false);\n      }\n\n      if (\n        !$isCodeHighlightNode(selection.anchor.getNode()) &&\n        selection.getTextContent() !== ''\n      ) {\n        setIsText($isTextNode(node));\n      } else {\n        setIsText(false);\n      }\n    });\n  }, [editor]);\n\n  useEffect(() => {\n    document.addEventListener('selectionchange', updatePopup);\n    return () => {\n      document.removeEventListener('selectionchange', updatePopup);\n    };\n  }, [updatePopup]);\n\n  useEffect(() => {\n    return editor.registerUpdateListener(() => {\n      updatePopup();\n    });\n  }, [editor, updatePopup]);\n\n  if (!isText || isLink) {\n    return null;\n  }\n\n  return createPortal(\n    <TextFormatFloatingToolbar\n      editor={editor}\n      isLink={isLink}\n      isBold={isBold}\n      isItalic={isItalic}\n      isStrikethrough={isStrikethrough}\n      isSubscript={isSubscript}\n      isSuperscript={isSuperscript}\n      isUnderline={isUnderline}\n      isCode={isCode}\n    />,\n    document.body,\n  );\n}\n\nexport default function TextFormatFloatingToolbarPlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n  return useTextFormatFloatingToolbar(editor);\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nexport const CAN_USE_DOM: boolean =\n  typeof window !== 'undefined' &&\n  typeof window.document !== 'undefined' &&\n  typeof window.document.createElement !== 'undefined';\n\nconst documentMode =\n  // @ts-ignore\n  CAN_USE_DOM && 'documentMode' in document ? document.documentMode : null;\n\nexport const IS_APPLE: boolean =\n  CAN_USE_DOM && /Mac|iPod|iPhone|iPad/.test(navigator.platform);\n\nexport const IS_FIREFOX: boolean =\n  CAN_USE_DOM && /^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent);\n\nexport const CAN_USE_BEFORE_INPUT: boolean =\n  CAN_USE_DOM && 'InputEvent' in window && !documentMode\n    ? 'getTargetRanges' in new window.InputEvent('input')\n    : false;\n\nexport const IS_SAFARI: boolean =\n  CAN_USE_DOM && /Version\\/[\\d.]+.*Safari/.test(navigator.userAgent);\n\nexport const IS_IOS: boolean =\n  CAN_USE_DOM &&\n  /iPad|iPhone|iPod/.test(navigator.userAgent) &&\n  // @ts-ignore\n  !window.MSStream;\n\n// Keep these in case we need to use them in the future.\n// export const IS_WINDOWS: boolean = CAN_USE_DOM && /Win/.test(navigator.platform);\n// export const IS_CHROME: boolean = CAN_USE_DOM && /^(?=.*Chrome).*/i.test(navigator.userAgent);\n// export const canUseTextInputEvent: boolean = CAN_USE_DOM && 'TextEvent' in window && !documentMode;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  EditorConfig,\n  LexicalEditor,\n  LexicalNode,\n  NodeKey,\n  SerializedLexicalNode,\n  Spread,\n} from 'lexical';\n\n// import './StickyNode.css';\n\nimport {\n  CollaborationPlugin,\n} from '@lexical/react/LexicalCollaborationPlugin';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {HistoryPlugin} from '@lexical/react/LexicalHistoryPlugin';\nimport {LexicalNestedComposer} from '@lexical/react/LexicalNestedComposer';\nimport {PlainTextPlugin} from '@lexical/react/LexicalPlainTextPlugin';\nimport {\n  $getNodeByKey,\n  $setSelection,\n  createEditor,\n  DecoratorNode,\n} from 'lexical';\nimport * as React from 'react';\nimport {useEffect, useRef} from 'react';\nimport {createPortal} from 'react-dom';\nimport useLayoutEffect from '../shared/src/getDOMSelection';\n\nimport {createWebsocketProvider} from '../collaboration';\nimport {useSharedHistoryContext} from '../context/SharedHistoryContext';\nimport StickyEditorTheme from '../themes/StickyEditorTheme';\nimport ContentEditable from '../ui/ContentEditable';\nimport Placeholder from '../ui/Placeholder';\n\ntype Positioning = {\n  isDragging: boolean;\n  offsetX: number;\n  offsetY: number;\n  rootElementRect: null | ClientRect;\n  x: number;\n  y: number;\n};\n\nfunction positionSticky(\n  stickyElem: HTMLElement,\n  positioning: Positioning,\n): void {\n  const style = stickyElem.style;\n  const rootElementRect = positioning.rootElementRect;\n  const rectLeft = rootElementRect !== null ? rootElementRect.left : 0;\n  const rectTop = rootElementRect !== null ? rootElementRect.top : 0;\n  style.top = rectTop + positioning.y + 'px';\n  style.left = rectLeft + positioning.x + 'px';\n}\n\nfunction StickyComponent({\n  x,\n  y,\n  nodeKey,\n  color,\n  caption,\n}: {\n  caption: LexicalEditor;\n  color: 'pink' | 'yellow';\n  nodeKey: NodeKey;\n  x: number;\n  y: number;\n}): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n  const stickyContainerRef = useRef<null | HTMLDivElement>(null);\n  const positioningRef = useRef<Positioning>({\n    isDragging: false,\n    offsetX: 0,\n    offsetY: 0,\n    rootElementRect: null,\n    x: 0,\n    y: 0,\n  });\n  // const {yjsDocMap} = useCollaborationContext();\n  // const isCollab = yjsDocMap.get('main') !== undefined;\n\n  useEffect(() => {\n    const position = positioningRef.current;\n    position.x = x;\n    position.y = y;\n\n    const stickyContainer = stickyContainerRef.current;\n    if (stickyContainer !== null) {\n      positionSticky(stickyContainer, position);\n    }\n  }, [x, y]);\n\n  // useLayoutEffect(() => {\n  //   const position = positioningRef.current;\n  //   const resizeObserver = new ResizeObserver((entries) => {\n  //     for (let i = 0; i < entries.length; i++) {\n  //       const entry = entries[i];\n  //       const {target} = entry;\n  //       position.rootElementRect = target.getBoundingClientRect();\n  //       const stickyContainer = stickyContainerRef.current;\n  //       if (stickyContainer !== null) {\n  //         positionSticky(stickyContainer, position);\n  //       }\n  //     }\n  //   });\n\n    // const removeRootListener = editor.registerRootListener(\n    //   (nextRootElem, prevRootElem) => {\n    //     if (prevRootElem !== null) {\n    //       resizeObserver.unobserve(prevRootElem);\n    //     }\n    //     if (nextRootElem !== null) {\n    //       resizeObserver.observe(nextRootElem);\n    //     }\n    //   },\n    // );\n\n    // const handleWindowResize = () => {\n    //   const rootElement = editor.getRootElement();\n    //   const stickyContainer = stickyContainerRef.current;\n    //   if (rootElement !== null && stickyContainer !== null) {\n    //     position.rootElementRect = rootElement.getBoundingClientRect();\n    //     positionSticky(stickyContainer, position);\n    //   }\n    // };\n\n    // window.addEventListener('resize', handleWindowResize);\n\n  //   return () => {\n  //     window.removeEventListener('resize', handleWindowResize);\n  //     removeRootListener();\n  //   };\n  // }, [editor]);\n\n  useEffect(() => {\n    const stickyContainer = stickyContainerRef.current;\n    if (stickyContainer !== null) {\n      // Delay adding transition so we don't trigger the\n      // transition on load of the sticky.\n      setTimeout(() => {\n        stickyContainer.style.setProperty(\n          'transition',\n          'top 0.3s ease 0s, left 0.3s ease 0s',\n        );\n      }, 500);\n    }\n  }, []);\n\n  const handlePointerMove = (event: PointerEvent) => {\n    const stickyContainer = stickyContainerRef.current;\n    const positioning = positioningRef.current;\n    const rootElementRect = positioning.rootElementRect;\n    if (\n      stickyContainer !== null &&\n      positioning.isDragging &&\n      rootElementRect !== null\n    ) {\n      positioning.x = event.pageX - positioning.offsetX - rootElementRect.left;\n      positioning.y = event.pageY - positioning.offsetY - rootElementRect.top;\n      positionSticky(stickyContainer, positioning);\n    }\n  };\n\n  const handlePointerUp = (event: PointerEvent) => {\n    const stickyContainer = stickyContainerRef.current;\n    const positioning = positioningRef.current;\n    if (stickyContainer !== null) {\n      positioning.isDragging = false;\n      stickyContainer.classList.remove('dragging');\n      editor.update(() => {\n        const node = $getNodeByKey(nodeKey);\n        if ($isStickyNode(node)) {\n          node.setPosition(positioning.x, positioning.y);\n        }\n      });\n    }\n    document.removeEventListener('pointermove', handlePointerMove);\n    document.removeEventListener('pointerup', handlePointerUp);\n  };\n\n  const handleDelete = () => {\n    editor.update(() => {\n      const node = $getNodeByKey(nodeKey);\n      if ($isStickyNode(node)) {\n        node.remove();\n      }\n    });\n  };\n\n  const handleColorChange = () => {\n    editor.update(() => {\n      const node = $getNodeByKey(nodeKey);\n      if ($isStickyNode(node)) {\n        node.toggleColor();\n      }\n    });\n  };\n\n  const {historyState} = useSharedHistoryContext();\n\n  return (\n    <div ref={stickyContainerRef} className=\"sticky-note-container\">\n      <div\n        className={`sticky-note ${color}`}\n        onPointerDown={(event) => {\n          const stickyContainer = stickyContainerRef.current;\n          if (\n            stickyContainer == null ||\n            event.button === 2 ||\n            event.target !== stickyContainer.firstChild\n          ) {\n            // Right click or click on editor should not work\n            return;\n          }\n          const stickContainer = stickyContainer;\n          const positioning = positioningRef.current;\n          if (stickContainer !== null) {\n            const {top, left} = stickContainer.getBoundingClientRect();\n            positioning.offsetX = event.clientX - left;\n            positioning.offsetY = event.clientY - top;\n            positioning.isDragging = true;\n            stickContainer.classList.add('dragging');\n            document.addEventListener('pointermove', handlePointerMove);\n            document.addEventListener('pointerup', handlePointerUp);\n            event.preventDefault();\n          }\n        }}>\n        <button\n          onClick={handleDelete}\n          className=\"delete\"\n          aria-label=\"Delete sticky note\"\n          title=\"Delete\">\n          X\n        </button>\n        <button\n          onClick={handleColorChange}\n          className=\"color\"\n          aria-label=\"Change sticky note color\"\n          title=\"Color\">\n          <i className=\"bucket\" />\n        </button>\n        {/* <LexicalNestedComposer\n          initialEditor={caption}\n          initialTheme={StickyEditorTheme}>\n          {isCollab ? (\n            <CollaborationPlugin\n              id={caption.getKey()}\n              providerFactory={createWebsocketProvider}\n              shouldBootstrap={true}\n            />\n          ) : (\n            <HistoryPlugin externalHistoryState={historyState} />\n          )}\n          <PlainTextPlugin\n            contentEditable={\n              <ContentEditable className=\"StickyNode__contentEditable\" />\n            }\n            placeholder={\n              <Placeholder className=\"StickyNode__placeholder\">\n                What's up?\n              </Placeholder>\n            }\n            // TODO Remove after it's inherited from the parent (LexicalComposer)\n            initialEditorState={null}\n          />\n        </LexicalNestedComposer> */}\n      </div>\n    </div>\n  );\n}\n\ntype StickyNoteColor = 'pink' | 'yellow';\n\nexport type SerializedStickyNode = Spread<\n  {\n    xOffset: number;\n    yOffset: number;\n    color: StickyNoteColor;\n    caption: LexicalEditor;\n    type: 'sticky';\n    version: 1;\n  },\n  SerializedLexicalNode\n>;\n\nexport class StickyNode extends DecoratorNode<JSX.Element> {\n  __x: number;\n  __y: number;\n  __color: StickyNoteColor;\n  __caption: LexicalEditor;\n\n  static getType(): string {\n    return 'sticky';\n  }\n\n  static clone(node: StickyNode): StickyNode {\n    return new StickyNode(\n      node.__x,\n      node.__y,\n      node.__color,\n      node.__caption,\n      node.__key,\n    );\n  }\n  static importJSON(serializedNode: SerializedStickyNode): StickyNode {\n    return new StickyNode(\n      serializedNode.xOffset,\n      serializedNode.yOffset,\n      serializedNode.color,\n      serializedNode.caption,\n    );\n  }\n\n  constructor(\n    x: number,\n    y: number,\n    color: 'pink' | 'yellow',\n    caption?: LexicalEditor,\n    key?: NodeKey,\n  ) {\n    super(key);\n    this.__x = x;\n    this.__y = y;\n    this.__caption = caption || createEditor();\n    this.__color = color;\n  }\n\n  exportJSON(): SerializedStickyNode {\n    return {\n      caption: this.__caption,\n      color: this.__color,\n      type: 'sticky',\n      version: 1,\n      xOffset: this.__x,\n      yOffset: this.__y,\n    };\n  }\n\n  createDOM(config: EditorConfig): HTMLElement {\n    const div = document.createElement('div');\n    div.style.display = 'contents';\n    return div;\n  }\n\n  updateDOM(): false {\n    return false;\n  }\n\n  setPosition(x: number, y: number): void {\n    const writable = this.getWritable();\n    writable.__x = x;\n    writable.__y = y;\n    $setSelection(null);\n  }\n\n  toggleColor(): void {\n    const writable = this.getWritable();\n    writable.__color = writable.__color === 'pink' ? 'yellow' : 'pink';\n  }\n\n  decorate(editor: LexicalEditor, config: EditorConfig): JSX.Element {\n    return createPortal(\n      <StickyComponent\n        color={this.__color}\n        x={this.__x}\n        y={this.__y}\n        nodeKey={this.getKey()}\n        caption={this.__caption}\n      />,\n      document.body,\n    );\n  }\n\n  isIsolated(): true {\n    return true;\n  }\n}\n\nexport function $isStickyNode(\n  node: LexicalNode | null | undefined,\n): node is StickyNode {\n  return node instanceof StickyNode;\n}\n\nexport function $createStickyNode(\n  xOffset: number,\n  yOffset: number,\n): StickyNode {\n  return new StickyNode(xOffset, yOffset, 'yellow');\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {\n  ReactNode,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport * as React from 'react';\nimport {createPortal} from 'react-dom';\n\ntype DropDownContextType = {\n  registerItem: (ref: React.RefObject<HTMLButtonElement>) => void;\n};\n\nconst DropDownContext = React.createContext<DropDownContextType | null>(null);\n\nexport function DropDownItem({\n  children,\n  className,\n  onClick,\n  title,\n}: {\n  children: React.ReactNode;\n  className: string;\n  onClick: (event: React.MouseEvent<HTMLButtonElement>) => void;\n  title?: string;\n}) {\n  const ref = useRef<HTMLButtonElement>(null);\n\n  const dropDownContext = React.useContext(DropDownContext);\n\n  if (dropDownContext === null) {\n    throw new Error('DropDownItem must be used within a DropDown');\n  }\n\n  const {registerItem} = dropDownContext;\n\n  useEffect(() => {\n    if (ref && ref.current) {\n      registerItem(ref);\n    }\n  }, [ref, registerItem]);\n\n  return (\n    <button className={className} onClick={onClick} ref={ref} title={title}>\n      {children}\n    </button>\n  );\n}\n\nfunction DropDownItems({\n  children,\n  dropDownRef,\n  onClose,\n}: {\n  children: React.ReactNode;\n  dropDownRef: React.Ref<HTMLDivElement>;\n  onClose: () => void;\n}) {\n  const [items, setItems] = useState<React.RefObject<HTMLButtonElement>[]>();\n  const [highlightedItem, setHighlightedItem] =\n    useState<React.RefObject<HTMLButtonElement>>();\n\n  const registerItem = useCallback(\n    (itemRef: React.RefObject<HTMLButtonElement>) => {\n      setItems((prev) => (prev ? [...prev, itemRef] : [itemRef]));\n    },\n    [setItems],\n  );\n\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLDivElement>) => {\n    if (!items) return;\n\n    const key = event.key;\n\n    if (['Escape', 'ArrowUp', 'ArrowDown', 'Tab'].includes(key)) {\n      event.preventDefault();\n    }\n\n    if (key === 'Escape' || key === 'Tab') {\n      onClose();\n    } else if (key === 'ArrowUp') {\n      setHighlightedItem((prev) => {\n        if (!prev) return items[0];\n        const index = items.indexOf(prev) - 1;\n        return items[index === -1 ? items.length - 1 : index];\n      });\n    } else if (key === 'ArrowDown') {\n      setHighlightedItem((prev) => {\n        if (!prev) return items[0];\n        return items[items.indexOf(prev) + 1];\n      });\n    }\n  };\n\n  const contextValue = useMemo(\n    () => ({\n      registerItem,\n    }),\n    [registerItem],\n  );\n\n  useEffect(() => {\n    if (items && !highlightedItem) {\n      setHighlightedItem(items[0]);\n    }\n\n    if (highlightedItem && highlightedItem.current) {\n      highlightedItem.current.focus();\n    }\n  }, [items, highlightedItem]);\n\n  return (\n    <DropDownContext.Provider value={contextValue}>\n      <div className=\"dropdown\" ref={dropDownRef} onKeyDown={handleKeyDown}>\n        {children}\n      </div>\n    </DropDownContext.Provider>\n  );\n}\n\nexport default function DropDown({\n  buttonLabel,\n  buttonAriaLabel,\n  buttonClassName,\n  buttonIconClassName,\n  children,\n  stopCloseOnClickSelf,\n}: {\n  buttonAriaLabel?: string;\n  buttonClassName: string;\n  buttonIconClassName?: string;\n  buttonLabel?: string;\n  children: ReactNode;\n  stopCloseOnClickSelf?: boolean;\n}): JSX.Element {\n  const dropDownRef = useRef<HTMLDivElement>(null);\n  const buttonRef = useRef<HTMLButtonElement>(null);\n  const [showDropDown, setShowDropDown] = useState(false);\n\n  const handleClose = () => {\n    setShowDropDown(false);\n    if (buttonRef && buttonRef.current) {\n      buttonRef.current.focus();\n    }\n  };\n\n  useEffect(() => {\n    const button = buttonRef.current;\n    const dropDown = dropDownRef.current;\n\n    if (showDropDown && button !== null && dropDown !== null) {\n      const {top, left} = button.getBoundingClientRect();\n      dropDown.style.top = `${top + 40}px`;\n      dropDown.style.left = `${Math.min(\n        left,\n        window.innerWidth - dropDown.offsetWidth - 20,\n      )}px`;\n    }\n  }, [dropDownRef, buttonRef, showDropDown]);\n\n  useEffect(() => {\n    const button = buttonRef.current;\n\n    if (button !== null && showDropDown) {\n      const handle = (event: MouseEvent) => {\n        const target = event.target;\n        if (stopCloseOnClickSelf) {\n          if (\n            dropDownRef.current &&\n            dropDownRef.current.contains(target as Node)\n          )\n            return;\n        }\n        if (!button.contains(target as Node)) {\n          setShowDropDown(false);\n        }\n      };\n      document.addEventListener('click', handle);\n\n      return () => {\n        document.removeEventListener('click', handle);\n      };\n    }\n  }, [dropDownRef, buttonRef, showDropDown, stopCloseOnClickSelf]);\n\n  return (\n    <>\n      <button\n        aria-label={buttonAriaLabel || buttonLabel}\n        className={buttonClassName}\n        onClick={() => setShowDropDown(!showDropDown)}\n        ref={buttonRef}>\n        {buttonIconClassName && <span className={buttonIconClassName} />}\n        {buttonLabel && (\n          <span className=\"text dropdown-button-text\">{buttonLabel}</span>\n        )}\n        <i className=\"chevron-down\" />\n      </button>\n\n      {showDropDown &&\n        createPortal(\n          <DropDownItems dropDownRef={dropDownRef} onClose={handleClose}>\n            {children}\n          </DropDownItems>,\n          document.body,\n        )}\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\n// import './Input.css';\n\nimport * as React from 'react';\n\ntype Props = Readonly<{\n  'data-test-id'?: string;\n  label: string;\n  onChange: (val: string) => void;\n  placeholder?: string;\n  value: string;\n}>;\n\nexport default function TextInput({\n  label,\n  value,\n  onChange,\n  placeholder = '',\n  'data-test-id': dataTestId,\n}: Props): JSX.Element {\n  return (\n    <div className=\"Input__wrapper\">\n      <label className=\"Input__label\">{label}</label>\n      <input\n        type=\"text\"\n        className=\"Input__input\"\n        placeholder={placeholder}\n        value={value}\n        onChange={(e) => {\n          onChange(e.target.value);\n        }}\n        data-test-id={dataTestId}\n      />\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\n// import './ColorPicker.css';\n\nimport {ReactNode, useEffect, useMemo, useRef, useState} from 'react';\nimport * as React from 'react';\n\nimport DropDown from './DropDown';\nimport TextInput from './TextInput';\n\ninterface ColorPickerProps {\n  buttonAriaLabel?: string;\n  buttonClassName: string;\n  buttonIconClassName?: string;\n  buttonLabel?: string;\n  color: string;\n  children?: ReactNode;\n  onChange?: (color: string) => void;\n  title?: string;\n}\n\nconst basicColors = [\n  '#d0021b',\n  '#f5a623',\n  '#f8e71c',\n  '#8b572a',\n  '#7ed321',\n  '#417505',\n  '#bd10e0',\n  '#9013fe',\n  '#4a90e2',\n  '#50e3c2',\n  '#b8e986',\n  '#000000',\n  '#4a4a4a',\n  '#9b9b9b',\n  '#ffffff',\n];\n\nconst WIDTH = 214;\nconst HEIGHT = 150;\n\nexport default function ColorPicker({\n  color,\n  children,\n  onChange,\n  ...rest\n}: Readonly<ColorPickerProps>): JSX.Element {\n  const [selfColor, setSelfColor] = useState(transformColor('hex', color));\n  const [inputColor, setInputColor] = useState(color);\n  const innerDivRef = useRef(null);\n\n  const saturationPosition = useMemo(\n    () => ({\n      x: (selfColor.hsv.s / 100) * WIDTH,\n      y: ((100 - selfColor.hsv.v) / 100) * HEIGHT,\n    }),\n    [selfColor.hsv.s, selfColor.hsv.v],\n  );\n\n  const huePosition = useMemo(\n    () => ({\n      x: (selfColor.hsv.h / 360) * WIDTH,\n    }),\n    [selfColor.hsv],\n  );\n\n  const onSetHex = (hex: string) => {\n    setInputColor(hex);\n    if (/^#[0-9A-Fa-f]{6}$/i.test(hex)) {\n      const newColor = transformColor('hex', hex);\n      setSelfColor(newColor);\n    }\n  };\n\n  const onMoveSaturation = ({x, y}: Position) => {\n    const newHsv = {\n      ...selfColor.hsv,\n      s: (x / WIDTH) * 100,\n      v: 100 - (y / HEIGHT) * 100,\n    };\n    const newColor = transformColor('hsv', newHsv);\n    setSelfColor(newColor);\n    setInputColor(newColor.hex);\n  };\n\n  const onMoveHue = ({x}: Position) => {\n    const newHsv = {...selfColor.hsv, h: (x / WIDTH) * 360};\n    const newColor = transformColor('hsv', newHsv);\n\n    setSelfColor(newColor);\n    setInputColor(newColor.hex);\n  };\n\n  useEffect(() => {\n    // Check if the dropdown is actually active\n    if (innerDivRef.current !== null && onChange) {\n      onChange(selfColor.hex);\n      setInputColor(selfColor.hex);\n    }\n  }, [selfColor, onChange]);\n\n  useEffect(() => {\n    if (color === undefined) return;\n    const newColor = transformColor('hex', color);\n    setSelfColor(newColor);\n    setInputColor(newColor.hex);\n  }, [color]);\n\n  return (\n    <DropDown {...rest} stopCloseOnClickSelf={true}>\n      <div\n        className=\"color-picker-wrapper\"\n        style={{width: WIDTH}}\n        ref={innerDivRef}>\n        <TextInput label=\"Hex\" onChange={onSetHex} value={inputColor} />\n        <div className=\"color-picker-basic-color\">\n          {basicColors.map((basicColor) => (\n            <button\n              className={basicColor === selfColor.hex ? ' active' : ''}\n              key={basicColor}\n              style={{backgroundColor: basicColor}}\n              onClick={() => {\n                setInputColor(basicColor);\n                setSelfColor(transformColor('hex', basicColor));\n              }}\n            />\n          ))}\n        </div>\n        <MoveWrapper\n          className=\"color-picker-saturation\"\n          style={{backgroundColor: `hsl(${selfColor.hsv.h}, 100%, 50%)`}}\n          onChange={onMoveSaturation}>\n          <div\n            className=\"color-picker-saturation_cursor\"\n            style={{\n              backgroundColor: selfColor.hex,\n              left: saturationPosition.x,\n              top: saturationPosition.y,\n            }}\n          />\n        </MoveWrapper>\n        <MoveWrapper className=\"color-picker-hue\" onChange={onMoveHue}>\n          <div\n            className=\"color-picker-hue_cursor\"\n            style={{\n              backgroundColor: `hsl(${selfColor.hsv.h}, 100%, 50%)`,\n              left: huePosition.x,\n            }}\n          />\n        </MoveWrapper>\n        <div\n          className=\"color-picker-color\"\n          style={{backgroundColor: selfColor.hex}}\n        />\n      </div>\n      {children}\n    </DropDown>\n  );\n}\n\nexport interface Position {\n  x: number;\n  y: number;\n}\n\ninterface MoveWrapperProps {\n  className?: string;\n  style?: React.CSSProperties;\n  onChange: (position: Position) => void;\n  children: JSX.Element;\n}\n\nfunction MoveWrapper({className, style, onChange, children}: MoveWrapperProps) {\n  const divRef = useRef<HTMLDivElement>(null);\n\n  const move = (e: React.MouseEvent | MouseEvent): void => {\n    if (divRef.current) {\n      const {current: div} = divRef;\n      const {width, height, left, top} = div.getBoundingClientRect();\n\n      const x = clamp(e.clientX - left, width, 0);\n      const y = clamp(e.clientY - top, height, 0);\n\n      onChange({x, y});\n    }\n  };\n\n  const onMouseDown = (e: React.MouseEvent): void => {\n    if (e.button !== 0) return;\n\n    move(e);\n\n    const onMouseMove = (_e: MouseEvent): void => {\n      move(_e);\n    };\n\n    const onMouseUp = (_e: MouseEvent): void => {\n      document.removeEventListener('mousemove', onMouseMove, false);\n      document.removeEventListener('mouseup', onMouseUp, false);\n\n      move(_e);\n    };\n\n    document.addEventListener('mousemove', onMouseMove, false);\n    document.addEventListener('mouseup', onMouseUp, false);\n  };\n\n  return (\n    <div\n      ref={divRef}\n      className={className}\n      style={style}\n      onMouseDown={onMouseDown}>\n      {children}\n    </div>\n  );\n}\n\nfunction clamp(value: number, max: number, min: number) {\n  return value > max ? max : value < min ? min : value;\n}\n\ninterface RGB {\n  b: number;\n  g: number;\n  r: number;\n}\ninterface HSV {\n  h: number;\n  s: number;\n  v: number;\n}\ninterface Color {\n  hex: string;\n  hsv: HSV;\n  rgb: RGB;\n}\n\nexport function toHex(value: string): string {\n  if (!value.startsWith('#')) {\n    const ctx = document.createElement('canvas').getContext('2d');\n\n    if (!ctx) {\n      throw new Error('2d context not supported or canvas already initialized');\n    }\n\n    ctx.fillStyle = value;\n\n    return ctx.fillStyle;\n  } else if (value.length === 4 || value.length === 5) {\n    value = value\n      .split('')\n      .map((v, i) => (i ? v + v : '#'))\n      .join('');\n\n    return value;\n  } else if (value.length === 7 || value.length === 9) {\n    return value;\n  }\n\n  return '#000000';\n}\n\nfunction hex2rgb(hex: string): RGB {\n  const rbgArr = (\n    hex\n      .replace(\n        /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i,\n        (m, r, g, b) => '#' + r + r + g + g + b + b,\n      )\n      .substring(1)\n      .match(/.{2}/g) || []\n  ).map((x) => parseInt(x, 16));\n\n  return {\n    b: rbgArr[2],\n    g: rbgArr[1],\n    r: rbgArr[0],\n  };\n}\n\nfunction rgb2hsv({r, g, b}: RGB): HSV {\n  r /= 255;\n  g /= 255;\n  b /= 255;\n\n  const max = Math.max(r, g, b);\n  const d = max - Math.min(r, g, b);\n\n  const h = d\n    ? (max === r\n        ? (g - b) / d + (g < b ? 6 : 0)\n        : max === g\n        ? 2 + (b - r) / d\n        : 4 + (r - g) / d) * 60\n    : 0;\n  const s = max ? (d / max) * 100 : 0;\n  const v = max * 100;\n\n  return {h, s, v};\n}\n\nfunction hsv2rgb({h, s, v}: HSV): RGB {\n  s /= 100;\n  v /= 100;\n\n  const i = ~~(h / 60);\n  const f = h / 60 - i;\n  const p = v * (1 - s);\n  const q = v * (1 - s * f);\n  const t = v * (1 - s * (1 - f));\n  const index = i % 6;\n\n  const r = Math.round([v, q, p, p, t, v][index] * 255);\n  const g = Math.round([t, v, v, q, p, p][index] * 255);\n  const b = Math.round([p, p, t, v, v, q][index] * 255);\n\n  return {b, g, r};\n}\n\nfunction rgb2hex({b, g, r}: RGB): string {\n  return '#' + [r, g, b].map((x) => x.toString(16).padStart(2, '0')).join('');\n}\n\nfunction transformColor<M extends keyof Color, C extends Color[M]>(\n  format: M,\n  color: C,\n): Color {\n  let hex: Color['hex'] = toHex('#121212');\n  let rgb: Color['rgb'] = hex2rgb(hex);\n  let hsv: Color['hsv'] = rgb2hsv(rgb);\n\n  if (format === 'hex') {\n    const value = color as Color['hex'];\n\n    hex = toHex(value);\n    rgb = hex2rgb(hex);\n    hsv = rgb2hsv(rgb);\n  } else if (format === 'rgb') {\n    const value = color as Color['rgb'];\n\n    rgb = value;\n    hex = rgb2hex(rgb);\n    hsv = rgb2hsv(rgb);\n  } else if (format === 'hsv') {\n    const value = color as Color['hsv'];\n\n    hsv = value;\n    rgb = hsv2rgb(hsv);\n    hex = rgb2hex(rgb);\n  }\n\n  return {hex, hsv, rgb};\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\n// import './Input.css';\n\nimport * as React from 'react';\n\ntype Props = Readonly<{\n  'data-test-id'?: string;\n  accept?: string;\n  label: string;\n  onChange: (files: FileList | null) => void;\n}>;\n\nexport default function FileInput({\n  accept,\n  label,\n  onChange,\n  'data-test-id': dataTestId,\n}: Props): JSX.Element {\n  return (\n    <div className=\"Input__wrapper\">\n      <label className=\"Input__label\">{label}</label>\n      <input\n        type=\"file\"\n        accept={accept}\n        className=\"Input__input\"\n        onChange={(e) => onChange(e.target.files)}\n        data-test-id={dataTestId}\n      />\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\n// import './KatexEquationAlterer.css';\n\nimport * as React from 'react';\nimport {useCallback, useState} from 'react';\n\nimport Button from '../ui/Button';\nimport KatexRenderer from './KatexRenderer';\n\ntype Props = {\n  initialEquation?: string;\n  onConfirm: (equation: string, inline: boolean) => void;\n};\n\nexport default function KatexEquationAlterer({\n  onConfirm,\n  initialEquation = '',\n}: Props): JSX.Element {\n  const [equation, setEquation] = useState<string>(initialEquation);\n  const [inline, setInline] = useState<boolean>(true);\n\n  const onClick = useCallback(() => {\n    onConfirm(equation, inline);\n  }, [onConfirm, equation, inline]);\n\n  const onCheckboxChange = useCallback(() => {\n    setInline(!inline);\n  }, [setInline, inline]);\n\n  return (\n    <>\n      <div className=\"KatexEquationAlterer_defaultRow\">\n        Inline\n        <input type=\"checkbox\" checked={inline} onChange={onCheckboxChange} />\n      </div>\n      <div className=\"KatexEquationAlterer_defaultRow\">Equation </div>\n      <div className=\"KatexEquationAlterer_centerRow\">\n        {inline ? (\n          <input\n            onChange={(event) => {\n              setEquation(event.target.value);\n            }}\n            value={equation}\n            className=\"KatexEquationAlterer_textArea\"\n          />\n        ) : (\n          <textarea\n            onChange={(event) => {\n              setEquation(event.target.value);\n            }}\n            value={equation}\n            className=\"KatexEquationAlterer_textArea\"\n          />\n        )}\n      </div>\n      <div className=\"KatexEquationAlterer_defaultRow\">Visualization </div>\n      <div className=\"KatexEquationAlterer_centerRow\">\n        <KatexRenderer\n          equation={equation}\n          inline={false}\n          onClick={() => null}\n        />\n      </div>\n      <div className=\"KatexEquationAlterer_dialogActions\">\n        <Button onClick={onClick}>Confirm</Button>\n      </div>\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\n// import './LinkPreview.css';\n\nimport * as React from 'react';\nimport {CSSProperties, Suspense} from 'react';\n\ntype Preview = {\n  title: string;\n  description: string;\n  img: string;\n  domain: string;\n} | null;\n\n// Cached responses or running request promises\nconst PREVIEW_CACHE: Record<string, Promise<Preview> | {preview: Preview}> = {};\n\nconst URL_MATCHER =\n  /((https?:\\/\\/(www\\.)?)|(www\\.))[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/;\n\nfunction useSuspenseRequest(url: string) {\n  let cached = PREVIEW_CACHE[url];\n\n  if (!url.match(URL_MATCHER)) {\n    return {preview: null};\n  }\n\n  if (!cached) {\n    cached = PREVIEW_CACHE[url] = fetch(\n      `/api/link-preview?url=${encodeURI(url)}`,\n    )\n      .then((response) => response.json())\n      .then((preview) => {\n        PREVIEW_CACHE[url] = preview;\n        return preview;\n      })\n      .catch(() => {\n        PREVIEW_CACHE[url] = {preview: null};\n      });\n  }\n\n  if (cached instanceof Promise) {\n    throw cached;\n  }\n\n  return cached;\n}\n\nfunction LinkPreviewContent({\n  url,\n}: Readonly<{\n  url: string;\n}>): JSX.Element | null {\n  const {preview} = useSuspenseRequest(url);\n  if (preview === null) {\n    return null;\n  }\n  return (\n    <div className=\"LinkPreview__container\">\n      {preview.img && (\n        <div className=\"LinkPreview__imageWrapper\">\n          <img\n            src={preview.img}\n            alt={preview.title}\n            className=\"LinkPreview__image\"\n          />\n        </div>\n      )}\n      {preview.domain && (\n        <div className=\"LinkPreview__domain\">{preview.domain}</div>\n      )}\n      {preview.title && (\n        <div className=\"LinkPreview__title\">{preview.title}</div>\n      )}\n      {preview.description && (\n        <div className=\"LinkPreview__description\">{preview.description}</div>\n      )}\n    </div>\n  );\n}\n\nfunction Glimmer(props: {style: CSSProperties; index: number}): JSX.Element {\n  return (\n    <div\n      className=\"LinkPreview__glimmer\"\n      {...props}\n      style={{\n        animationDelay: String((props.index || 0) * 300),\n        ...(props.style || {}),\n      }}\n    />\n  );\n}\n\nexport default function LinkPreview({\n  url,\n}: Readonly<{\n  url: string;\n}>): JSX.Element {\n  return (\n    <Suspense\n      fallback={\n        <>\n          <Glimmer style={{height: '80px'}} index={0} />\n          <Glimmer style={{width: '60%'}} index={1} />\n          <Glimmer style={{width: '80%'}} index={2} />\n        </>\n      }>\n      <LinkPreviewContent url={url} />\n    </Suspense>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  DOMConversionMap,\n  DOMConversionOutput,\n  DOMExportOutput,\n  EditorConfig,\n  ElementFormatType,\n  LexicalEditor,\n  LexicalNode,\n  NodeKey,\n  Spread,\n} from 'lexical';\n\nimport {BlockWithAlignableContents} from '@lexical/react/LexicalBlockWithAlignableContents';\nimport {\n  DecoratorBlockNode,\n  SerializedDecoratorBlockNode,\n} from '@lexical/react/LexicalDecoratorBlockNode';\nimport * as React from 'react';\nimport {useCallback, useEffect, useRef, useState} from 'react';\n\nconst WIDGET_SCRIPT_URL = 'https://platform.twitter.com/widgets.js';\n\nconst getHasScriptCached = () =>\n  document.querySelector(`script[src=\"${WIDGET_SCRIPT_URL}\"]`);\n\ntype TweetComponentProps = Readonly<{\n  className: Readonly<{\n    base: string;\n    focus: string;\n  }>;\n  format: ElementFormatType | null;\n  loadingComponent?: JSX.Element | string;\n  nodeKey: NodeKey;\n  onError?: (error: string) => void;\n  onLoad?: () => void;\n  tweetID: string;\n}>;\n\nfunction convertTweetElement(\n  domNode: HTMLDivElement,\n): DOMConversionOutput | null {\n  const id = domNode.getAttribute('data-lexical-tweet-id');\n  if (id) {\n    const node = $createTweetNode(id);\n    return {node};\n  }\n  return null;\n}\n\nfunction TweetComponent({\n  className,\n  format,\n  loadingComponent,\n  nodeKey,\n  onError,\n  onLoad,\n  tweetID,\n}: TweetComponentProps) {\n  const containerRef = useRef<HTMLDivElement | null>(null);\n\n  const previousTweetIDRef = useRef<string>('');\n  const [isLoading, setIsLoading] = useState(false);\n\n  const createTweet = useCallback(async () => {\n    try {\n      // @ts-expect-error Twitter is attached to the window.\n      await window.twttr.widgets.createTweet(tweetID, containerRef.current);\n\n      setIsLoading(false);\n\n      if (onLoad) {\n        onLoad();\n      }\n    } catch (error) {\n      if (onError) {\n        onError(String(error));\n      }\n    }\n  }, [onError, onLoad, tweetID]);\n\n  useEffect(() => {\n    if (tweetID !== previousTweetIDRef.current) {\n      setIsLoading(true);\n\n      if (!getHasScriptCached()) {\n        const script = document.createElement('script');\n        script.src = WIDGET_SCRIPT_URL;\n        script.async = true;\n        document.body?.appendChild(script);\n        script.onload = createTweet;\n        if (onError) {\n          script.onerror = onError as OnErrorEventHandler;\n        }\n      } else {\n        createTweet();\n      }\n\n      if (previousTweetIDRef) {\n        previousTweetIDRef.current = tweetID;\n      }\n    }\n  }, [createTweet, onError, tweetID]);\n\n  return (\n    <BlockWithAlignableContents\n      className={className}\n      format={format}\n      nodeKey={nodeKey}>\n      {isLoading ? loadingComponent : null}\n      <div\n        style={{display: 'inline-block', width: '550px'}}\n        ref={containerRef}\n      />\n    </BlockWithAlignableContents>\n  );\n}\n\nexport type SerializedTweetNode = Spread<\n  {\n    id: string;\n    type: 'tweet';\n    version: 1;\n  },\n  SerializedDecoratorBlockNode\n>;\n\nexport class TweetNode extends DecoratorBlockNode {\n  __id: string;\n\n  static getType(): string {\n    return 'tweet';\n  }\n\n  static clone(node: TweetNode): TweetNode {\n    return new TweetNode(node.__id, node.__format, node.__key);\n  }\n\n  static importJSON(serializedNode: SerializedTweetNode): TweetNode {\n    const node = $createTweetNode(serializedNode.id);\n    node.setFormat(serializedNode.format);\n    return node;\n  }\n\n  exportJSON(): SerializedTweetNode {\n    return {\n      ...super.exportJSON(),\n      id: this.getId(),\n      type: 'tweet',\n      version: 1,\n    };\n  }\n\n  static importDOM(): DOMConversionMap<HTMLDivElement> | null {\n    return {\n      div: (domNode: HTMLDivElement) => {\n        if (!domNode.hasAttribute('data-lexical-tweet-id')) {\n          return null;\n        }\n        return {\n          conversion: convertTweetElement,\n          priority: 2,\n        };\n      },\n    };\n  }\n\n  exportDOM(): DOMExportOutput {\n    const element = document.createElement('div');\n    element.setAttribute('data-lexical-tweet-id', this.__id);\n    return {element};\n  }\n\n  constructor(id: string, format?: ElementFormatType, key?: NodeKey) {\n    super(format, key);\n    this.__id = id;\n  }\n\n  getId(): string {\n    return this.__id;\n  }\n\n  decorate(editor: LexicalEditor, config: EditorConfig): JSX.Element {\n    const embedBlockTheme = config.theme.embedBlock || {};\n    const className = {\n      base: embedBlockTheme.base || '',\n      focus: embedBlockTheme.focus || '',\n    };\n    return (\n      <TweetComponent\n        className={className}\n        format={this.__format}\n        loadingComponent=\"Loading...\"\n        nodeKey={this.getKey()}\n        tweetID={this.__id}\n      />\n    );\n  }\n\n  isTopLevel(): true {\n    return true;\n  }\n}\n\nexport function $createTweetNode(tweetID: string): TweetNode {\n  return new TweetNode(tweetID);\n}\n\nexport function $isTweetNode(\n  node: TweetNode | LexicalNode | null | undefined,\n): node is TweetNode {\n  return node instanceof TweetNode;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $createParagraphNode,\n  $getRoot,\n  $getSelection,\n  // $isGridSelection,\n  $isNodeSelection,\n  $isRangeSelection,\n  COMMAND_PRIORITY_EDITOR,\n  createCommand,\n  LexicalCommand,\n} from 'lexical';\nimport {useEffect} from 'react';\n\nimport {$createTweetNode, TweetNode} from '../nodes/TweetNode';\n\nexport const INSERT_TWEET_COMMAND: LexicalCommand<string> = createCommand();\n\nexport default function TwitterPlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    if (!editor.hasNodes([TweetNode])) {\n      throw new Error('TwitterPlugin: TweetNode not registered on editor');\n    }\n\n    return editor.registerCommand<string>(\n      INSERT_TWEET_COMMAND,\n      (payload) => {\n        const selection = $getSelection();\n        const tweetNode = $createTweetNode(payload);\n        // if ($isRangeSelection(selection)) {\n        //   const focusNode = selection.focus.getNode();\n        //   focusNode.getTopLevelElementOrThrow().insertAfter(tweetNode);\n        // } else if ($isNodeSelection(selection) || $isGridSelection(selection)) {\n        //   const nodes = selection.getNodes();\n        //   nodes[nodes.length - 1]\n        //     .getTopLevelElementOrThrow()\n        //     .insertAfter(tweetNode);\n        // } else {\n        //   const root = $getRoot();\n        //   root.append(tweetNode);\n        // }\n        const paragraphNode = $createParagraphNode();\n        tweetNode.insertAfter(paragraphNode);\n        paragraphNode.select();\n\n        return true;\n      },\n      COMMAND_PRIORITY_EDITOR,\n    );\n  }, [editor]);\n\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  EditorConfig,\n  ElementFormatType,\n  LexicalEditor,\n  LexicalNode,\n  NodeKey,\n  Spread,\n} from 'lexical';\n\nimport {BlockWithAlignableContents} from '@lexical/react/LexicalBlockWithAlignableContents';\nimport {\n  DecoratorBlockNode,\n  SerializedDecoratorBlockNode,\n} from '@lexical/react/LexicalDecoratorBlockNode';\nimport * as React from 'react';\n\ntype YouTubeComponentProps = Readonly<{\n  className: Readonly<{\n    base: string;\n    focus: string;\n  }>;\n  format: ElementFormatType | null;\n  nodeKey: NodeKey;\n  videoID: string;\n}>;\n\nfunction YouTubeComponent({\n  className,\n  format,\n  nodeKey,\n  videoID,\n}: YouTubeComponentProps) {\n  return (\n    <BlockWithAlignableContents\n      className={className}\n      format={format}\n      nodeKey={nodeKey}>\n      <iframe\n        width=\"560\"\n        height=\"315\"\n        src={`https://www.youtube.com/embed/${videoID}`}\n        frameBorder=\"0\"\n        allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n        allowFullScreen={true}\n        title=\"YouTube video\"\n      />\n    </BlockWithAlignableContents>\n  );\n}\n\nexport type SerializedYouTubeNode = Spread<\n  {\n    videoID: string;\n    type: 'youtube';\n    version: 1;\n  },\n  SerializedDecoratorBlockNode\n>;\n\nexport class YouTubeNode extends DecoratorBlockNode {\n  __id: string;\n\n  static getType(): string {\n    return 'youtube';\n  }\n\n  static clone(node: YouTubeNode): YouTubeNode {\n    return new YouTubeNode(node.__id, node.__format, node.__key);\n  }\n\n  static importJSON(serializedNode: SerializedYouTubeNode): YouTubeNode {\n    const node = $createYouTubeNode(serializedNode.videoID);\n    node.setFormat(serializedNode.format);\n    return node;\n  }\n\n  exportJSON(): SerializedYouTubeNode {\n    return {\n      ...super.exportJSON(),\n      type: 'youtube',\n      version: 1,\n      videoID: this.__id,\n    };\n  }\n\n  constructor(id: string, format?: ElementFormatType, key?: NodeKey) {\n    super(format, key);\n    this.__id = id;\n  }\n\n  updateDOM(): false {\n    return false;\n  }\n\n  decorate(_editor: LexicalEditor, config: EditorConfig): JSX.Element {\n    const embedBlockTheme = config.theme.embedBlock || {};\n    const className = {\n      base: embedBlockTheme.base || '',\n      focus: embedBlockTheme.focus || '',\n    };\n    return (\n      <YouTubeComponent\n        className={className}\n        format={this.__format}\n        nodeKey={this.getKey()}\n        videoID={this.__id}\n      />\n    );\n  }\n\n  isTopLevel(): true {\n    return true;\n  }\n}\n\nexport function $createYouTubeNode(videoID: string): YouTubeNode {\n  return new YouTubeNode(videoID);\n}\n\nexport function $isYouTubeNode(\n  node: YouTubeNode | LexicalNode | null | undefined,\n): node is YouTubeNode {\n  return node instanceof YouTubeNode;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {\n  $createParagraphNode,\n  $getRoot,\n  $getSelection,\n  // $isGridSelection,\n  $isNodeSelection,\n  $isRangeSelection,\n  COMMAND_PRIORITY_EDITOR,\n  createCommand,\n  LexicalCommand,\n} from 'lexical';\nimport {useEffect} from 'react';\n\nimport {$createYouTubeNode, YouTubeNode} from '../nodes/YouTubeNode';\n\nexport const INSERT_YOUTUBE_COMMAND: LexicalCommand<string> = createCommand();\n\nexport default function YouTubePlugin(): JSX.Element | null {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    if (!editor.hasNodes([YouTubeNode])) {\n      throw new Error('YouTubePlugin: YouTubeNode not registered on editor');\n    }\n\n    return editor.registerCommand<string>(\n      INSERT_YOUTUBE_COMMAND,\n      (payload) => {\n        const selection = $getSelection();\n        const youTubeNode = $createYouTubeNode(payload);\n        // if ($isRangeSelection(selection)) {\n        //   const focusNode = selection.focus.getNode();\n        //   focusNode.getTopLevelElementOrThrow().insertAfter(youTubeNode);\n        // } else if ($isNodeSelection(selection) || $isGridSelection(selection)) {\n        //   const nodes = selection.getNodes();\n        //   nodes[nodes.length - 1]\n        //     .getTopLevelElementOrThrow()\n        //     .insertAfter(youTubeNode);\n        // } else {\n        //   const root = $getRoot();\n        //   root.append(youTubeNode);\n        // }\n        const paragraphNode = $createParagraphNode();\n        youTubeNode.insertAfter(paragraphNode);\n        paragraphNode.select();\n\n        return true;\n      },\n      COMMAND_PRIORITY_EDITOR,\n    );\n  }, [editor]);\n\n  return null;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {InsertImagePayload} from './ImagesPlugin';\nimport type {\n  GridSelection,\n  LexicalEditor,\n  NodeSelection,\n  RangeSelection,\n} from 'lexical';\n\n// import './ToolbarPlugin.css';\n\nimport {$createCodeNode, $isCodeNode} from '@lexical/code';\nimport {$isLinkNode, TOGGLE_LINK_COMMAND} from '@lexical/link';\nimport {\n  $isListNode,\n  INSERT_CHECK_LIST_COMMAND,\n  INSERT_ORDERED_LIST_COMMAND,\n  INSERT_UNORDERED_LIST_COMMAND,\n  ListNode,\n  REMOVE_LIST_COMMAND,\n} from '@lexical/list';\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {$isDecoratorBlockNode} from '@lexical/react/LexicalDecoratorBlockNode';\nimport {INSERT_HORIZONTAL_RULE_COMMAND} from '@lexical/react/LexicalHorizontalRuleNode';\nimport {\n  $createHeadingNode,\n  $createQuoteNode,\n  $isHeadingNode,\n  HeadingTagType,\n} from '@lexical/rich-text';\nimport {\n  $getSelectionStyleValueForProperty,\n  $isAtNodeEnd,\n  $isParentElementRTL,\n  $patchStyleText,\n  $selectAll,\n  // $wrapLeafNodesInElements,\n} from '@lexical/selection';\nimport {INSERT_TABLE_COMMAND} from '@lexical/table';\nimport {\n  $getNearestBlockElementAncestorOrThrow,\n  $getNearestNodeOfType,\n  mergeRegister,\n} from '@lexical/utils';\nimport {\n  $createParagraphNode,\n  $getNodeByKey,\n  $getRoot,\n  $getSelection,\n  $isRangeSelection,\n  $isTextNode,\n  CAN_REDO_COMMAND,\n  CAN_UNDO_COMMAND,\n  COMMAND_PRIORITY_CRITICAL,\n  COMMAND_PRIORITY_LOW,\n  ElementNode,\n  FORMAT_ELEMENT_COMMAND,\n  FORMAT_TEXT_COMMAND,\n  INDENT_CONTENT_COMMAND,\n  NodeKey,\n  OUTDENT_CONTENT_COMMAND,\n  REDO_COMMAND,\n  SELECTION_CHANGE_COMMAND,\n  TextNode,\n  UNDO_COMMAND,\n} from 'lexical';\nimport * as React from 'react';\nimport {ChangeEvent, useCallback, useEffect, useRef, useState} from 'react';\nimport {createPortal} from 'react-dom';\nimport {IS_APPLE} from '../shared/src/environment';\n\nimport useModal from '../hooks/useModal';\nimport {$createStickyNode} from '../nodes/StickyNode';\nimport Button from '../ui/Button';\nimport ColorPicker from '../ui/ColorPicker';\nimport DropDown, {DropDownItem} from '../ui/DropDown';\nimport FileInput from '../ui/FileInput';\nimport KatexEquationAlterer from '../ui/KatexEquationAlterer';\nimport LinkPreview from '../ui/LinkPreview';\nimport TextInput from '../ui/TextInput';\nimport {INSERT_EQUATION_COMMAND} from './EquationsPlugin';\nimport {INSERT_EXCALIDRAW_COMMAND} from './ExcalidrawPlugin';\nimport {INSERT_IMAGE_COMMAND} from './ImagesPlugin';\nimport {INSERT_POLL_COMMAND} from './PollPlugin';\nimport {INSERT_TWEET_COMMAND} from './TwitterPlugin';\nimport {INSERT_YOUTUBE_COMMAND} from './YouTubePlugin';\n\nconst blockTypeToBlockName = {\n  bullet: 'Bulleted List',\n  check: 'Check List',\n  code: 'Code Block',\n  h1: 'Heading 1',\n  h2: 'Heading 2',\n  h3: 'Heading 3',\n  h4: 'Heading 4',\n  h5: 'Heading 5',\n  h6: 'Heading 6',\n  number: 'Numbered List',\n  paragraph: 'Normal',\n  quote: 'Quote',\n};\n\nconst CODE_LANGUAGE_OPTIONS: [string, string][] = [\n  ['', '- Select language -'],\n  ['c', 'C'],\n  ['clike', 'C-like'],\n  ['css', 'CSS'],\n  ['html', 'HTML'],\n  ['js', 'JavaScript'],\n  ['markdown', 'Markdown'],\n  ['objc', 'Objective-C'],\n  ['plain', 'Plain Text'],\n  ['py', 'Python'],\n  ['rust', 'Rust'],\n  ['sql', 'SQL'],\n  ['swift', 'Swift'],\n  ['xml', 'XML'],\n];\n\nconst CODE_LANGUAGE_MAP = {\n  javascript: 'js',\n  md: 'markdown',\n  plaintext: 'plain',\n  python: 'py',\n  text: 'plain',\n};\n\nfunction getSelectedNode(selection: RangeSelection): TextNode | ElementNode {\n  const anchor = selection.anchor;\n  const focus = selection.focus;\n  const anchorNode = selection.anchor.getNode();\n  const focusNode = selection.focus.getNode();\n  if (anchorNode === focusNode) {\n    return anchorNode;\n  }\n  const isBackward = selection.isBackward();\n  if (isBackward) {\n    return $isAtNodeEnd(focus) ? anchorNode : focusNode;\n  } else {\n    return $isAtNodeEnd(anchor) ? focusNode : anchorNode;\n  }\n}\n\nfunction positionEditorElement(\n  editor: HTMLElement,\n  rect: ClientRect | null,\n  rootElement: HTMLElement,\n): void {\n  if (rect === null) {\n    editor.style.opacity = '0';\n    editor.style.top = '-1000px';\n    editor.style.left = '-1000px';\n  } else {\n    editor.style.opacity = '1';\n    editor.style.top = `${rect.top + rect.height + window.pageYOffset + 10}px`;\n    const left = rect.left - editor.offsetWidth / 2 + rect.width / 2;\n    const rootElementRect = rootElement.getBoundingClientRect();\n    if (rootElementRect.left > left) {\n      editor.style.left = `${rect.left + window.pageXOffset}px`;\n    } else if (left + editor.offsetWidth > rootElementRect.right) {\n      editor.style.left = `${\n        rect.right + window.pageXOffset - editor.offsetWidth\n      }px`;\n    }\n  }\n}\n\nfunction FloatingLinkEditor({editor}: {editor: LexicalEditor}): JSX.Element {\n  const editorRef = useRef<HTMLDivElement | null>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const [linkUrl, setLinkUrl] = useState('');\n  const [isEditMode, setEditMode] = useState(false);\n  const [lastSelection, setLastSelection] = useState<\n    RangeSelection | GridSelection | NodeSelection | null\n  >(null);\n\n  const updateLinkEditor = useCallback(() => {\n    const selection = $getSelection();\n    if ($isRangeSelection(selection)) {\n      const node = getSelectedNode(selection);\n      const parent = node.getParent();\n      if ($isLinkNode(parent)) {\n        setLinkUrl(parent.getURL());\n      } else if ($isLinkNode(node)) {\n        setLinkUrl(node.getURL());\n      } else {\n        setLinkUrl('');\n      }\n    }\n    const editorElem = editorRef.current;\n    const nativeSelection = window.getSelection();\n    const activeElement = document.activeElement;\n\n    if (editorElem === null) {\n      return;\n    }\n\n    const rootElement = editor.getRootElement();\n    if (\n      selection !== null &&\n      nativeSelection !== null &&\n      !nativeSelection.isCollapsed &&\n      rootElement !== null &&\n      rootElement.contains(nativeSelection.anchorNode)\n    ) {\n      const domRange = nativeSelection.getRangeAt(0);\n      let rect;\n      if (nativeSelection.anchorNode === rootElement) {\n        let inner = rootElement;\n        while (inner.firstElementChild != null) {\n          inner = inner.firstElementChild as HTMLElement;\n        }\n        rect = inner.getBoundingClientRect();\n      } else {\n        rect = domRange.getBoundingClientRect();\n      }\n\n      positionEditorElement(editorElem, rect, rootElement);\n      // setLastSelection(selection);\n    } else if (!activeElement || activeElement.className !== 'link-input') {\n      if (rootElement !== null) {\n        positionEditorElement(editorElem, null, rootElement);\n      }\n      setLastSelection(null);\n      setEditMode(false);\n      setLinkUrl('');\n    }\n\n    return true;\n  }, [editor]);\n\n  useEffect(() => {\n    const onResize = () => {\n      editor.getEditorState().read(() => {\n        updateLinkEditor();\n      });\n    };\n    window.addEventListener('resize', onResize);\n\n    return () => {\n      window.removeEventListener('resize', onResize);\n    };\n  }, [editor, updateLinkEditor]);\n\n  useEffect(() => {\n    return mergeRegister(\n      editor.registerUpdateListener(({editorState}) => {\n        editorState.read(() => {\n          updateLinkEditor();\n        });\n      }),\n\n      editor.registerCommand(\n        SELECTION_CHANGE_COMMAND,\n        () => {\n          updateLinkEditor();\n          return true;\n        },\n        COMMAND_PRIORITY_LOW,\n      ),\n    );\n  }, [editor, updateLinkEditor]);\n\n  useEffect(() => {\n    editor.getEditorState().read(() => {\n      updateLinkEditor();\n    });\n  }, [editor, updateLinkEditor]);\n\n  useEffect(() => {\n    if (isEditMode && inputRef.current) {\n      inputRef.current.focus();\n    }\n  }, [isEditMode]);\n\n  return (\n    <div ref={editorRef} className=\"link-editor\">\n      {isEditMode ? (\n        <input\n          ref={inputRef}\n          className=\"link-input\"\n          value={linkUrl}\n          onChange={(event) => {\n            setLinkUrl(event.target.value);\n          }}\n          onKeyDown={(event) => {\n            if (event.key === 'Enter') {\n              event.preventDefault();\n              if (lastSelection !== null) {\n                if (linkUrl !== '') {\n                  editor.dispatchCommand(TOGGLE_LINK_COMMAND, linkUrl);\n                }\n                setEditMode(false);\n              }\n            } else if (event.key === 'Escape') {\n              event.preventDefault();\n              setEditMode(false);\n            }\n          }}\n        />\n      ) : (\n        <>\n          <div className=\"link-input\">\n            <a href={linkUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n              {linkUrl}\n            </a>\n            <div\n              className=\"link-edit\"\n              role=\"button\"\n              tabIndex={0}\n              onMouseDown={(event) => event.preventDefault()}\n              onClick={() => {\n                setEditMode(true);\n              }}\n            />\n          </div>\n          <LinkPreview url={linkUrl} />\n        </>\n      )}\n    </div>\n  );\n}\n\nfunction InsertImageUriDialogBody({\n  onClick,\n}: {\n  onClick: (payload: InsertImagePayload) => void;\n}) {\n  const [src, setSrc] = useState('');\n  const [altText, setAltText] = useState('');\n\n  const isDisabled = src === '';\n\n  return (\n    <>\n      <TextInput\n        label=\"Image URL\"\n        placeholder=\"i.e. https://source.unsplash.com/random\"\n        onChange={setSrc}\n        value={src}\n        data-test-id=\"image-modal-url-input\"\n      />\n      <TextInput\n        label=\"Alt Text\"\n        placeholder=\"Random unsplash image\"\n        onChange={setAltText}\n        value={altText}\n        data-test-id=\"image-modal-alt-text-input\"\n      />\n      <div className=\"ToolbarPlugin__dialogActions\">\n        <Button\n          data-test-id=\"image-modal-confirm-btn\"\n          disabled={isDisabled}\n          onClick={() => onClick({altText, src})}>\n          Confirm\n        </Button>\n      </div>\n    </>\n  );\n}\n\nfunction InsertImageUploadedDialogBody({\n  onClick,\n}: {\n  onClick: (payload: InsertImagePayload) => void;\n}) {\n  const [src, setSrc] = useState('');\n  const [altText, setAltText] = useState('');\n\n  const isDisabled = src === '';\n\n  const loadImage = (files: FileList | null) => {\n    const reader = new FileReader();\n    reader.onload = function () {\n      if (typeof reader.result === 'string') {\n        setSrc(reader.result);\n      }\n      return '';\n    };\n    if (files !== null) {\n      reader.readAsDataURL(files[0]);\n    }\n  };\n\n  return (\n    <>\n      <FileInput\n        label=\"Image Upload\"\n        onChange={loadImage}\n        accept=\"image/*\"\n        data-test-id=\"image-modal-file-upload\"\n      />\n      <TextInput\n        label=\"Alt Text\"\n        placeholder=\"Descriptive alternative text\"\n        onChange={setAltText}\n        value={altText}\n        data-test-id=\"image-modal-alt-text-input\"\n      />\n      <div className=\"ToolbarPlugin__dialogActions\">\n        <Button\n          data-test-id=\"image-modal-file-upload-btn\"\n          disabled={isDisabled}\n          onClick={() => onClick({altText, src})}>\n          Confirm\n        </Button>\n      </div>\n    </>\n  );\n}\n\nfunction InsertImageDialog({\n  activeEditor,\n  onClose,\n}: {\n  activeEditor: LexicalEditor;\n  onClose: () => void;\n}): JSX.Element {\n  const [mode, setMode] = useState<null | 'url' | 'file'>(null);\n\n  const onClick = (payload: InsertImagePayload) => {\n    activeEditor.dispatchCommand(INSERT_IMAGE_COMMAND, payload);\n    onClose();\n  };\n\n  return (\n    <>\n      {!mode && (\n        <div className=\"ToolbarPlugin__dialogButtonsList\">\n          {/* <Button\n            data-test-id=\"image-modal-option-sample\"\n            onClick={() =>\n              onClick({\n                altText: 'Yellow flower in tilt shift lens',\n                src: yellowFlowerImage,\n              })\n            }>\n            Sample\n          </Button> */}\n          <Button\n            data-test-id=\"image-modal-option-url\"\n            onClick={() => setMode('url')}>\n            URL\n          </Button>\n          <Button\n            data-test-id=\"image-modal-option-file\"\n            onClick={() => setMode('file')}>\n            File\n          </Button>\n        </div>\n      )}\n      {mode === 'url' && <InsertImageUriDialogBody onClick={onClick} />}\n      {mode === 'file' && <InsertImageUploadedDialogBody onClick={onClick} />}\n    </>\n  );\n}\n\nfunction InsertTableDialog({\n  activeEditor,\n  onClose,\n}: {\n  activeEditor: LexicalEditor;\n  onClose: () => void;\n}): JSX.Element {\n  const [rows, setRows] = useState('5');\n  const [columns, setColumns] = useState('5');\n\n  const onClick = () => {\n    activeEditor.dispatchCommand(INSERT_TABLE_COMMAND, {columns, rows});\n    onClose();\n  };\n\n  return (\n    <>\n      <TextInput label=\"No of rows\" onChange={setRows} value={rows} />\n      <TextInput label=\"No of columns\" onChange={setColumns} value={columns} />\n      <div\n        className=\"ToolbarPlugin__dialogActions\"\n        data-test-id=\"table-model-confirm-insert\">\n        <Button onClick={onClick}>Confirm</Button>\n      </div>\n    </>\n  );\n}\n\nfunction InsertPollDialog({\n  activeEditor,\n  onClose,\n}: {\n  activeEditor: LexicalEditor;\n  onClose: () => void;\n}): JSX.Element {\n  const [question, setQuestion] = useState('');\n\n  const onClick = () => {\n    activeEditor.dispatchCommand(INSERT_POLL_COMMAND, question);\n    onClose();\n  };\n\n  return (\n    <>\n      <TextInput label=\"Question\" onChange={setQuestion} value={question} />\n      <div className=\"ToolbarPlugin__dialogActions\">\n        <Button disabled={question.trim() === ''} onClick={onClick}>\n          Confirm\n        </Button>\n      </div>\n    </>\n  );\n}\n\nconst VALID_TWITTER_URL = /twitter.com\\/[0-9a-zA-Z]{1,20}\\/status\\/([0-9]*)/g;\n\nfunction InsertTweetDialog({\n  activeEditor,\n  onClose,\n}: {\n  activeEditor: LexicalEditor;\n  onClose: () => void;\n}): JSX.Element {\n  const [text, setText] = useState('');\n\n  const onClick = () => {\n    const tweetID = text.split('status/')?.[1]?.split('?')?.[0];\n    activeEditor.dispatchCommand(INSERT_TWEET_COMMAND, tweetID);\n    onClose();\n  };\n\n  const isDisabled = text === '' || !text.match(VALID_TWITTER_URL);\n\n  return (\n    <>\n      <TextInput\n        label=\"Tweet URL\"\n        placeholder=\"i.e. https://twitter.com/jack/status/20\"\n        onChange={setText}\n        value={text}\n      />\n      <div className=\"ToolbarPlugin__dialogActions\">\n        <Button disabled={isDisabled} onClick={onClick}>\n          Confirm\n        </Button>\n      </div>\n    </>\n  );\n}\n\n// Taken from https://stackoverflow.com/a/9102270\nconst YOUTUBE_ID_PARSER =\n  /^.*(youtu\\.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|&v=)([^#&?]*).*/;\n\nconst parseYouTubeVideoID = (url: string) => {\n  const urlMatches = url.match(YOUTUBE_ID_PARSER);\n\n  return urlMatches?.[2].length === 11 ? urlMatches[2] : null;\n};\n\nfunction InsertYouTubeDialog({\n  activeEditor,\n  onClose,\n}: {\n  activeEditor: LexicalEditor;\n  onClose: () => void;\n}): JSX.Element {\n  const [text, setText] = useState('');\n\n  const onClick = () => {\n    const videoID = parseYouTubeVideoID(text);\n    if (videoID) {\n      activeEditor.dispatchCommand(INSERT_YOUTUBE_COMMAND, videoID);\n    }\n    onClose();\n  };\n\n  const isDisabled = text === '' || !parseYouTubeVideoID(text);\n\n  return (\n    <>\n      <TextInput\n        data-test-id=\"youtube-embed-modal-url\"\n        label=\"YouTube URL\"\n        placeholder=\"i.e. https://www.youtube.com/watch?v=jNQXAC9IVRw\"\n        onChange={setText}\n        value={text}\n      />\n      <div className=\"ToolbarPlugin__dialogActions\">\n        <Button\n          data-test-id=\"youtube-embed-modal-submit-btn\"\n          disabled={isDisabled}\n          onClick={onClick}>\n          Confirm\n        </Button>\n      </div>\n    </>\n  );\n}\n\nfunction InsertEquationDialog({\n  activeEditor,\n  onClose,\n}: {\n  activeEditor: LexicalEditor;\n  onClose: () => void;\n}): JSX.Element {\n  const onEquationConfirm = useCallback(\n    (equation: string, inline: boolean) => {\n      activeEditor.dispatchCommand(INSERT_EQUATION_COMMAND, {equation, inline});\n      onClose();\n    },\n    [activeEditor, onClose],\n  );\n\n  return <KatexEquationAlterer onConfirm={onEquationConfirm} />;\n}\n\nfunction dropDownActiveClass(active: boolean) {\n  if (active) return 'active dropdown-item-active';\n  else return '';\n}\n\nfunction BlockFormatDropDown({\n  editor,\n  blockType,\n}: {\n  blockType: keyof typeof blockTypeToBlockName;\n  editor: LexicalEditor;\n}): JSX.Element {\n  const formatParagraph = () => {\n    if (blockType !== 'paragraph') {\n      editor.update(() => {\n        const selection = $getSelection();\n\n        if ($isRangeSelection(selection)) {\n          // $wrapLeafNodesInElements(selection, () => $createParagraphNode());\n        }\n      });\n    }\n  };\n\n  const formatHeading = (headingSize: HeadingTagType) => {\n    if (blockType !== headingSize) {\n      editor.update(() => {\n        const selection = $getSelection();\n\n        if ($isRangeSelection(selection)) {\n          // $wrapLeafNodesInElements(selection, () =>\n          //   $createHeadingNode(headingSize),\n          // );\n        }\n      });\n    }\n  };\n\n  const formatBulletList = () => {\n    if (blockType !== 'bullet') {\n      editor.dispatchCommand(INSERT_UNORDERED_LIST_COMMAND, undefined);\n    } else {\n      editor.dispatchCommand(REMOVE_LIST_COMMAND, undefined);\n    }\n  };\n\n  const formatCheckList = () => {\n    if (blockType !== 'check') {\n      editor.dispatchCommand(INSERT_CHECK_LIST_COMMAND, undefined);\n    } else {\n      editor.dispatchCommand(REMOVE_LIST_COMMAND, undefined);\n    }\n  };\n\n  const formatNumberedList = () => {\n    if (blockType !== 'number') {\n      editor.dispatchCommand(INSERT_ORDERED_LIST_COMMAND, undefined);\n    } else {\n      editor.dispatchCommand(REMOVE_LIST_COMMAND, undefined);\n    }\n  };\n\n  const formatQuote = () => {\n    if (blockType !== 'quote') {\n      editor.update(() => {\n        const selection = $getSelection();\n\n        if ($isRangeSelection(selection)) {\n          // $wrapLeafNodesInElements(selection, () => $createQuoteNode());\n        }\n      });\n    }\n  };\n\n  const formatCode = () => {\n    if (blockType !== 'code') {\n      editor.update(() => {\n        const selection = $getSelection();\n\n        if ($isRangeSelection(selection)) {\n          if (selection.isCollapsed()) {\n            // $wrapLeafNodesInElements(selection, () => $createCodeNode());\n          } else {\n            const textContent = selection.getTextContent();\n            const codeNode = $createCodeNode();\n            selection.insertNodes([codeNode]);\n            selection.insertRawText(textContent);\n          }\n        }\n      });\n    }\n  };\n\n  return (\n    <DropDown\n      buttonClassName=\"toolbar-item block-controls\"\n      buttonIconClassName={'icon block-type ' + blockType}\n      buttonLabel={blockTypeToBlockName[blockType]}\n      buttonAriaLabel=\"Formatting options for text style\">\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'paragraph')}\n        onClick={formatParagraph}>\n        <i className=\"icon paragraph\" />\n        <span className=\"text\">Normal</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'h1')}\n        onClick={() => formatHeading('h1')}>\n        <i className=\"icon h1\" />\n        <span className=\"text\">Heading 1</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'h2')}\n        onClick={() => formatHeading('h2')}>\n        <i className=\"icon h2\" />\n        <span className=\"text\">Heading 2</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'h3')}\n        onClick={() => formatHeading('h3')}>\n        <i className=\"icon h3\" />\n        <span className=\"text\">Heading 3</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'bullet')}\n        onClick={formatBulletList}>\n        <i className=\"icon bullet-list\" />\n        <span className=\"text\">Bullet List</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'number')}\n        onClick={formatNumberedList}>\n        <i className=\"icon numbered-list\" />\n        <span className=\"text\">Numbered List</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'check')}\n        onClick={formatCheckList}>\n        <i className=\"icon check-list\" />\n        <span className=\"text\">Check List</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'quote')}\n        onClick={formatQuote}>\n        <i className=\"icon quote\" />\n        <span className=\"text\">Quote</span>\n      </DropDownItem>\n      <DropDownItem\n        className={'item ' + dropDownActiveClass(blockType === 'code')}\n        onClick={formatCode}>\n        <i className=\"icon code\" />\n        <span className=\"text\">Code Block</span>\n      </DropDownItem>\n    </DropDown>\n  );\n}\n\nfunction Divider(): JSX.Element {\n  return <div className=\"divider\" />;\n}\n\nfunction Select({\n  onChange,\n  className,\n  options,\n  value,\n}: {\n  className: string;\n  onChange: (e: ChangeEvent) => void;\n  options: [string, string][];\n  value: string;\n}): JSX.Element {\n  return (\n    <select className={className} onChange={onChange} value={value}>\n      {options.map(([option, text]) => (\n        <option key={option} value={option}>\n          {text}\n        </option>\n      ))}\n    </select>\n  );\n}\n\nexport default function ToolbarPlugin(): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n  const [activeEditor, setActiveEditor] = useState(editor);\n  const [blockType, setBlockType] =\n    useState<keyof typeof blockTypeToBlockName>('paragraph');\n  const [selectedElementKey, setSelectedElementKey] = useState<NodeKey | null>(\n    null,\n  );\n  const [fontSize, setFontSize] = useState<string>('15px');\n  const [fontColor, setFontColor] = useState<string>('#000');\n  const [bgColor, setBgColor] = useState<string>('#fff');\n  const [fontFamily, setFontFamily] = useState<string>('Arial');\n  const [isLink, setIsLink] = useState(false);\n  const [isBold, setIsBold] = useState(false);\n  const [isItalic, setIsItalic] = useState(false);\n  const [isUnderline, setIsUnderline] = useState(false);\n  const [isStrikethrough, setIsStrikethrough] = useState(false);\n  const [isSubscript, setIsSubscript] = useState(false);\n  const [isSuperscript, setIsSuperscript] = useState(false);\n  const [isCode, setIsCode] = useState(false);\n  const [canUndo, setCanUndo] = useState(false);\n  const [canRedo, setCanRedo] = useState(false);\n  const [modal, showModal] = useModal();\n  const [isRTL, setIsRTL] = useState(false);\n  const [codeLanguage, setCodeLanguage] = useState<string>('');\n\n  const updateToolbar = useCallback(() => {\n    const selection = $getSelection();\n    if ($isRangeSelection(selection)) {\n      const anchorNode = selection.anchor.getNode();\n      const element =\n        anchorNode.getKey() === 'root'\n          ? anchorNode\n          : anchorNode.getTopLevelElementOrThrow();\n      const elementKey = element.getKey();\n      const elementDOM = activeEditor.getElementByKey(elementKey);\n\n      // Update text format\n      setIsBold(selection.hasFormat('bold'));\n      setIsItalic(selection.hasFormat('italic'));\n      setIsUnderline(selection.hasFormat('underline'));\n      setIsStrikethrough(selection.hasFormat('strikethrough'));\n      setIsSubscript(selection.hasFormat('subscript'));\n      setIsSuperscript(selection.hasFormat('superscript'));\n      setIsCode(selection.hasFormat('code'));\n      setIsRTL($isParentElementRTL(selection));\n\n      // Update links\n      const node = getSelectedNode(selection);\n      const parent = node.getParent();\n      if ($isLinkNode(parent) || $isLinkNode(node)) {\n        setIsLink(true);\n      } else {\n        setIsLink(false);\n      }\n\n      if (elementDOM !== null) {\n        setSelectedElementKey(elementKey);\n        if ($isListNode(element)) {\n          const parentList = $getNearestNodeOfType<ListNode>(\n            anchorNode,\n            ListNode,\n          );\n          const type = parentList\n            ? parentList.getListType()\n            : element.getListType();\n          setBlockType(type);\n        } else {\n          const type = $isHeadingNode(element)\n            ? element.getTag()\n            : element.getType();\n          if (type in blockTypeToBlockName) {\n            setBlockType(type as keyof typeof blockTypeToBlockName);\n          }\n          if ($isCodeNode(element)) {\n            const language =\n              element.getLanguage() as keyof typeof CODE_LANGUAGE_MAP;\n            setCodeLanguage(\n              language ? CODE_LANGUAGE_MAP[language] || language : '',\n            );\n            return;\n          }\n        }\n      }\n      // Handle buttons\n      setFontSize(\n        $getSelectionStyleValueForProperty(selection, 'font-size', '15px'),\n      );\n      setFontColor(\n        $getSelectionStyleValueForProperty(selection, 'color', '#000'),\n      );\n      setBgColor(\n        $getSelectionStyleValueForProperty(\n          selection,\n          'background-color',\n          '#fff',\n        ),\n      );\n      setFontFamily(\n        $getSelectionStyleValueForProperty(selection, 'font-family', 'Arial'),\n      );\n    }\n  }, [activeEditor]);\n\n  useEffect(() => {\n    return editor.registerCommand(\n      SELECTION_CHANGE_COMMAND,\n      (_payload, newEditor) => {\n        updateToolbar();\n        setActiveEditor(newEditor);\n        return false;\n      },\n      COMMAND_PRIORITY_CRITICAL,\n    );\n  }, [editor, updateToolbar]);\n\n  useEffect(() => {\n    return mergeRegister(\n      activeEditor.registerUpdateListener(({editorState}) => {\n        editorState.read(() => {\n          updateToolbar();\n        });\n      }),\n      activeEditor.registerCommand<boolean>(\n        CAN_UNDO_COMMAND,\n        (payload) => {\n          setCanUndo(payload);\n          return false;\n        },\n        COMMAND_PRIORITY_CRITICAL,\n      ),\n      activeEditor.registerCommand<boolean>(\n        CAN_REDO_COMMAND,\n        (payload) => {\n          setCanRedo(payload);\n          return false;\n        },\n        COMMAND_PRIORITY_CRITICAL,\n      ),\n    );\n  }, [activeEditor, updateToolbar]);\n\n  const applyStyleText = useCallback(\n    (styles: Record<string, string>) => {\n      activeEditor.update(() => {\n        const selection = $getSelection();\n        if ($isRangeSelection(selection)) {\n          $patchStyleText(selection, styles);\n        }\n      });\n    },\n    [activeEditor],\n  );\n\n  const clearFormatting = useCallback(() => {\n    activeEditor.update(() => {\n      const selection = $getSelection();\n      if ($isRangeSelection(selection)) {\n        $selectAll(selection);\n        selection.getNodes().forEach((node) => {\n          if ($isTextNode(node)) {\n            node.setFormat(0);\n            node.setStyle('');\n            $getNearestBlockElementAncestorOrThrow(node).setFormat('');\n          }\n          if ($isDecoratorBlockNode(node)) {\n            node.setFormat('');\n          }\n        });\n      }\n    });\n  }, [activeEditor]);\n\n  const onFontSizeSelect = useCallback(\n    (e: ChangeEvent) => {\n      applyStyleText({'font-size': (e.target as HTMLSelectElement).value});\n    },\n    [applyStyleText],\n  );\n\n  const onFontColorSelect = useCallback(\n    (value: string) => {\n      applyStyleText({color: value});\n    },\n    [applyStyleText],\n  );\n\n  const onBgColorSelect = useCallback(\n    (value: string) => {\n      applyStyleText({'background-color': value});\n    },\n    [applyStyleText],\n  );\n\n  const onFontFamilySelect = useCallback(\n    (e: ChangeEvent) => {\n      applyStyleText({'font-family': (e.target as HTMLSelectElement).value});\n    },\n    [applyStyleText],\n  );\n\n  const insertLink = useCallback(() => {\n    if (!isLink) {\n      editor.dispatchCommand(TOGGLE_LINK_COMMAND, 'https://');\n    } else {\n      editor.dispatchCommand(TOGGLE_LINK_COMMAND, null);\n    }\n  }, [editor, isLink]);\n\n  const onCodeLanguageSelect = useCallback(\n    (e: ChangeEvent) => {\n      activeEditor.update(() => {\n        if (selectedElementKey !== null) {\n          const node = $getNodeByKey(selectedElementKey);\n          if ($isCodeNode(node)) {\n            node.setLanguage((e.target as HTMLSelectElement).value);\n          }\n        }\n      });\n    },\n    [activeEditor, selectedElementKey],\n  );\n  const insertGifOnClick = (payload: InsertImagePayload) => {\n    activeEditor.dispatchCommand(INSERT_IMAGE_COMMAND, payload);\n  };\n\n  return (\n    <div className=\"toolbar\">\n      <button\n        disabled={!canUndo}\n        onClick={() => {\n          activeEditor.dispatchCommand(UNDO_COMMAND, undefined);\n        }}\n        title={IS_APPLE ? 'Undo (⌘Z)' : 'Undo (Ctrl+Z)'}\n        className=\"toolbar-item spaced\"\n        aria-label=\"Undo\">\n        <i className=\"format undo\" />\n      </button>\n      <button\n        disabled={!canRedo}\n        onClick={() => {\n          activeEditor.dispatchCommand(REDO_COMMAND, undefined);\n        }}\n        title={IS_APPLE ? 'Redo (⌘Y)' : 'Undo (Ctrl+Y)'}\n        className=\"toolbar-item\"\n        aria-label=\"Redo\">\n        <i className=\"format redo\" />\n      </button>\n      <Divider />\n      {blockType in blockTypeToBlockName && activeEditor === editor && (\n        <>\n          <BlockFormatDropDown blockType={blockType} editor={editor} />\n          <Divider />\n        </>\n      )}\n      {blockType === 'code' ? (\n        <>\n          <Select\n            className=\"toolbar-item code-language\"\n            onChange={onCodeLanguageSelect}\n            options={CODE_LANGUAGE_OPTIONS}\n            value={codeLanguage}\n          />\n          <i className=\"chevron-down inside\" />\n        </>\n      ) : (\n        <>\n          <>\n            <Select\n              className=\"toolbar-item font-family\"\n              onChange={onFontFamilySelect}\n              options={[\n                ['Arial', 'Arial'],\n                ['Courier New', 'Courier New'],\n                ['Georgia', 'Georgia'],\n                ['Times New Roman', 'Times New Roman'],\n                ['Trebuchet MS', 'Trebuchet MS'],\n                ['Verdana', 'Verdana'],\n              ]}\n              value={fontFamily}\n            />\n            <i className=\"chevron-down inside\" />\n          </>\n          <>\n            <Select\n              className=\"toolbar-item font-size\"\n              onChange={onFontSizeSelect}\n              options={[\n                ['10px', '10px'],\n                ['11px', '11px'],\n                ['12px', '12px'],\n                ['13px', '13px'],\n                ['14px', '14px'],\n                ['15px', '15px'],\n                ['16px', '16px'],\n                ['17px', '17px'],\n                ['18px', '18px'],\n                ['19px', '19px'],\n                ['20px', '20px'],\n              ]}\n              value={fontSize}\n            />\n            <i className=\"chevron-down inside\" />\n          </>\n          <Divider />\n          <button\n            onClick={() => {\n              activeEditor.dispatchCommand(FORMAT_TEXT_COMMAND, 'bold');\n            }}\n            className={'toolbar-item spaced ' + (isBold ? 'active' : '')}\n            title={IS_APPLE ? 'Bold (⌘B)' : 'Bold (Ctrl+B)'}\n            aria-label={`Format text as bold. Shortcut: ${\n              IS_APPLE ? '⌘B' : 'Ctrl+B'\n            }`}>\n            <i className=\"format bold\" />\n          </button>\n          <button\n            onClick={() => {\n              activeEditor.dispatchCommand(FORMAT_TEXT_COMMAND, 'italic');\n            }}\n            className={'toolbar-item spaced ' + (isItalic ? 'active' : '')}\n            title={IS_APPLE ? 'Italic (⌘I)' : 'Italic (Ctrl+I)'}\n            aria-label={`Format text as italics. Shortcut: ${\n              IS_APPLE ? '⌘I' : 'Ctrl+I'\n            }`}>\n            <i className=\"format italic\" />\n          </button>\n          <button\n            onClick={() => {\n              activeEditor.dispatchCommand(FORMAT_TEXT_COMMAND, 'underline');\n            }}\n            className={'toolbar-item spaced ' + (isUnderline ? 'active' : '')}\n            title={IS_APPLE ? 'Underline (⌘U)' : 'Underline (Ctrl+U)'}\n            aria-label={`Format text to underlined. Shortcut: ${\n              IS_APPLE ? '⌘U' : 'Ctrl+U'\n            }`}>\n            <i className=\"format underline\" />\n          </button>\n          <button\n            onClick={() => {\n              activeEditor.dispatchCommand(FORMAT_TEXT_COMMAND, 'code');\n            }}\n            className={'toolbar-item spaced ' + (isCode ? 'active' : '')}\n            title=\"Insert code block\"\n            aria-label=\"Insert code block\">\n            <i className=\"format code\" />\n          </button>\n          <button\n            onClick={insertLink}\n            className={'toolbar-item spaced ' + (isLink ? 'active' : '')}\n            aria-label=\"Insert link\"\n            title=\"Insert link\">\n            <i className=\"format link\" />\n          </button>\n          {isLink &&\n            createPortal(\n              <FloatingLinkEditor editor={activeEditor} />,\n              document.body,\n            )}\n          <ColorPicker\n            buttonClassName=\"toolbar-item color-picker\"\n            buttonAriaLabel=\"Formatting text color\"\n            buttonIconClassName=\"icon font-color\"\n            color={fontColor}\n            onChange={onFontColorSelect}\n            title=\"text color\"\n          />\n          <ColorPicker\n            buttonClassName=\"toolbar-item color-picker\"\n            buttonAriaLabel=\"Formatting background color\"\n            buttonIconClassName=\"icon bg-color\"\n            color={bgColor}\n            onChange={onBgColorSelect}\n            title=\"bg color\"\n          />\n          <DropDown\n            buttonClassName=\"toolbar-item spaced\"\n            buttonLabel=\"\"\n            buttonAriaLabel=\"Formatting options for additional text styles\"\n            buttonIconClassName=\"icon dropdown-more\">\n            <DropDownItem\n              onClick={() => {\n                activeEditor.dispatchCommand(\n                  FORMAT_TEXT_COMMAND,\n                  'strikethrough',\n                );\n              }}\n              className={'item ' + dropDownActiveClass(isStrikethrough)}\n              title=\"Strikethrough\"\n              aria-label=\"Format text with a strikethrough\">\n              <i className=\"icon strikethrough\" />\n              <span className=\"text\">Strikethrough</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                activeEditor.dispatchCommand(FORMAT_TEXT_COMMAND, 'subscript');\n              }}\n              className={'item ' + dropDownActiveClass(isSubscript)}\n              title=\"Subscript\"\n              aria-label=\"Format text with a subscript\">\n              <i className=\"icon subscript\" />\n              <span className=\"text\">Subscript</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                activeEditor.dispatchCommand(\n                  FORMAT_TEXT_COMMAND,\n                  'superscript',\n                );\n              }}\n              className={'item ' + dropDownActiveClass(isSuperscript)}\n              title=\"Superscript\"\n              aria-label=\"Format text with a superscript\">\n              <i className=\"icon superscript\" />\n              <span className=\"text\">Superscript</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={clearFormatting}\n              className=\"item\"\n              title=\"Clear text formatting\"\n              aria-label=\"Clear all text formatting\">\n              <i className=\"icon clear\" />\n              <span className=\"text\">Clear Formatting</span>\n            </DropDownItem>\n          </DropDown>\n          <Divider />\n          <DropDown\n            buttonClassName=\"toolbar-item spaced\"\n            buttonLabel=\"Insert\"\n            buttonAriaLabel=\"Insert specialized editor node\"\n            buttonIconClassName=\"icon plus\">\n            <DropDownItem\n              onClick={() => {\n                activeEditor.dispatchCommand(\n                  INSERT_HORIZONTAL_RULE_COMMAND,\n                  undefined,\n                );\n              }}\n              className=\"item\">\n              <i className=\"icon horizontal-rule\" />\n              <span className=\"text\">Horizontal Rule</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                showModal('Insert Image', (onClose) => (\n                  <InsertImageDialog\n                    activeEditor={activeEditor}\n                    onClose={onClose}\n                  />\n                ));\n              }}\n              className=\"item\">\n              <i className=\"icon image\" />\n              <span className=\"text\">Image</span>\n            </DropDownItem>\n            {/* <DropDownItem\n              onClick={() =>\n                insertGifOnClick({\n                  altText: 'Cat typing on a laptop',\n                  src: catTypingGif,\n                })\n              }\n              className=\"item\">\n              <i className=\"icon gif\" />\n              <span className=\"text\">GIF</span>\n            </DropDownItem> */}\n            <DropDownItem\n              onClick={() => {\n                activeEditor.dispatchCommand(\n                  INSERT_EXCALIDRAW_COMMAND,\n                  undefined,\n                );\n              }}\n              className=\"item\">\n              <i className=\"icon diagram-2\" />\n              <span className=\"text\">Excalidraw</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                showModal('Insert Table', (onClose) => (\n                  <InsertTableDialog\n                    activeEditor={activeEditor}\n                    onClose={onClose}\n                  />\n                ));\n              }}\n              className=\"item\">\n              <i className=\"icon table\" />\n              <span className=\"text\">Table</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                showModal('Insert Poll', (onClose) => (\n                  <InsertPollDialog\n                    activeEditor={activeEditor}\n                    onClose={onClose}\n                  />\n                ));\n              }}\n              className=\"item\">\n              <i className=\"icon poll\" />\n              <span className=\"text\">Poll</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                showModal('Insert Tweet', (onClose) => (\n                  <InsertTweetDialog\n                    activeEditor={activeEditor}\n                    onClose={onClose}\n                  />\n                ));\n              }}\n              className=\"item\">\n              <i className=\"icon tweet\" />\n              <span className=\"text\">Tweet</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                showModal('Insert YouTube Video', (onClose) => (\n                  <InsertYouTubeDialog\n                    activeEditor={activeEditor}\n                    onClose={onClose}\n                  />\n                ));\n              }}\n              className=\"item\">\n              <i className=\"icon youtube\" />\n              <span className=\"text\">YouTube Video</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                showModal('Insert Equation', (onClose) => (\n                  <InsertEquationDialog\n                    activeEditor={activeEditor}\n                    onClose={onClose}\n                  />\n                ));\n              }}\n              className=\"item\">\n              <i className=\"icon equation\" />\n              <span className=\"text\">Equation</span>\n            </DropDownItem>\n            <DropDownItem\n              onClick={() => {\n                editor.update(() => {\n                  const root = $getRoot();\n                  const stickyNode = $createStickyNode(0, 0);\n                  root.append(stickyNode);\n                });\n              }}\n              className=\"item\">\n              <i className=\"icon sticky\" />\n              <span className=\"text\">Sticky Note</span>\n            </DropDownItem>\n          </DropDown>\n        </>\n      )}\n      <Divider />\n      <DropDown\n        buttonLabel=\"Align\"\n        buttonIconClassName=\"icon left-align\"\n        buttonClassName=\"toolbar-item spaced alignment\"\n        buttonAriaLabel=\"Formatting options for text alignment\">\n        <DropDownItem\n          onClick={() => {\n            activeEditor.dispatchCommand(FORMAT_ELEMENT_COMMAND, 'left');\n          }}\n          className=\"item\">\n          <i className=\"icon left-align\" />\n          <span className=\"text\">Left Align</span>\n        </DropDownItem>\n        <DropDownItem\n          onClick={() => {\n            activeEditor.dispatchCommand(FORMAT_ELEMENT_COMMAND, 'center');\n          }}\n          className=\"item\">\n          <i className=\"icon center-align\" />\n          <span className=\"text\">Center Align</span>\n        </DropDownItem>\n        <DropDownItem\n          onClick={() => {\n            activeEditor.dispatchCommand(FORMAT_ELEMENT_COMMAND, 'right');\n          }}\n          className=\"item\">\n          <i className=\"icon right-align\" />\n          <span className=\"text\">Right Align</span>\n        </DropDownItem>\n        <DropDownItem\n          onClick={() => {\n            activeEditor.dispatchCommand(FORMAT_ELEMENT_COMMAND, 'justify');\n          }}\n          className=\"item\">\n          <i className=\"icon justify-align\" />\n          <span className=\"text\">Justify Align</span>\n        </DropDownItem>\n        <Divider />\n        <DropDownItem\n          onClick={() => {\n            activeEditor.dispatchCommand(OUTDENT_CONTENT_COMMAND, undefined);\n          }}\n          className=\"item\">\n          <i className={'icon ' + (isRTL ? 'indent' : 'outdent')} />\n          <span className=\"text\">Outdent</span>\n        </DropDownItem>\n        <DropDownItem\n          onClick={() => {\n            activeEditor.dispatchCommand(INDENT_CONTENT_COMMAND, undefined);\n          }}\n          className=\"item\">\n          <i className={'icon ' + (isRTL ? 'outdent' : 'indent')} />\n          <span className=\"text\">Indent</span>\n        </DropDownItem>\n      </DropDown>\n\n      {modal}\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\n// import './Placeholder.css';\n\nimport * as React from 'react';\nimport {ReactNode} from 'react';\n\nexport default function Placeholder({\n  children,\n  className,\n}: {\n  children: ReactNode;\n  className?: string;\n}): JSX.Element {\n  return <div className={className || 'Placeholder__root'}>{children}</div>;\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {AutoFocusPlugin} from '@lexical/react/LexicalAutoFocusPlugin';\nimport {CharacterLimitPlugin} from '@lexical/react/LexicalCharacterLimitPlugin';\nimport {CheckListPlugin} from '@lexical/react/LexicalCheckListPlugin';\nimport {ClearEditorPlugin} from '@lexical/react/LexicalClearEditorPlugin';\nimport {CollaborationPlugin} from '@lexical/react/LexicalCollaborationPlugin';\nimport {HashtagPlugin} from '@lexical/react/LexicalHashtagPlugin';\nimport {HistoryPlugin} from '@lexical/react/LexicalHistoryPlugin';\nimport {LinkPlugin} from '@lexical/react/LexicalLinkPlugin';\nimport {ListPlugin} from '@lexical/react/LexicalListPlugin';\nimport {PlainTextPlugin} from '@lexical/react/LexicalPlainTextPlugin';\nimport {RichTextPlugin} from '@lexical/react/LexicalRichTextPlugin';\nimport {TablePlugin} from '@lexical/react/LexicalTablePlugin';\nimport * as React from 'react';\nimport {useRef} from 'react';\n\nimport {createWebsocketProvider} from './collaboration';\nimport {useSettings} from './context/SettingsContext';\nimport {useSharedHistoryContext} from './context/SharedHistoryContext';\nimport ActionsPlugin from './plugins/ActionsPlugin';\nimport AutocompletePlugin from './plugins/AutocompletePlugin';\nimport AutoLinkPlugin from './plugins/AutoLinkPlugin';\nimport ClickableLinkPlugin from './plugins/ClickableLinkPlugin';\nimport CodeHighlightPlugin from './plugins/CodeHighlightPlugin';\n// import CommentPlugin from './plugins/CommentPlugin';\nimport EmojisPlugin from './plugins/EmojisPlugin';\nimport EquationsPlugin from './plugins/EquationsPlugin';\nimport ExcalidrawPlugin from './plugins/ExcalidrawPlugin';\nimport HorizontalRulePlugin from './plugins/HorizontalRulePlugin';\nimport ImagesPlugin from './plugins/ImagesPlugin';\nimport KeywordsPlugin from './plugins/KeywordsPlugin';\nimport ListMaxIndentLevelPlugin from './plugins/ListMaxIndentLevelPlugin';\n// import MarkdownShortcutPlugin from './plugins/MarkdownShortcutPlugin';\nimport {MaxLengthPlugin} from './plugins/MaxLengthPlugin';\nimport MentionsPlugin from './plugins/MentionsPlugin';\nimport PollPlugin from './plugins/PollPlugin';\nimport SpeechToTextPlugin from './plugins/SpeechToTextPlugin';\nimport TabFocusPlugin from './plugins/TabFocusPlugin';\nimport TableCellActionMenuPlugin from './plugins/TableActionMenuPlugin';\nimport TableCellResizer from './plugins/TableCellResizer';\nimport TextFormatFloatingToolbarPlugin from './plugins/TextFormatFloatingToolbarPlugin';\nimport ToolbarPlugin from './plugins/ToolbarPlugin';\n// import TreeViewPlugin from './plugins/TreeViewPlugin';\nimport TwitterPlugin from './plugins/TwitterPlugin';\nimport YouTubePlugin from './plugins/YouTubePlugin';\nimport ContentEditable from './ui/ContentEditable';\nimport Placeholder from './ui/Placeholder';\n\nconst skipCollaborationInit =\n  // @ts-ignore\n  window.parent != null && window.parent.frames.right === window;\n\nexport default function Editor(): JSX.Element {\n  const {historyState} = useSharedHistoryContext();\n  const {\n    settings: {\n      isCollab,\n      isAutocomplete,\n      isMaxLength,\n      isCharLimit,\n      isCharLimitUtf8,\n      isRichText,\n      showTreeView,\n    },\n  } = useSettings();\n  const text = isCollab\n    ? 'Enter some collaborative rich text...'\n    : isRichText\n    ? 'Enter some rich text...'\n    : 'Enter some plain text...';\n  const placeholder = <Placeholder>{text}</Placeholder>;\n  const scrollRef = useRef(null);\n\n  return (\n    <>\n      {isRichText && <ToolbarPlugin />}\n      <div\n        className={`editor-container ${showTreeView ? 'tree-view' : ''} ${\n          !isRichText ? 'plain-text' : ''\n        }`}\n        ref={scrollRef}>\n        {isMaxLength && <MaxLengthPlugin maxLength={30} />}\n        <AutoFocusPlugin />\n        <ClearEditorPlugin />\n        <MentionsPlugin />\n        <EmojisPlugin />\n        <HashtagPlugin />\n        <KeywordsPlugin />\n        <SpeechToTextPlugin />\n        <AutoLinkPlugin />\n        {/* <CommentPlugin\n          providerFactory={isCollab ? createWebsocketProvider : undefined}\n        /> */}\n        {isRichText ? (\n          <>\n   \n            {/* <MarkdownShortcutPlugin /> */}\n            <CodeHighlightPlugin />\n            <ListPlugin />\n            <CheckListPlugin />\n            <ListMaxIndentLevelPlugin maxDepth={7} />\n            <TablePlugin />\n            <TableCellActionMenuPlugin />\n            <TableCellResizer />\n            <ImagesPlugin />\n            <LinkPlugin />\n            <PollPlugin />\n            <TwitterPlugin />\n            <YouTubePlugin />\n            <ClickableLinkPlugin />\n            <HorizontalRulePlugin />\n            <TextFormatFloatingToolbarPlugin />\n            <EquationsPlugin />\n            <ExcalidrawPlugin />\n            <TabFocusPlugin />\n          </>\n        ) : (\n          <>\n        \n            <HistoryPlugin externalHistoryState={historyState} />\n          </>\n        )}\n   \n        {isAutocomplete && <AutocompletePlugin />}\n        <ActionsPlugin isRichText={isRichText} />\n      </div>\n      {/* {showTreeView && <TreeViewPlugin />} */}\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {Spread} from 'lexical';\n\nimport {EditorConfig, SerializedTextNode, TextNode} from 'lexical';\n\nexport type SerializedTypeaheadNode = Spread<\n  {\n    type: 'typeahead';\n    version: 1;\n  },\n  SerializedTextNode\n>;\n\nexport class TypeaheadNode extends TextNode {\n  static clone(node: TypeaheadNode): TypeaheadNode {\n    return new TypeaheadNode(node.__text, node.__key);\n  }\n\n  static getType(): 'typeahead' {\n    return 'typeahead';\n  }\n\n  // static importJSON(serializedNode: SerializedTypeaheadNode): TypeaheadNode {\n  //   // const node = $createTypeaheadNode(serializedNode.text);\n  //   node.setFormat(serializedNode.format);\n  //   node.setDetail(serializedNode.detail);\n  //   node.setMode(serializedNode.mode);\n  //   node.setStyle(serializedNode.style);\n  //   return node;\n  // }\n\n  exportJSON(): SerializedTypeaheadNode {\n    return {\n      ...super.exportJSON(),\n      type: 'typeahead',\n      version: 1,\n    };\n  }\n\n  createDOM(config: EditorConfig): HTMLElement {\n    const dom = super.createDOM(config);\n    dom.style.cssText = 'color: #ccc;';\n    return dom;\n  }\n}\n\n// export function $createTypeaheadNode(text: string): TypeaheadNode {\n//   return new TypeaheadNode(text).setMode('inert');\n// }\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {Klass, LexicalNode} from 'lexical';\n\nimport {CodeHighlightNode, CodeNode} from '@lexical/code';\nimport {HashtagNode} from '@lexical/hashtag';\nimport {AutoLinkNode, LinkNode} from '@lexical/link';\nimport {ListItemNode, ListNode} from '@lexical/list';\nimport {MarkNode} from '@lexical/mark';\nimport {OverflowNode} from '@lexical/overflow';\nimport {HorizontalRuleNode} from '@lexical/react/LexicalHorizontalRuleNode';\nimport {HeadingNode, QuoteNode} from '@lexical/rich-text';\nimport {TableCellNode, TableNode, TableRowNode} from '@lexical/table';\n\nimport {AutocompleteNode} from './AutocompleteNode';\nimport {EmojiNode} from './EmojiNode';\nimport {EquationNode} from './EquationNode';\nimport {ExcalidrawNode} from './ExcalidrawNode';\nimport {ImageNode} from './ImageNode';\nimport {KeywordNode} from './KeywordNode';\nimport {MentionNode} from './MentionNode';\nimport {PollNode} from './PollNode';\nimport {StickyNode} from './StickyNode';\nimport {TweetNode} from './TweetNode';\nimport {TypeaheadNode} from './TypeaheadNode';\nimport {YouTubeNode} from './YouTubeNode';\n\nconst PlaygroundNodes: Array<Klass<LexicalNode>> = [\n  HeadingNode,\n  ListNode,\n  ListItemNode,\n  QuoteNode,\n  CodeNode,\n  TableNode,\n  TableCellNode,\n  TableRowNode,\n  HashtagNode,\n  CodeHighlightNode,\n  AutoLinkNode,\n  LinkNode,\n  OverflowNode,\n  PollNode,\n  StickyNode,\n  ImageNode,\n  MentionNode,\n  EmojiNode,\n  ExcalidrawNode,\n  EquationNode,\n  AutocompleteNode,\n  TypeaheadNode,\n  KeywordNode,\n  HorizontalRuleNode,\n  TweetNode,\n  YouTubeNode,\n  MarkNode,\n];\n\nexport default PlaygroundNodes;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {\n  GridSelection,\n  LexicalEditor,\n  NodeSelection,\n  RangeSelection,\n} from 'lexical';\n\nimport {useLexicalComposerContext} from '@lexical/react/LexicalComposerContext';\nimport {$createParagraphNode, $createTextNode, $getRoot} from 'lexical';\nimport * as React from 'react';\nimport {useCallback, useEffect, useRef, useState} from 'react';\nimport {IS_APPLE} from '../shared/src/environment';\nimport useLayoutEffect from '../shared/src/useLayoutEffect';\n\nconst copy = (text: string | null) => {\n  const textArea = document.createElement('textarea');\n  textArea.value = text || '';\n  textArea.style.position = 'absolute';\n  textArea.style.opacity = '0';\n  document.body?.appendChild(textArea);\n  textArea.focus();\n  textArea.select();\n  try {\n    const result = document.execCommand('copy');\n    // eslint-disable-next-line no-console\n    console.log(result);\n  } catch (error) {\n    console.error(error);\n  }\n  document.body?.removeChild(textArea);\n};\n\nconst download = (filename: string, text: string | null) => {\n  const a = document.createElement('a');\n  a.setAttribute(\n    'href',\n    'data:text/plain;charset=utf-8,' + encodeURIComponent(text || ''),\n  );\n  a.setAttribute('download', filename);\n  a.style.display = 'none';\n  document.body?.appendChild(a);\n  a.click();\n  document.body?.removeChild(a);\n};\n\nconst formatStep = (step: Step) => {\n  const formatOneStep = (name: string, value: Step['value']) => {\n    switch (name) {\n      case 'click': {\n        return `      await page.mouse.click(${value.x}, ${value.y});`;\n      }\n      case 'press': {\n        return `      await page.keyboard.press('${value}');`;\n      }\n      case 'keydown': {\n        return `      await page.keyboard.keydown('${value}');`;\n      }\n      case 'keyup': {\n        return `      await page.keyboard.keyup('${value}');`;\n      }\n      case 'type': {\n        return `      await page.keyboard.type('${value}');`;\n      }\n      case 'selectAll': {\n        return `      await selectAll(page);`;\n      }\n      case 'snapshot': {\n        return `      await assertHTMLSnapshot(page);\n      await assertSelection(page, {\n        anchorPath: [${value.anchorPath.toString()}],\n        anchorOffset: ${value.anchorOffset},\n        focusPath: [${value.focusPath.toString()}],\n        focusOffset: ${value.focusOffset},\n      });\n`;\n      }\n      default:\n        return ``;\n    }\n  };\n  const formattedStep = formatOneStep(step.name, step.value);\n  switch (step.count) {\n    case 1:\n      return formattedStep;\n    case 2:\n      return [formattedStep, formattedStep].join(`\\n`);\n    default:\n      return `      await repeat(${step.count}, async () => {\n  ${formattedStep}\n      );`;\n  }\n};\n\nexport function isSelectAll(event: KeyboardEvent): boolean {\n  return event.keyCode === 65 && (IS_APPLE ? event.metaKey : event.ctrlKey);\n}\n\n// stolen from LexicalSelection-test\nfunction sanitizeSelection(selection: Selection) {\n  const {anchorNode, focusNode} = selection;\n  let {anchorOffset, focusOffset} = selection;\n  if (anchorOffset !== 0) {\n    anchorOffset--;\n  }\n  if (focusOffset !== 0) {\n    focusOffset--;\n  }\n  return {anchorNode, anchorOffset, focusNode, focusOffset};\n}\n\nfunction getPathFromNodeToEditor(node: Node, rootElement: HTMLElement | null) {\n  let currentNode: Node | null | undefined = node;\n  const path = [];\n  while (currentNode !== rootElement) {\n    if (currentNode !== null && currentNode !== undefined) {\n      path.unshift(\n        Array.from(currentNode?.parentNode?.childNodes ?? []).indexOf(\n          currentNode as ChildNode,\n        ),\n      );\n    }\n    currentNode = currentNode?.parentNode;\n  }\n  return path;\n}\n\nconst keyPresses = new Set([\n  'Enter',\n  'Backspace',\n  'Delete',\n  'Escape',\n  'ArrowLeft',\n  'ArrowRight',\n  'ArrowUp',\n  'ArrowDown',\n]);\n\ntype Step = {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  value: any;\n  count: number;\n  name: string;\n};\n\ntype Steps = Step[];\n\nfunction useTestRecorder(\n  editor: LexicalEditor,\n): [JSX.Element, JSX.Element | null] {\n  const [steps, setSteps] = useState<Steps>([]);\n  const [isRecording, setIsRecording] = useState(false);\n  const [, setCurrentInnerHTML] = useState('');\n  const [templatedTest, setTemplatedTest] = useState('');\n  const previousSelectionRef = useRef<\n    RangeSelection | GridSelection | NodeSelection | null\n  >(null);\n  const skipNextSelectionChangeRef = useRef(false);\n  const preRef = useRef<HTMLPreElement>(null);\n\n  const getCurrentEditor = useCallback(() => {\n    return editor;\n  }, [editor]);\n\n  const generateTestContent = useCallback(() => {\n    const rootElement = editor.getRootElement();\n    const browserSelection = window.getSelection();\n\n    if (\n      rootElement == null ||\n      browserSelection == null ||\n      browserSelection.anchorNode == null ||\n      browserSelection.focusNode == null ||\n      !rootElement.contains(browserSelection.anchorNode) ||\n      !rootElement.contains(browserSelection.focusNode)\n    ) {\n      return null;\n    }\n\n    return `\n/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {\n  initializeE2E,\n  assertHTMLSnapshot,\n  assertSelection,\n  repeat,\n} from '../utils';\nimport {selectAll} from '../keyboardShortcuts';\nimport { RangeSelection } from 'lexical';\nimport { NodeSelection } from 'lexical';\n\ndescribe('Test case', () => {\n  initializeE2E((e2e) => {\n    it('Should pass this test', async () => {\n      const {page} = e2e;\n\n      await page.focus('div[contenteditable=\"true\"]');\n${steps.map(formatStep).join(`\\n`)}\n    });\n});\n    `;\n  }, [editor, steps]);\n\n  // just a wrapper around inserting new actions so that we can\n  // coalesce some actions like insertText/moveNativeSelection\n  const pushStep = useCallback(\n    (name: string, value: Step['value']) => {\n      setSteps((currentSteps) => {\n        // trying to group steps\n        const currentIndex = steps.length - 1;\n        const lastStep = steps[currentIndex];\n        if (lastStep) {\n          if (lastStep.name === name) {\n            if (name === 'type') {\n              // for typing events we just append the text\n              return [\n                ...steps.slice(0, currentIndex),\n                {...lastStep, value: lastStep.value + value},\n              ];\n            } else {\n              // for other events we bump the counter if their values are the same\n              if (lastStep.value === value) {\n                return [\n                  ...steps.slice(0, currentIndex),\n                  {...lastStep, count: lastStep.count + 1},\n                ];\n              }\n            }\n          }\n        }\n        // could not group, just append a new one\n        return [...currentSteps, {count: 1, name, value}];\n      });\n    },\n    [steps, setSteps],\n  );\n\n  useLayoutEffect(() => {\n    const onKeyDown = (event: KeyboardEvent) => {\n      if (!isRecording) {\n        return;\n      }\n      const key = event.key;\n      if (isSelectAll(event)) {\n        pushStep('selectAll', '');\n      } else if (keyPresses.has(key)) {\n        pushStep('press', event.key);\n      } else if ([...key].length > 1) {\n        pushStep('keydown', event.key);\n      } else {\n        pushStep('type', event.key);\n      }\n    };\n\n    const onKeyUp = (event: KeyboardEvent) => {\n      if (!isRecording) {\n        return;\n      }\n      const key = event.key;\n      if (!keyPresses.has(key) && [...key].length > 1) {\n        pushStep('keyup', event.key);\n      }\n    };\n\n    return editor.registerRootListener(\n      (\n        rootElement: null | HTMLElement,\n        prevRootElement: null | HTMLElement,\n      ) => {\n        if (prevRootElement !== null) {\n          prevRootElement.removeEventListener('keydown', onKeyDown);\n          prevRootElement.removeEventListener('keyup', onKeyUp);\n        }\n        if (rootElement !== null) {\n          rootElement.addEventListener('keydown', onKeyDown);\n          rootElement.addEventListener('keyup', onKeyUp);\n        }\n      },\n    );\n  }, [editor, isRecording, pushStep]);\n\n  useLayoutEffect(() => {\n    if (preRef.current) {\n      preRef.current.scrollTo(0, preRef.current.scrollHeight);\n    }\n  }, [generateTestContent]);\n\n  useEffect(() => {\n    if (steps) {\n      const testContent = generateTestContent();\n      if (testContent !== null) {\n        setTemplatedTest(testContent);\n      }\n      if (preRef.current) {\n        preRef.current.scrollTo(0, preRef.current.scrollHeight);\n      }\n    }\n  }, [generateTestContent, steps]);\n\n  useEffect(() => {\n    const removeUpdateListener = editor.registerUpdateListener(\n      ({editorState, dirtyLeaves, dirtyElements}) => {\n        if (!isRecording) {\n          return;\n        }\n        const currentSelection = editorState._selection;\n        const previousSelection = previousSelectionRef.current;\n        const skipNextSelectionChange = skipNextSelectionChangeRef.current;\n        if (previousSelection !== currentSelection) {\n          if (\n            dirtyLeaves.size === 0 &&\n            dirtyElements.size === 0 &&\n            !skipNextSelectionChange\n          ) {\n            const browserSelection = window.getSelection();\n            if (\n              browserSelection &&\n              (browserSelection.anchorNode == null ||\n                browserSelection.focusNode == null)\n            ) {\n              return;\n            }\n          }\n          // previousSelectionRef.current = currentSelection;\n        }\n        skipNextSelectionChangeRef.current = false;\n        const testContent = generateTestContent();\n        if (testContent !== null) {\n          setTemplatedTest(testContent);\n        }\n      },\n    );\n    return removeUpdateListener;\n  }, [editor, generateTestContent, isRecording, pushStep]);\n\n  // save innerHTML\n  useEffect(() => {\n    if (!isRecording) {\n      return;\n    }\n    const removeUpdateListener = editor.registerUpdateListener(() => {\n      const rootElement = editor.getRootElement();\n      if (rootElement !== null) {\n        setCurrentInnerHTML(rootElement?.innerHTML);\n      }\n    });\n    return removeUpdateListener;\n  }, [editor, isRecording]);\n\n  // clear editor and start recording\n  const toggleEditorSelection = useCallback(\n    (currentEditor: LexicalEditor) => {\n      if (!isRecording) {\n        currentEditor.update(() => {\n          const root = $getRoot();\n          root.clear();\n          const text = $createTextNode();\n          root.append($createParagraphNode().append(text));\n          text.select();\n        });\n        setSteps([]);\n      }\n      setIsRecording((currentIsRecording) => !currentIsRecording);\n    },\n    [isRecording],\n  );\n\n  const onSnapshotClick = useCallback(() => {\n    if (!isRecording) {\n      return;\n    }\n    const browserSelection = window.getSelection();\n    if (\n      browserSelection === null ||\n      browserSelection.anchorNode == null ||\n      browserSelection.focusNode == null\n    ) {\n      return;\n    }\n    const {anchorNode, anchorOffset, focusNode, focusOffset} =\n      sanitizeSelection(browserSelection);\n    const rootElement = getCurrentEditor().getRootElement();\n    let anchorPath;\n    if (anchorNode !== null) {\n      anchorPath = getPathFromNodeToEditor(anchorNode, rootElement);\n    }\n    let focusPath;\n    if (focusNode !== null) {\n      focusPath = getPathFromNodeToEditor(focusNode, rootElement);\n    }\n    pushStep('snapshot', {\n      anchorNode,\n      anchorOffset,\n      anchorPath,\n      focusNode,\n      focusOffset,\n      focusPath,\n    });\n  }, [pushStep, isRecording, getCurrentEditor]);\n\n  const onCopyClick = useCallback(() => {\n    copy(generateTestContent());\n  }, [generateTestContent]);\n\n  const onDownloadClick = useCallback(() => {\n    download('test.js', generateTestContent());\n  }, [generateTestContent]);\n\n  const button = (\n    <button\n      id=\"test-recorder-button\"\n      className={`editor-dev-button ${isRecording ? 'active' : ''}`}\n      onClick={() => toggleEditorSelection(getCurrentEditor())}\n      title={isRecording ? 'Disable test recorder' : 'Enable test recorder'}\n    />\n  );\n  const output = isRecording ? (\n    <div className=\"test-recorder-output\">\n      <div className=\"test-recorder-toolbar\">\n        <button\n          className=\"test-recorder-button\"\n          id=\"test-recorder-button-snapshot\"\n          title=\"Insert snapshot\"\n          onClick={onSnapshotClick}\n        />\n        <button\n          className=\"test-recorder-button\"\n          id=\"test-recorder-button-copy\"\n          title=\"Copy to clipboard\"\n          onClick={onCopyClick}\n        />\n        <button\n          className=\"test-recorder-button\"\n          id=\"test-recorder-button-download\"\n          title=\"Download as a file\"\n          onClick={onDownloadClick}\n        />\n      </div>\n      <pre id=\"test-recorder\" ref={preRef}>\n        {templatedTest}\n      </pre>\n    </div>\n  ) : null;\n\n  return [button, output];\n}\n\nexport default function TestRecorderPlugin(): JSX.Element {\n  const [editor] = useLexicalComposerContext();\n  const [testRecorderButton, testRecorderOutput] = useTestRecorder(editor);\n\n  return (\n    <>\n      {testRecorderButton}\n      {testRecorderOutput}\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport * as React from 'react';\nimport {useMemo} from 'react';\n\nexport default function Switch({\n  checked,\n  onClick,\n  text,\n  id,\n}: Readonly<{\n  checked: boolean;\n  id?: string;\n  onClick: (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void;\n  text: string;\n}>): JSX.Element {\n  const buttonId = useMemo(() => 'id_' + Math.floor(Math.random() * 10000), []);\n  return (\n    <div className=\"switch\" id={id}>\n      <label htmlFor={buttonId}>{text}</label>\n      <button\n        role=\"switch\"\n        aria-checked={checked}\n        id={buttonId}\n        onClick={onClick}>\n        <span />\n      </button>\n    </div>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport * as React from 'react';\nimport {useMemo, useState} from 'react';\n\nimport {isDevPlayground} from './appSettings';\nimport {useSettings} from './context/SettingsContext';\nimport Switch from './ui/Switch';\n\nexport default function Settings(): JSX.Element {\n  const windowLocation = window.location;\n  const {\n    setOption,\n    settings: {\n      measureTypingPerf,\n      isCollab,\n      isRichText,\n      isMaxLength,\n      isCharLimit,\n      isCharLimitUtf8,\n      isAutocomplete,\n      showTreeView,\n      showNestedEditorTreeView,\n      disableBeforeInput,\n    },\n  } = useSettings();\n  const [showSettings, setShowSettings] = useState(false);\n  const [isSplitScreen, search] = useMemo(() => {\n    const parentWindow = window.parent;\n    const _search = windowLocation.search;\n    const _isSplitScreen =\n      parentWindow && parentWindow.location.pathname === '/split/';\n    return [_isSplitScreen, _search];\n  }, [windowLocation]);\n\n  return (\n    <>\n      <button\n        id=\"options-button\"\n        className={`editor-dev-button ${showSettings ? 'active' : ''}`}\n        onClick={() => setShowSettings(!showSettings)}\n      />\n      {showSettings ? (\n        <div className=\"switches\">\n          {isRichText && isDevPlayground && (\n            <Switch\n              onClick={() => {\n                setOption('isCollab', !isCollab);\n                window.location.reload();\n              }}\n              checked={isCollab}\n              text=\"Collaboration\"\n            />\n          )}\n          {isDevPlayground && (\n            <Switch\n              onClick={() => {\n                if (isSplitScreen) {\n                  window.parent.location.href = `/${search}`;\n                } else {\n                  window.location.href = `/split/${search}`;\n                }\n              }}\n              checked={isSplitScreen}\n              text=\"Split Screen\"\n            />\n          )}\n          <Switch\n            onClick={() => setOption('measureTypingPerf', !measureTypingPerf)}\n            checked={measureTypingPerf}\n            text=\"Measure Perf\"\n          />\n          <Switch\n            onClick={() => setOption('showTreeView', !showTreeView)}\n            checked={showTreeView}\n            text=\"Debug View\"\n          />\n          <Switch\n            onClick={() =>\n              setOption('showNestedEditorTreeView', !showNestedEditorTreeView)\n            }\n            checked={showNestedEditorTreeView}\n            text=\"Nested Editors Debug View\"\n          />\n          <Switch\n            onClick={() => {\n              setOption('isRichText', !isRichText);\n              setOption('isCollab', false);\n            }}\n            checked={isRichText}\n            text=\"Rich Text\"\n          />\n          <Switch\n            onClick={() => setOption('isCharLimit', !isCharLimit)}\n            checked={isCharLimit}\n            text=\"Char Limit\"\n          />\n          <Switch\n            onClick={() => setOption('isCharLimitUtf8', !isCharLimitUtf8)}\n            checked={isCharLimitUtf8}\n            text=\"Char Limit (UTF-8)\"\n          />\n          <Switch\n            onClick={() => setOption('isMaxLength', !isMaxLength)}\n            checked={isMaxLength}\n            text=\"Max Length\"\n          />\n          <Switch\n            onClick={() => setOption('isAutocomplete', !isAutocomplete)}\n            checked={isAutocomplete}\n            text=\"Autocomplete\"\n          />\n          <Switch\n            onClick={() => {\n              setOption('disableBeforeInput', !disableBeforeInput);\n              setTimeout(() => window.location.reload(), 500);\n            }}\n            checked={disableBeforeInput}\n            text=\"Legacy Events\"\n          />\n        </div>\n      ) : null}\n    </>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport type {EditorThemeClasses} from 'lexical';\n\n// import './PlaygroundEditorTheme.css';\n\nconst theme: EditorThemeClasses = {\n  characterLimit: 'PlaygroundEditorTheme__characterLimit',\n  code: 'PlaygroundEditorTheme__code',\n  codeHighlight: {\n    atrule: 'PlaygroundEditorTheme__tokenAttr',\n    attr: 'PlaygroundEditorTheme__tokenAttr',\n    boolean: 'PlaygroundEditorTheme__tokenProperty',\n    builtin: 'PlaygroundEditorTheme__tokenSelector',\n    cdata: 'PlaygroundEditorTheme__tokenComment',\n    char: 'PlaygroundEditorTheme__tokenSelector',\n    class: 'PlaygroundEditorTheme__tokenFunction',\n    'class-name': 'PlaygroundEditorTheme__tokenFunction',\n    comment: 'PlaygroundEditorTheme__tokenComment',\n    constant: 'PlaygroundEditorTheme__tokenProperty',\n    deleted: 'PlaygroundEditorTheme__tokenProperty',\n    doctype: 'PlaygroundEditorTheme__tokenComment',\n    entity: 'PlaygroundEditorTheme__tokenOperator',\n    function: 'PlaygroundEditorTheme__tokenFunction',\n    important: 'PlaygroundEditorTheme__tokenVariable',\n    inserted: 'PlaygroundEditorTheme__tokenSelector',\n    keyword: 'PlaygroundEditorTheme__tokenAttr',\n    namespace: 'PlaygroundEditorTheme__tokenVariable',\n    number: 'PlaygroundEditorTheme__tokenProperty',\n    operator: 'PlaygroundEditorTheme__tokenOperator',\n    prolog: 'PlaygroundEditorTheme__tokenComment',\n    property: 'PlaygroundEditorTheme__tokenProperty',\n    punctuation: 'PlaygroundEditorTheme__tokenPunctuation',\n    regex: 'PlaygroundEditorTheme__tokenVariable',\n    selector: 'PlaygroundEditorTheme__tokenSelector',\n    string: 'PlaygroundEditorTheme__tokenSelector',\n    symbol: 'PlaygroundEditorTheme__tokenProperty',\n    tag: 'PlaygroundEditorTheme__tokenProperty',\n    url: 'PlaygroundEditorTheme__tokenOperator',\n    variable: 'PlaygroundEditorTheme__tokenVariable',\n  },\n  embedBlock: {\n    base: 'PlaygroundEditorTheme__embedBlock',\n    focus: 'PlaygroundEditorTheme__embedBlockFocus',\n  },\n  hashtag: 'PlaygroundEditorTheme__hashtag',\n  heading: {\n    h1: 'PlaygroundEditorTheme__h1',\n    h2: 'PlaygroundEditorTheme__h2',\n    h3: 'PlaygroundEditorTheme__h3',\n    h4: 'PlaygroundEditorTheme__h4',\n    h5: 'PlaygroundEditorTheme__h5',\n    h6: 'PlaygroundEditorTheme__h6',\n  },\n  image: 'editor-image',\n  link: 'PlaygroundEditorTheme__link',\n  list: {\n    listitem: 'PlaygroundEditorTheme__listItem',\n    listitemChecked: 'PlaygroundEditorTheme__listItemChecked',\n    listitemUnchecked: 'PlaygroundEditorTheme__listItemUnchecked',\n    nested: {\n      listitem: 'PlaygroundEditorTheme__nestedListItem',\n    },\n    olDepth: [\n      'PlaygroundEditorTheme__ol1',\n      'PlaygroundEditorTheme__ol2',\n      'PlaygroundEditorTheme__ol3',\n      'PlaygroundEditorTheme__ol4',\n      'PlaygroundEditorTheme__ol5',\n    ],\n    ul: 'PlaygroundEditorTheme__ul',\n  },\n  ltr: 'PlaygroundEditorTheme__ltr',\n  mark: 'PlaygroundEditorTheme__mark',\n  markOverlap: 'PlaygroundEditorTheme__markOverlap',\n  paragraph: 'PlaygroundEditorTheme__paragraph',\n  quote: 'PlaygroundEditorTheme__quote',\n  rtl: 'PlaygroundEditorTheme__rtl',\n  table: 'PlaygroundEditorTheme__table',\n  tableCell: 'PlaygroundEditorTheme__tableCell',\n  tableCellHeader: 'PlaygroundEditorTheme__tableCellHeader',\n  text: {\n    bold: 'PlaygroundEditorTheme__textBold',\n    code: 'PlaygroundEditorTheme__textCode',\n    italic: 'PlaygroundEditorTheme__textItalic',\n    strikethrough: 'PlaygroundEditorTheme__textStrikethrough',\n    subscript: 'PlaygroundEditorTheme__textSubscript',\n    superscript: 'PlaygroundEditorTheme__textSuperscript',\n    underline: 'PlaygroundEditorTheme__textUnderline',\n    underlineStrikethrough: 'PlaygroundEditorTheme__textUnderlineStrikethrough',\n  },\n};\n\nexport default theme;\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport {$createLinkNode} from '@lexical/link';\nimport {$createListItemNode, $createListNode} from '@lexical/list';\nimport {LexicalComposer} from '@lexical/react/LexicalComposer';\nimport {$createHeadingNode, $createQuoteNode} from '@lexical/rich-text';\nimport {$createParagraphNode, $createTextNode, $getRoot} from 'lexical';\nimport * as React from 'react';\n\nimport {isDevPlayground} from './appSettings';\nimport {SettingsContext, useSettings} from './context/SettingsContext';\n// import {SharedAutocompleteContext} from './context/SharedAutocompleteContext';\nimport {SharedHistoryContext} from './context/SharedHistoryContext';\nimport Editor from './Editor';\n// import logo from './images/logo.svg';\nimport PlaygroundNodes from './nodes/PlaygroundNodes';\nimport TestRecorderPlugin from './plugins/TestRecorderPlugin';\n// import TypingPerfPlugin from './plugins/TypingPerfPlugin';\nimport Settings from './Settings';\nimport PlaygroundEditorTheme from './themes/PlaygroundEditorTheme';\n\nconsole.warn(\n  'If you are profiling the playground app, please ensure you turn off the debug view. You can disable it by pressing on the settings control in the bottom-left of your screen and toggling the debug view setting.',\n);\n\nfunction prepopulatedRichText() {\n  const root = $getRoot();\n  if (root.getFirstChild() === null) {\n    const heading = $createHeadingNode('h1');\n    heading.append($createTextNode('Welcome to the playground'));\n    root.append(heading);\n    const quote = $createQuoteNode();\n    quote.append(\n      $createTextNode(\n        `In case you were wondering what the black box at the bottom is – it's the debug view, showing the current state of editor. ` +\n          `You can disable it by pressing on the settings control in the bottom-left of your screen and toggling the debug view setting.`,\n      ),\n    );\n    root.append(quote);\n    const paragraph = $createParagraphNode();\n    paragraph.append(\n      $createTextNode('The playground is a demo environment built with '),\n      $createTextNode('@lexical/react').toggleFormat('code'),\n      $createTextNode('.'),\n      $createTextNode(' Try typing in '),\n      $createTextNode('some text').toggleFormat('bold'),\n      $createTextNode(' with '),\n      $createTextNode('different').toggleFormat('italic'),\n      $createTextNode(' formats.'),\n    );\n    root.append(paragraph);\n    const paragraph2 = $createParagraphNode();\n    paragraph2.append(\n      $createTextNode(\n        'Make sure to check out the various plugins in the toolbar. You can also use #hashtags or @-mentions too!',\n      ),\n    );\n    root.append(paragraph2);\n    const paragraph3 = $createParagraphNode();\n    paragraph3.append(\n      $createTextNode(`If you'd like to find out more about Lexical, you can:`),\n    );\n    root.append(paragraph3);\n    const list = $createListNode('bullet');\n    list.append(\n      $createListItemNode().append(\n        $createTextNode(`Visit the `),\n        $createLinkNode('https://lexical.dev/').append(\n          $createTextNode('Lexical website'),\n        ),\n        $createTextNode(` for documentation and more information.`),\n      ),\n      $createListItemNode().append(\n        $createTextNode(`Check out the code on our `),\n        $createLinkNode('https://github.com/facebook/lexical').append(\n          $createTextNode('GitHub repository'),\n        ),\n        $createTextNode(`.`),\n      ),\n      $createListItemNode().append(\n        $createTextNode(`Playground code can be found `),\n        $createLinkNode(\n          'https://github.com/facebook/lexical/tree/main/packages/lexical-playground',\n        ).append($createTextNode('here')),\n        $createTextNode(`.`),\n      ),\n      $createListItemNode().append(\n        $createTextNode(`Join our `),\n        $createLinkNode('https://discord.com/invite/KmG4wQnnD9').append(\n          $createTextNode('Discord Server'),\n        ),\n        $createTextNode(` and chat with the team.`),\n      ),\n    );\n    root.append(list);\n    const paragraph4 = $createParagraphNode();\n    paragraph4.append(\n      $createTextNode(\n        `Lastly, we're constantly adding cool new features to this playground. So make sure you check back here when you next get a chance :).`,\n      ),\n    );\n    root.append(paragraph4);\n  }\n}\n\nfunction App(): JSX.Element {\n  const {\n    settings: {isCollab, emptyEditor, measureTypingPerf},\n  } = useSettings();\n\n  const initialConfig = {\n    editorState: isCollab\n      ? null\n      : emptyEditor\n      ? undefined\n      : prepopulatedRichText,\n    namespace: 'Playground',\n    nodes: [...PlaygroundNodes],\n    onError: (error: Error) => {\n      throw error;\n    },\n    theme: PlaygroundEditorTheme,\n  };\n\n  return (\n    <LexicalComposer initialConfig={initialConfig}>\n      <SharedHistoryContext>\n       \n          <header>\n            <a href=\"https://lexical.dev\" target=\"_blank\" rel=\"noopener\">\n              {/* <img src={logo} alt=\"Lexical Logo\" /> */}\n            </a>\n          </header>\n          <div className=\"editor-shell\">\n            <Editor />\n          </div>\n          <Settings />\n          {isDevPlayground ? <TestRecorderPlugin /> : null}\n          {/* {measureTypingPerf ? <TypingPerfPlugin /> : null} */}\n  \n      </SharedHistoryContext>\n    </LexicalComposer>\n  );\n}\n\nexport default function PlaygroundApp(): JSX.Element {\n  return (\n    <SettingsContext>\n      <App />\n      <a\n        href=\"https://github.com/facebook/lexical/tree/main/packages/lexical-playground\"\n        className=\"github-corner\"\n        aria-label=\"View source on GitHub\">\n        <svg\n          width=\"80\"\n          height=\"80\"\n          viewBox=\"0 0 250 250\"\n          style={{\n            border: '0',\n            color: '#eee',\n            fill: '#222',\n            left: '0',\n            position: 'absolute',\n            top: '0',\n            transform: 'scale(-1,1)',\n          }}\n          aria-hidden=\"true\">\n          <path d=\"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z\" />\n          <path\n            d=\"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2\"\n            fill=\"currentColor\"\n            style={{\n              transformOrigin: '130px 106px',\n            }}\n            className=\"octo-arm\"\n          />\n          <path\n            d=\"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z\"\n            fill=\"currentColor\"\n            className=\"octo-body\"\n          />\n        </svg>\n      </a>\n    </SettingsContext>\n  );\n}\n","/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport './setupEnv';\n// import './index.css';\n\nimport * as React from 'react';\nimport {createRoot} from 'react-dom/client';\n\nimport App from './App';\n\n// Handle runtime errors\nconst showErrorOverlay = (err: Event) => {\n  const ErrorOverlay = customElements.get('vite-error-overlay');\n  if (!ErrorOverlay) {\n    return;\n  }\n  const overlay = new ErrorOverlay(err);\n  const body = document.body;\n  if (body !== null) {\n    body.appendChild(overlay);\n  }\n};\n\nwindow.addEventListener('error', showErrorOverlay);\nwindow.addEventListener('unhandledrejection', ({reason}) =>\n  showErrorOverlay(reason),\n);\n\ncreateRoot(document.getElementById('root') as HTMLElement).render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n);\n"],"names":["hostName","window","location","hostname","isDevPlayground","DEFAULT_SETTINGS","disableBeforeInput","emptyEditor","isAutocomplete","isCharLimit","isCharLimitUtf8","isCollab","isMaxLength","isRichText","measureTypingPerf","showNestedEditorTreeView","showTreeView","urlSearchParams","URLSearchParams","search","_i","_Object$keys","Object","keys","length","param","has","_urlSearchParams$get","value","JSON","parse","get","Boolean","error","console","warn","InputEvent","prototype","getTargetRanges","Context","createContext","setOption","name","settings","SettingsContext","_ref","children","_useState","useState","setSettings","useCallback","setting","options","_extends2","_extends","setURLParam","contextValue","useMemo","React","Provider","useSettings","useContext","url","URL","href","params","set","String","append","toString","history","pushState","SharedHistoryContext","historyContext","historyState","createEmptyHistoryState","useSharedHistoryContext","PortalImpl","onClose","title","closeOnClickOutside","modalRef","useRef","useEffect","current","focus","modalOverlayElement","handler","event","keyCode","clickOutsideHandler","target","contains","_modalRef$current","parentElement","_modalOverlayElement","addEventListener","removeEventListener","_modalOverlayElement2","className","role","tabIndex","ref","type","onClick","Modal","_ref2","_ref2$closeOnClickOut","createPortal","document","body","useModal","modalContent","setModalContent","modal","content","showModal","getContent","joinClasses","args","Array","_len","_key","arguments","filter","join","Button","dataTestId","disabled","small","ActionsPlugin","_useLexicalComposerCo","useLexicalComposerContext","editor","_useState2","_useState3","isEditorEmpty","setIsEditorEmpty","_useModal","registerUpdateListener","getEditorState","read","root","$getRoot","getChildren","$isParagraphNode","paragraphChildren","handleMarkdownToggle","update","firstChild","getFirstChild","$isCodeNode","getLanguage","selectEnd","ShowClearDialog","AutocompleteNode","_DecoratorNode","_inheritsLoose","uuid","key","_this","call","__uuid","clone","node","__key","getType","importJSON","serializedNode","$createAutocompleteNode","_proto","exportJSON","version","updateDOM","prevNode","dom","config","createDOM","createElement","decorate","UUID","AutocompleteComponent","DecoratorNode","style","color","spellCheck","elements","WeakMap","readTouch","e","touch","changedTouches","undefined","clientX","clientY","addListener","element","cb","elementValues","listeners","Set","handleTouchstart","start","handleTouchend","end","_iterator","_createForOfIteratorHelperLoose","_step","done","listener","add","deleteListener","size","addSwipeRightListener","force","x","y","Math","abs","random","replace","substr","useQuery","searchText","server","AutocompleteServer","time","response","query","timeEnd","AutocompletePlugin","autocompleteNodeKey","lastSuggestion","$clearSuggestion","handleAutocompleteNodeTransform","getKey","handleUpdate","selection","$getSelection","$handleAutocompleteIntent","autocompleteNode","$getNodeByKey","textNode","$createTextNode","selectNext","$handleKeypressCommand","preventDefault","handleSwipeRight","_force","unmountSuggestion","rootElem","getRootElement","mergeRegister","apply","registerNodeTransform","registerCommand","KEY_TAB_COMMAND","COMMAND_PRIORITY_LOW","KEY_ARROW_RIGHT_COMMAND","concat","DICTIONARY","isDismissed","dismiss","promise","Promise","resolve","reject","setTimeout","searchTextLength","char0","charCodeAt","isCapitalized","caseInsensitiveSearchText","fromCharCode","substring","match","DATABASE","find","dictionaryWord","_dictionaryWord$start","startsWith","matchCapitalized","autocompleteChunk","LATENCY","URL_MATCHER","EMAIL_MATCHER","MATCHERS","text","exec","index","LexicalAutoLinkPlugin","AutoLinkPlugin","matchers","ClickableLinkPlugin","_ref$newTab","newTab","linkDomNode","getLinkDomNode","getAttribute","$isRangeSelection","isCollapsed","linkNode","maybeLinkNode","$getNearestNodeFromDOMNode","$isLinkNode","open","metaKey","ctrlKey","_unused","registerRootListener","rootElement","prevRootElement","isLinkDomNode","domNode","nodeName","toLowerCase","parentNode","CodeHighlightPlugin","registerCodeHighlighting","EmojiNode","_TextNode","__className","__text","inner","appendChild","$createEmojiNode","setFormat","format","setDetail","detail","setMode","mode","setStyle","getClassName","self","getLatest","TextNode","emojiText","emojis","Map","findAndTransformEmoji","getTextContent","i","emojiData","slice","emojiStyle","targetNode","_node$splitText","splitText","_node$splitText2","emojiNode","textNodeTransform","isSimpleText","useEmojis","hasNodes","Error","EmojisPlugin","EquationEditor","equation","setEquation","inline","inputRef","onChange","props","InlineEquationEditor","BlockEquationEditor","autoFocus","_ref3","KatexRenderer","katexElementRef","katexElement","katex","render","displayMode","errorColor","output","strict","throwOnError","trust","EquationComponent","nodeKey","equationValue","setEquationValue","showEquationEditor","setShowEquationEditor","onHide","restoreSelection","$isEquationNode","SELECTION_CHANGE_COMMAND","payload","activeElement","inputElem","COMMAND_PRIORITY_HIGH","KEY_ESCAPE_COMMAND","EquationNode","__equation","__inline","$createEquationNode","getEquation","_config","writable","getWritable","equationNode","INSERT_EQUATION_COMMAND","createCommand","EquationsPlugin","insertNodes","COMMAND_PRIORITY_EDITOR","clamp","min","max","Direction","east","north","south","west","ImageResizer","onResizeStart","onResizeEnd","imageRef","maxWidth","showCaption","setShowCaption","buttonRef","controlWrapperRef","userSelect","priority","positioningRef","currentHeight","currentWidth","direction","isResizing","ratio","startHeight","startWidth","startX","startY","editorRootElement","maxWidthContainer","getBoundingClientRect","width","maxHeightContainer","height","minWidth","minHeight","setStartCursor","ew","ns","nwse","cursorDir","setProperty","getPropertyValue","getPropertyPriority","setEndCursor","handlePointerDown","image","controlWrapper","_image$getBoundingCli","positioning","classList","handlePointerMove","handlePointerUp","isHorizontal","isVertical","diff","floor","remove","onPointerDown","removeStyleFromSvg_HACK","svg","styleTag","_svg$firstElementChil","firstElementChild","viewBox","viewBoxDimensions","split","setAttribute","tagName","ExcalidrawImage","imageContainerRef","_ref$appState","appState","_ref$rootClassName","rootClassName","Svg","setSvg","setContent","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","abrupt","exportToSvg","files","sent","stop","dangerouslySetInnerHTML","__html","_Svg$outerHTML","outerHTML","ExcalidrawComponent","data","_useLexicalNodeSelect","useLexicalNodeSelection","isSelected","setSelected","clearSelection","setIsResizing","onDelete","$isNodeSelection","$isExcalidrawNode","CLICK_COMMAND","buttonElem","eventTarget","shiftKey","KEY_DELETE_COMMAND","KEY_BACKSPACE_COMMAND","deleteNode","convertExcalidrawElement","excalidrawData","$createExcalidrawNode","__data","ExcalidrawNode","span","theme","importDOM","hasAttribute","conversion","exportDOM","getElementByKey","querySelector","innerHTML","setData","INSERT_EXCALIDRAW_COMMAND","ExcalidrawPlugin","excalidrawNode","HorizontalRulePlugin","INSERT_HORIZONTAL_RULE_COMMAND","focusNode","getNode","horizontalRuleNode","$createHorizontalRuleNode","insertParagraph","getTopLevelElementOrThrow","insertBefore","getSelection","KeywordNode","$createKeywordNode","cursor","canInsertTextBefore","canInsertTextAfter","isTextEntity","keyword","KEYWORDS_REGEX","KeywordsPlugin","createKeywordNode","getKeywordMatch","matchArr","hashtagLength","startOffset","endOffset","useLexicalTextEntity","CAN_USE_DOM","useLayoutEffectImpl","useLayoutEffect","convertMentionElement","textContent","$createMentionNode","mentionStyle","MentionNode","mentionName","__mention","setTextContent","cssText","mentionNode","toggleDirectionless","PUNCTUATION","NAME","DocumentMentionsRegex","CapitalizedNameMentionsRegex","RegExp","PUNC","TRIGGERS","VALID_CHARS","VALID_JOINS","LENGTH_LIMIT","AtSignMentionsRegex","ALIAS_LENGTH_LIMIT","AtSignMentionsRegexAliasRegex","SUGGESTION_LIST_LENGTH_LIMIT","mentionsCache","dummyMentionsData","dummyLookupService","string","callback","results","mention","includes","useMentionLookupService","mentionString","setResults","cachedResults","newResults","MentionsTypeaheadItem","onMouseEnter","result","liRef","id","MentionsTypeahead","close","resolution","divRef","matchingString","selectedIndex","setSelectedIndex","div","range","_range$getBoundingCli","left","top","display","removeAttribute","applyCurrentSelected","selectedEntry","createMentionNodeFromSearchResult","updateSelectedIndex","KEY_ARROW_DOWN_COMMAND","stopImmediatePropagation","KEY_ARROW_UP_COMMAND","KEY_ENTER_COMMAND","map","checkForCapitalizedNameMentions","minMatchLength","maybeLeadingWhitespace","leadOffset","replaceableString","checkForAtSignMentions","getPossibleMentionMatch","getTextUpToAnchor","anchor","anchorNode","anchorOffset","offset","tryToPositionRange","domSelection","setStart","setEnd","getMentionsTextToSearch","getMentionOffset","documentText","entryText","triggerOffset","ii","selectionOffset","characterOffset","mentionOffset","nodeToReplace","_anchorNode$splitText","_anchorNode$splitText2","select","isSelectionOnEntityBoundary","prevSibling","getPreviousSibling","$isTextNode","useMentions","setResolution","activeRange","createRange","previousText","updateListener","isRangePositioned","startTransition","removeUpdateListener","closeTypeahead","MentionsPlugin","TableActionMenu","_tableCellNode","tableCellNode","setIsMenuOpen","contextRef","dropDownRef","updateTableCellNode","columns","rows","selectionCounts","registerMutationListener","TableCellNode","nodeMutations","nodeUpdated","menuButtonElement","dropDownElement","menuButtonRect","opacity","pageXOffset","pageYOffset","handleClickOutside","clearTableSelection","isAttached","tableNode","$getTableNodeFromLexicalNodeOrThrow","tableElement","tableSelection","getTableSelectionFromTableElement","clearHighlight","markDirty","$setSelection","insertTableRowAtSelection","shouldInsertAfter","grid","$getElementGridForTableNode","insertTableColumnAtSelection","deleteTableRowAtSelection","tableRowIndex","$getTableRowIndexFromTableCellNode","$removeTableRowAtIndex","deleteTableAtSelection","deleteTableColumnAtSelection","tableColumnIndex","$getTableColumnIndexFromTableCellNode","$deleteTableColumn","toggleTableRowIsHeader","tableRows","tableRow","$isTableRowNode","forEach","tableCell","$isTableCellNode","toggleHeaderStyle","TableCellHeaderStates","ROW","toggleTableColumnIsHeader","r","tableCells","COLUMN","stopPropagation","__headerState","TableCellActionMenuContainer","_useLexicalComposerCo2","menuButtonRef","menuRootRef","isMenuOpen","_useState4","setTableMenuCellNode","moveMenu","menu","nativeSelection","tableCellNodeFromSelection","$getTableCellNodeFromLexicalNode","tableCellParentNodeDOM","menuButtonDOM","tableCellNodeDOM","tableCellRect","menuRect","prevTableCellDOM","TableActionMenuPlugin","imageCache","useSuspenseImage","src","img","Image","onload","convertImageElement","HTMLImageElement","altText","alt","$createImageNode","LazyImage","draggable","ImageComponent","resizable","caption","$isImageNode","nextWidth","nextHeight","setWidthAndHeight","_useSharedHistoryCont","_useSettings","isFocused","Suspense","fallback","LexicalNestedComposer","initialEditor","TablePlugin","TableCellActionMenuPlugin","ImagesPlugin","LinkPlugin","HashtagPlugin","ImageNode","__src","__altText","__maxWidth","__width","__height","__showCaption","__caption","createEditor","nestedEditor","editorState","parseEditorState","isEmpty","setEditorState","getAltText","toJSON","getSrc","_ref3$maxWidth","INSERT_IMAGE_COMMAND","$isRootNode","imageNode","DRAGSTART_COMMAND","onDragStart","DRAGOVER_COMMAND","onDragover","DROP_COMMAND","onDrop","TRANSPARENT_IMAGE","getImageNodeInSelection","dataTransfer","setDragImage","stringify","canDropImage","getDragImageData","getDragSelection","rangeSelection","$createRangeSelection","applyDOMRange","dispatchCommand","nodes","getNodes","dragData","_event$dataTransfer","getData","_JSON$parse","HTMLElement","closest","caretRangeFromPoint","rangeParent","collapse","rangeOffset","getRangeAt","getElementNodesInSelection","nodesInSelection","getParentOrThrow","n","$isElementNode","isIndentPermitted","maxDepth","elementNodesInSelection","totalDepth","elementNode","$isListNode","$getListDepth","$isListItemNode","parent","getParent","ListMaxIndentLevelPlugin","INDENT_CONTENT_COMMAND","COMMAND_PRIORITY_CRITICAL","MaxLengthPlugin","maxLength","lastRestoredEditorState","RootNode","rootNode","prevEditorState","prevTextContent","textLength","delCount","$restoreEditorState","trimTextContentFromAnchor","createUID","createPollOption","uid","votes","cloneOption","option","from","getTotalVotes","reduce","totalVotes","PollOptionComponent","withPollNode","checkboxRef","votesArray","setOptionText","placeholder","deleteOption","PollComponent","question","$isPollNode","addOption","convertPollElement","$createPollNode","PollNode","__question","__options","push","indexOf","splice","clonedOption","toggleVote","clientID","votesClone","voteIndex","elem","INSERT_POLL_COMMAND","PollPlugin","pollNode","getElement","getElementById","position","fontSize","transform","padding","background","borderRadius","useReport","timer","cleanup","clearTimeout","removeChild","log","SPEECH_TO_TEXT_COMMAND","VOICE_COMMANDS","_","redo","REDO_COMMAND","undo","UNDO_COMMAND","SUPPORT_SPEECH_RECOGNITION","SpeechToTextPlugin","isEnabled","setIsEnabled","SpeechRecognition","webkitSpeechRecognition","recognition","report","continuous","interimResults","resultItem","item","resultIndex","_resultItem$item","transcript","isFinal","command","trim","insertText","_isEnabled","TAB_TO_FOCUS_INTERVAL","lastTabKeyDownTimestamp","hasRegisteredKeyDownListener","registerKeyTimeStampTracker","timeStamp","TabFocusPlugin","FOCUS_COMMAND","MIN_ROW_HEIGHT","MIN_COLUMN_WIDTH","TableCellResizer","targetRef","resizerRef","tableRectRef","mouseStartPosRef","mouseCurrentPos","updateMouseCurrentPos","activeCell","updateActiveCell","isSelectingGrid","draggingDirection","updateDraggingDirection","resetState","onMouseMove","cell","getCellFromTarget","isHeightChanging","updateRowHeight","newHeight","setHeight","updateColumnWidth","newWidth","setWidth","toggleResize","_mouseStartPosRef$cur","_activeCell$elem$getB","heightChange","isShrinking","widthChange","getResizers","_activeCell$elem$getB2","styles","bottom","backgroundColor","right","tableRect","resizerStyles","onMouseDown","onMouseUp","TableCellResizerPlugin","setPopupPosition","rect","rootElementRect","offsetWidth","TextFormatFloatingToolbar","isLink","isBold","isItalic","isUnderline","isCode","isStrikethrough","isSubscript","isSuperscript","popupCharStylesEditorRef","insertLink","TOGGLE_LINK_COMMAND","updateTextFormatFloatingToolbar","popupCharStylesEditorElem","domRange","onResize","FORMAT_TEXT_COMMAND","getSelectedNode","isBackward","$isAtNodeEnd","useTextFormatFloatingToolbar","isText","setIsText","setIsLink","setIsBold","setIsItalic","_useState5","setIsUnderline","_useState6","setIsStrikethrough","_useState7","setIsSubscript","_useState8","setIsSuperscript","_useState9","setIsCode","updatePopup","isComposing","hasFormat","$isCodeHighlightNode","TextFormatFloatingToolbarPlugin","IS_APPLE","test","navigator","platform","positionSticky","stickyElem","rectLeft","rectTop","StickyComponent","stickyContainerRef","isDragging","offsetX","offsetY","stickyContainer","pageX","pageY","$isStickyNode","setPosition","handleDelete","handleColorChange","toggleColor","button","stickContainer","_stickContainer$getBo","StickyNode","__x","__y","__color","xOffset","yOffset","isIsolated","$createStickyNode","DropDownContext","DropDownItem","dropDownContext","registerItem","DropDownItems","items","setItems","highlightedItem","setHighlightedItem","itemRef","handleKeyDown","onKeyDown","DropDown","buttonLabel","buttonAriaLabel","buttonClassName","buttonIconClassName","stopCloseOnClickSelf","showDropDown","setShowDropDown","handleClose","dropDown","_button$getBoundingCl","innerWidth","handle","TextInput","label","_ref$placeholder","basicColors","WIDTH","HEIGHT","ColorPicker","rest","_objectWithoutPropertiesLoose","_excluded","transformColor","selfColor","setSelfColor","inputColor","setInputColor","innerDivRef","saturationPosition","hsv","s","v","huePosition","h","onSetHex","hex","newColor","onMoveSaturation","newHsv","onMoveHue","basicColor","MoveWrapper","_ref4","move","_div$getBoundingClien","_e","toHex","ctx","getContext","fillStyle","hex2rgb","rbgArr","m","g","b","parseInt","rgb2hsv","_ref5","d","hsv2rgb","_ref6","f","p","q","t","round","rgb2hex","_ref7","padStart","rgb","FileInput","accept","KatexEquationAlterer","onConfirm","_ref$initialEquation","initialEquation","setInline","onCheckboxChange","checked","PREVIEW_CACHE","useSuspenseRequest","cached","preview","fetch","encodeURI","then","json","LinkPreviewContent","_useSuspenseRequest","domain","description","Glimmer","animationDelay","LinkPreview","WIDGET_SCRIPT_URL","getHasScriptCached","convertTweetElement","$createTweetNode","TweetComponent","loadingComponent","onError","onLoad","tweetID","containerRef","previousTweetIDRef","isLoading","setIsLoading","createTweet","twttr","widgets","t0","_document$body","script","async","onerror","BlockWithAlignableContents","TweetNode","_DecoratorBlockNode","__id","__format","getId","embedBlockTheme","embedBlock","base","isTopLevel","DecoratorBlockNode","INSERT_TWEET_COMMAND","TwitterPlugin","tweetNode","paragraphNode","$createParagraphNode","insertAfter","YouTubeComponent","videoID","frameBorder","allow","allowFullScreen","YouTubeNode","$createYouTubeNode","_editor","INSERT_YOUTUBE_COMMAND","YouTubePlugin","youTubeNode","blockTypeToBlockName","bullet","check","code","h1","h2","h3","h4","h5","h6","number","paragraph","quote","CODE_LANGUAGE_OPTIONS","CODE_LANGUAGE_MAP","javascript","md","plaintext","python","positionEditorElement","FloatingLinkEditor","editorRef","linkUrl","setLinkUrl","isEditMode","setEditMode","lastSelection","setLastSelection","updateLinkEditor","getURL","editorElem","rel","InsertImageUriDialogBody","setSrc","setAltText","isDisabled","InsertImageUploadedDialogBody","loadImage","reader","FileReader","readAsDataURL","InsertImageDialog","activeEditor","InsertTableDialog","setRows","_useState10","setColumns","INSERT_TABLE_COMMAND","InsertPollDialog","_useState11","setQuestion","VALID_TWITTER_URL","InsertTweetDialog","_ref8","_useState12","setText","_text$split","YOUTUBE_ID_PARSER","parseYouTubeVideoID","urlMatches","InsertYouTubeDialog","_ref9","_useState13","InsertEquationDialog","_ref10","onEquationConfirm","dropDownActiveClass","active","BlockFormatDropDown","_ref11","blockType","formatParagraph","formatHeading","headingSize","formatBulletList","INSERT_UNORDERED_LIST_COMMAND","REMOVE_LIST_COMMAND","formatCheckList","INSERT_CHECK_LIST_COMMAND","formatNumberedList","INSERT_ORDERED_LIST_COMMAND","formatQuote","formatCode","codeNode","$createCodeNode","insertRawText","Divider","Select","_ref12","_ref13","ToolbarPlugin","_useState14","setActiveEditor","_useState15","setBlockType","_useState16","selectedElementKey","setSelectedElementKey","_useState17","setFontSize","_useState18","fontColor","setFontColor","_useState19","bgColor","setBgColor","_useState20","fontFamily","setFontFamily","_useState21","_useState22","_useState23","_useState24","_useState25","_useState26","_useState27","_useState28","_useState29","canUndo","setCanUndo","_useState30","canRedo","setCanRedo","_useState31","isRTL","setIsRTL","_useState32","codeLanguage","setCodeLanguage","updateToolbar","elementKey","elementDOM","$isParentElementRTL","parentList","$getNearestNodeOfType","ListNode","getListType","$isHeadingNode","getTag","language","$getSelectionStyleValueForProperty","_payload","newEditor","_ref14","CAN_UNDO_COMMAND","CAN_REDO_COMMAND","applyStyleText","$patchStyleText","clearFormatting","$selectAll","$getNearestBlockElementAncestorOrThrow","$isDecoratorBlockNode","onFontSizeSelect","onFontColorSelect","onBgColorSelect","onFontFamilySelect","onCodeLanguageSelect","setLanguage","stickyNode","FORMAT_ELEMENT_COMMAND","OUTDENT_CONTENT_COMMAND","Placeholder","Editor","_useSettings$settings","scrollRef","AutoFocusPlugin","ClearEditorPlugin","ListPlugin","CheckListPlugin","HistoryPlugin","externalHistoryState","TypeaheadNode","PlaygroundNodes","HeadingNode","ListItemNode","QuoteNode","CodeNode","TableNode","TableRowNode","HashtagNode","CodeHighlightNode","AutoLinkNode","LinkNode","OverflowNode","HorizontalRuleNode","MarkNode","copy","textArea","execCommand","_document$body2","download","filename","a","encodeURIComponent","_document$body3","click","_document$body4","formatStep","step","formatOneStep","anchorPath","focusPath","focusOffset","formattedStep","count","isSelectAll","sanitizeSelection","getPathFromNodeToEditor","currentNode","path","_currentNode2","_currentNode$parentNo","_currentNode","unshift","childNodes","keyPresses","useTestRecorder","steps","setSteps","isRecording","setIsRecording","setCurrentInnerHTML","templatedTest","setTemplatedTest","previousSelectionRef","skipNextSelectionChangeRef","preRef","getCurrentEditor","generateTestContent","browserSelection","pushStep","currentSteps","currentIndex","lastStep","onKeyUp","scrollTo","scrollHeight","testContent","dirtyLeaves","dirtyElements","currentSelection","_selection","previousSelection","skipNextSelectionChange","toggleEditorSelection","currentEditor","clear","currentIsRecording","onSnapshotClick","_sanitizeSelection","onCopyClick","onDownloadClick","TestRecorderPlugin","_useTestRecorder","testRecorderButton","testRecorderOutput","Switch","buttonId","htmlFor","Settings","windowLocation","showSettings","setShowSettings","_useMemo","parentWindow","_search","_isSplitScreen","pathname","isSplitScreen","reload","characterLimit","codeHighlight","atrule","attr","builtin","cdata","comment","constant","deleted","doctype","entity","important","inserted","namespace","operator","prolog","property","punctuation","regex","selector","symbol","tag","variable","hashtag","heading","link","list","listitem","listitemChecked","listitemUnchecked","nested","olDepth","ul","ltr","markOverlap","rtl","table","tableCellHeader","bold","italic","strikethrough","subscript","superscript","underline","underlineStrikethrough","prepopulatedRichText","$createHeadingNode","$createQuoteNode","toggleFormat","paragraph2","paragraph3","$createListNode","$createListItemNode","$createLinkNode","paragraph4","App","initialConfig","PlaygroundEditorTheme","LexicalComposer","PlaygroundApp","border","fill","transformOrigin","showErrorOverlay","err","ErrorOverlay","customElements","overlay","reason","createRoot"],"mappings":"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"}